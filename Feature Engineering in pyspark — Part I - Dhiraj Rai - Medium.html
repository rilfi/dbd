<!DOCTYPE html>
<!-- saved from url=(0096)https://medium.com/@dhiraj.p.rai/essentials-of-feature-engineering-in-pyspark-part-i-76a57680a85 -->
<html lang="en" class="gr__medium_com" data-rh="lang"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/branch-latest.min.js.download"></script><script async="" src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/analytics.js.download"></script><script>!function(c,f){var t,o,i,e=[],r={passive:!0,capture:!0},n=new Date,a="pointerup",u="pointercancel";function p(n,e){t||(t=e,o=n,i=new Date,w(f),s())}function s(){0<=o&&o<i-n&&(e.forEach(function(n){n(o,t)}),e=[])}function l(n){if(n.cancelable){var e=(1e12<n.timeStamp?new Date:performance.now())-n.timeStamp;"pointerdown"==n.type?function(n,e){function t(){p(n,e),i()}function o(){i()}function i(){f(a,t,r),f(u,o,r)}c(a,t,r),c(u,o,r)}(e,n):p(e,n)}}function w(e){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(n){e(n,l,r)})}w(c),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){e.push(n),s()}}(addEventListener,removeEventListener)</script><title>Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium</title><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2018-10-30T05:33:36.369Z"><meta data-rh="true" name="title" content="Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium"><meta data-rh="true" property="og:title" content="Feature Engineering in pyspark — Part I"><meta data-rh="true" property="twitter:title" content="Feature Engineering in pyspark — Part I"><meta data-rh="true" name="twitter:site" content="@Medium"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/76a57680a85"><meta data-rh="true" property="al:android:url" content="medium://p/76a57680a85"><meta data-rh="true" property="al:ios:url" content="medium://p/76a57680a85"><meta data-rh="true" name="apple-itunes-app" content="app-id=828256236,app-argument=medium://p/76a57680a85"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="Feature Engineering in pyspark — Part I"><meta data-rh="true" property="og:description" content="Feature Engineering in pyspark — Part I"><meta data-rh="true" property="twitter:description" content="Feature Engineering in pyspark — Part I"><meta data-rh="true" property="og:url" content="https://medium.com/@dhiraj.p.rai/essentials-of-feature-engineering-in-pyspark-part-i-76a57680a85"><meta data-rh="true" property="al:web:url" content="https://medium.com/@dhiraj.p.rai/essentials-of-feature-engineering-in-pyspark-part-i-76a57680a85"><meta data-rh="true" name="twitter:card" content="summary"><meta data-rh="true" property="article:author" content="/@dhiraj.p.rai"><meta data-rh="true" name="author" content="Dhiraj Rai"><meta data-rh="true" name="robots" content="index,follow"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" name="twitter:label1" value="Reading time"><meta data-rh="true" name="twitter:data1" value="8 min read"><meta data-rh="true" name="parsely-post-id" content="76a57680a85"><link data-rh="true" rel="publisher" href="https://plus.google.com/103654360130207659246"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://medium.com/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"><link data-rh="true" rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/m2.css"><link data-rh="true" rel="author" href="https://medium.com/@dhiraj.p.rai"><link data-rh="true" rel="canonical" href="https://medium.com/@dhiraj.p.rai/essentials-of-feature-engineering-in-pyspark-part-i-76a57680a85"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/76a57680a85"><script data-rh="true">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><style type="text/css" data-fela-rehydration="345" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}</style><style type="text/css" data-fela-rehydration="345" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-moz-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-webkit-keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-moz-keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}</style><style type="text/css" data-fela-rehydration="345" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:fixed}.n{top:0}.o{left:0}.p{right:0}.q{z-index:500}.r{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.s{transition:transform 300ms ease}.t{will-change:transform}.v{margin-left:auto}.w{margin-right:auto}.x{width:100%}.y{box-sizing:border-box}.aq{height:65px}.ar{display:flex}.as{align-items:center}.av{flex:1 0 auto}.aw{display:none}.ax{fill:rgba(0, 0, 0, 0.84)}.ba{flex:0 0 auto}.bb{font-family:medium-content-sans-serif-font, "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, Arial, sans-serif}.bc{font-style:normal}.bd{line-height:20px}.be{font-size:15.8px}.bf{letter-spacing:0px}.bg{color:rgba(0, 0, 0, 0.54)}.bh{fill:rgba(0, 0, 0, 0.54)}.bi{color:inherit}.bj{fill:inherit}.bk{font-size:inherit}.bl{border:inherit}.bm{font-family:inherit}.bn{letter-spacing:inherit}.bo{font-weight:inherit}.bp{padding:0}.bq{margin:0}.br:hover{cursor:pointer}.bs:hover{color:rgba(0, 0, 0, 0.9)}.bt:hover{fill:rgba(0, 0, 0, 0.9)}.bu:focus{outline:none}.bv:disabled{cursor:default}.bw:disabled{color:rgba(0, 0, 0, 0.54)}.bx:disabled{fill:rgba(0, 0, 0, 0.54)}.by{margin-left:16px}.bz{margin-right:16px}.cc{padding:4px 12px}.cd{color:rgba(0, 0, 0, 0.84)}.ce{background:0}.cf{border-color:rgba(0, 0, 0, 0.54)}.cg:hover{color:rgba(0, 0, 0, 0.97)}.ch:hover{fill:rgba(0, 0, 0, 0.97)}.ci:hover{border-color:rgba(0, 0, 0, 0.84)}.cj:disabled{fill:rgba(0, 0, 0, 0.76)}.ck:disabled{border-color:rgba(0, 0, 0, 0.2)}.cl:disabled{cursor:inherit}.cm:disabled:hover{color:rgba(0, 0, 0, 0.54)}.cn:disabled:hover{fill:rgba(0, 0, 0, 0.76)}.co:disabled:hover{border-color:rgba(0, 0, 0, 0.2)}.cp{border-radius:4px}.cq{border-width:1px}.cr{border-style:solid}.cs{display:inline-block}.ct{text-decoration:none}.cu{padding-bottom:10px}.cv{padding-top:10px}.cw{border-radius:50%}.cx{height:32px}.cy{width:32px}.cz{margin-bottom:0px}.db{padding-left:24px}.dc{padding-right:24px}.dd{max-width:728px}.de{flex-direction:column}.df{opacity:0}.dg{pointer-events:none}.dh{will-change:opacity}.di{transition:opacity 200ms}.dj{width:131px}.dk{left:50%}.dl{transform:translateX(-516px)}.dm{top:calc(65px + 54px + 40px)}.dn{padding-top:28px}.do{margin-bottom:19px}.dp{margin-left:-5px}.dq{margin-right:5px}.dr{position:relative}.ds{outline:0}.dt{border:0}.du{user-select:none}.dv{cursor:pointer}.dw> svg{pointer-events:none}.dx:active{border-style:none}.dy{fill:rgba(0, 0, 0, 0.76)}.dz:focus{fill:rgba(0, 0, 0, 0.9)}.ea{margin-top:5px}.eb button{text-align:left}.ec{font-weight:300}.ed{font-size:16px}.ee{margin-top:40px}.ef{clear:both}.eg{justify-content:center}.eh{margin:0 auto}.ei{padding:0 24px}.ej{list-style-type:none}.ek{margin-right:8px}.el{margin-bottom:8px}.em{border-radius:3px}.en{padding:5px 10px}.eo{background:rgba(0, 0, 0, 0.05)}.ep{line-height:22px}.eq{font-size:15px}.er{margin-top:15px}.es{justify-content:space-between}.et{border:1px solid rgba(0, 0, 0, 0.1)}.eu{height:60px}.ev{transition:border-color 150ms ease}.ew{width:60px}.ex::before{background:
      radial-gradient(circle, rgba(0, 0, 0, 0.84) 60%, transparent 70%)
    }.ey::before{border-radius:50%}.ez::before{content:""}.fa::before{display:block}.fb::before{z-index:0}.fc::before{left:0}.fd::before{height:100%}.fe::before{position:absolute}.ff::before{top:0}.fg::before{width:100%}.fh:hover::before{animation:k2 2000ms infinite cubic-bezier(.1,.12,.25,1)}.fi:active{border-style:solid}.fj{background:rgba(255, 255, 255, 1)}.fk{z-index:2}.fl{height:100%}.fm{position:absolute}.fn{padding-right:8px}.fo{padding-top:32px}.fp{border-top:1px solid rgba(0, 0, 0, 0.1)}.fq{margin-bottom:25px}.fr{margin-top:25px}.fs{margin-bottom:32px}.ft{min-height:80px}.fy{width:80px}.fz{height:80px}.ga{fill:rgba(3, 168, 124, 1)}.gb{width:calc(100% + 10px)}.gc{height:calc(100% + 10px)}.gd{top:-5px}.ge{left:-5px}.gf{padding-left:102px}.gh{text-transform:uppercase}.gi{letter-spacing:0.05em}.gj{margin-bottom:6px}.gk{font-weight:600}.gl{font-size:28px}.gm{line-height:36px}.gn{color:rgba(2, 158, 116, 1)}.go{border-color:rgba(3, 168, 124, 1)}.gp:hover{color:rgba(1, 143, 105, 1)}.gq:hover{fill:rgba(2, 158, 116, 1)}.gr:hover{border-color:rgba(2, 158, 116, 1)}.gs{max-width:555px}.gt{max-width:450px}.gu{font-size:18px}.gv{line-height:24px}.gx{padding-top:25px}.gy{padding:20px}.gz{border:1px solid rgba(3, 168, 124, 1)}.ha{text-align:center}.hb{margin-top:64px}.hc{background-color:rgba(0, 0, 0, 0.02)}.hl{padding:60px 0}.hm{background-color:rgba(0, 0, 0, 0.9)}.ho{padding-bottom:48px}.hp{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.hq{margin:0 -12px}.hr{margin:0 12px}.hs{flex:1 1 0}.ht{padding-bottom:12px}.hu:hover{color:rgba(255, 255, 255, 0.99)}.hv:hover{fill:rgba(255, 255, 255, 0.99)}.hw:disabled{color:rgba(255, 255, 255, 0.7)}.hx:disabled{fill:rgba(255, 255, 255, 0.7)}.hy{color:rgba(255, 255, 255, 0.98)}.hz{fill:rgba(255, 255, 255, 0.98)}.ia{text-align:inherit}.ib{font-size:21.6px}.ic{letter-spacing:-0.32px}.id{color:rgba(255, 255, 255, 0.7)}.ie{fill:rgba(255, 255, 255, 0.7)}.if{text-decoration:underline}.ig{padding-bottom:8px}.ih{padding-top:8px}.ii{width:200px}.ik:hover{text-decoration:underline}.il{margin:15px 0}.im{top:calc(100vh + 100px)}.in{bottom:calc(100vh + 100px)}.io{width:10px}.ip{word-break:break-word}.iq{word-wrap:break-word}.ir:after{display:block}.is:after{content:""}.it:after{clear:both}.iu{line-height:1.23}.iv{letter-spacing:0}.iw{font-family:medium-content-title-font, Georgia, Cambria, "Times New Roman", Times, serif}.ix{font-size:40px}.jd{margin-bottom:-0.27em}.je{line-height:48px}.jf{margin-top:32px}.jg{width:48px}.jh{height:48px}.ji{width:calc(100% + 8px)}.jj{height:calc(100% + 8px)}.jk{top:-4px}.jl{left:-4px}.jm{margin-left:12px}.jn{margin-bottom:2px}.jp{overflow:hidden}.jq{max-height:20px}.jr{text-overflow:ellipsis}.js{display:-webkit-box}.jt{-webkit-line-clamp:1}.ju{-webkit-box-orient:vertical}.jv{margin-left:8px}.jw{padding:0px 8px}.jx{line-height:18px}.kd{max-width:300px}.ke{transition:opacity 100ms 400ms}.kf{transform:translateZ(0)}.kg{margin:auto}.kh{background-color:rgba(0, 0, 0, 0.05)}.ki{padding-bottom:56.000000000000014%}.kj{filter:blur(20px)}.kk{transform:scale(1.1)}.kl{line-height:1.58}.km{letter-spacing:-0.004em}.kn{font-family:medium-content-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.ky{margin-bottom:-0.46em}.kz{background-repeat:repeat-x}.la{background-image:linear-gradient(to right,rgba(0, 0, 0, 0.84) 100%,rgba(0, 0, 0, 0.84) 0);background-image:url('data:image/svg+xml;utf8,<svg preserveAspectRatio="none" viewBox="0 0 1 1" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="0" x2="1" y2="1" stroke="rgba(0, 0, 0, 0.84)" /></svg>')}.lb{background-size:1px 1px}.lc{background-position:0 1.05em;background-position:0 calc(1em + 1px)}.ld{overflow-x:auto}.le{line-height:1.18}.lf{letter-spacing:-0.022em}.lg{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.lh{margin-top:-0.09em}.li{margin-bottom:-0.09em}.lj{white-space:pre-wrap}.lk{line-height:1.12}.lv{margin-bottom:-0.28em}.mg{max-width:1013px}.mh{padding-bottom:19.34846989141165%}</style><style type="text/css" data-fela-rehydration="345" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.an{padding-left:24px}.ao{padding-right:24px}.ap{max-width:1080px}.hk{padding:0 24px}.jc{margin-top:0.78em}.kc{margin-top:56px}.kw{font-size:21px}.kx{margin-top:2em}.lt{font-size:34px}.lu{margin-top:1.95em}.ma{margin-top:0.86em}.mf{margin-top:1.91em}</style><style type="text/css" data-fela-rehydration="345" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ak{padding-left:24px}.al{padding-right:24px}.am{max-width:1080px}</style><style type="text/css" data-fela-rehydration="345" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.ah{padding-left:24px}.ai{padding-right:24px}.aj{max-width:904px}</style><style type="text/css" data-fela-rehydration="345" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ae{padding-left:24px}.af{padding-right:24px}.ag{max-width:728px}.at{height:56px}.au{display:flex}.ay{margin-left:-5px}.az{display:block}.ca{margin-left:10px}.cb{margin-right:10px}.da{margin-bottom:0px}.fu{margin-bottom:24px}.fv{align-items:center}.fw{width:102px}.fx{position:relative}.gg{padding-left:0}.gw{margin-top:24px}.hn{padding:32px 0}.ij{width:140px}</style><style type="text/css" data-fela-rehydration="345" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.z{padding-left:24px}.ab{padding-right:24px}.ac{max-width:552px}.hd{padding:0 24px}.iy{margin-top:0.39em}.jo{margin-bottom:0px}.jy{margin-top:40px}.ko{font-size:18px}.kp{margin-top:1.56em}.ll{font-size:30px}.lm{margin-top:1.2em}.lw{margin-top:0.67em}.mb{margin-top:1.41em}</style><style type="text/css" data-fela-rehydration="345" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.hi{max-width:1080px}.hj{padding:0 24px}.jb{margin-top:0.78em}.kb{margin-top:56px}.ku{font-size:21px}.kv{margin-top:2em}.lr{font-size:34px}.ls{margin-top:1.95em}.lz{margin-top:0.86em}.me{margin-top:1.91em}</style><style type="text/css" data-fela-rehydration="345" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.hg{max-width:904px}.hh{padding:0 24px}.ja{margin-top:0.78em}.ka{margin-top:56px}.ks{font-size:21px}.kt{margin-top:2em}.lp{font-size:34px}.lq{margin-top:1.95em}.ly{margin-top:0.86em}.md{margin-top:1.91em}</style><style type="text/css" data-fela-rehydration="345" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.he{max-width:728px}.hf{padding:0 24px}.iz{margin-top:0.39em}.jz{margin-top:40px}.kq{font-size:18px}.kr{margin-top:1.56em}.ln{font-size:30px}.lo{margin-top:1.2em}.lx{margin-top:0.67em}.mc{margin-top:1.41em}</style><style type="text/css" data-fela-rehydration="345" data-fela-type="RULE" media="print">.u{display:none}</style><script charset="utf-8" src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/vendors_tracing.db265f32.chunk.js.download"></script><script charset="utf-8" src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/tracing.48bfc3d4.chunk.js.download"></script><script src="chrome-extension://mooikfkahbdckldjjndioackbalphokd/assets/prompt.js"></script><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":null,"thumbnailUrl":null,"url":"https:\u002F\u002Fmedium.com\u002F@dhiraj.p.rai\u002Fessentials-of-feature-engineering-in-pyspark-part-i-76a57680a85","dateCreated":"2018-10-29T10:33:00.870Z","datePublished":"2018-10-29T10:33:00.870Z","dateModified":"2018-10-30T05:33:36.369Z","headline":"Feature Engineering in pyspark — Part I","name":"Feature Engineering in pyspark — Part I","identifier":"76a57680a85","keywords":["Lite:true","Tag:Python","Tag:Feature Engineering","Tag:Data Preprocessing","Tag:Spark","Tag:Pyspark","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:0"],"author":{"@type":"Person","name":"Dhiraj Rai","url":"https:\u002F\u002Fmedium.com\u002F@dhiraj.p.rai"},"creator":["Dhiraj Rai"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F385\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@dhiraj.p.rai\u002Fessentials-of-feature-engineering-in-pyspark-part-i-76a57680a85"}</script></head><body data-gr-c-s-loaded="true"><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><nav class="l m n o p c q r s t u" style="transform: translateY(-100%);"><div class="branch-journeys-top"><section class="v w x y l z ab ac ae af ag ah ai aj ak al am an ao ap"><div class="aq ar as at au"><div class="l av q"><div class="ar as"><a href="https://medium.com/?source=post_page---------------------------" aria-label="Homepage"><div class="aw g"><svg height="22" width="112" viewBox="0 0 111.5 22" class="ax"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></div><div class="l ay az"><svg width="45" height="45" viewBox="0 0 45 45" class="ax"><path d="M5 40V5h35v35H5zm8.56-12.63c0 .56-.03.69-.32 1.03L10.8 31.4v.4h6.97v-.4L15.3 28.4c-.29-.34-.34-.5-.34-1.03v-8.95l6.13 13.36h.71l5.26-13.36v10.64c0 .3 0 .35-.19.53l-1.85 1.8v.4h9.2v-.4l-1.83-1.8c-.18-.18-.2-.24-.2-.53V15.94c0-.3.02-.35.2-.53l1.82-1.8v-.4h-6.47l-4.62 11.55-5.2-11.54h-6.8v.4l2.15 2.63c.24.3.29.37.29.77v10.35z"></path></svg></div></a></div></div><div class="l ba q"><span class="bb b bc bd be bf l bg bh"><div class="ar as"><a href="https://medium.com/search?source=post_page---------------------------" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx"><svg width="25" height="25" viewBox="0 0 25 25" class="by bz l ca cb"><path d="M20.07 18.93l-4.16-4.15a6 6 0 1 0-.88.88l4.15 4.16a.62.62 0 1 0 .89-.89zM6.5 11a4.75 4.75 0 1 1 9.5 0 4.75 4.75 0 0 1-9.5 0z"></path></svg></a><div class="bz ar cb"><div class="cs"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx l"><svg width="25" height="25" viewBox="-293 409 25 25" class="il l"><path d="M-273.33 423.67l-1.67-1.52v-3.65a5.5 5.5 0 0 0-6.04-5.47 5.66 5.66 0 0 0-4.96 5.71v3.41l-1.68 1.55a1 1 0 0 0-.32.74V427a1 1 0 0 0 1 1h3.49a3.08 3.08 0 0 0 3.01 2.45 3.08 3.08 0 0 0 3.01-2.45h3.49a1 1 0 0 0 1-1v-2.59a1 1 0 0 0-.33-.74zm-7.17 5.63c-.84 0-1.55-.55-1.81-1.3h3.62a1.92 1.92 0 0 1-1.81 1.3zm6.35-2.45h-12.7v-2.35l1.63-1.5c.24-.22.37-.53.37-.85v-3.41a4.51 4.51 0 0 1 3.92-4.57 4.35 4.35 0 0 1 4.78 4.33v3.65c0 .32.14.63.38.85l1.62 1.48v2.37z"></path></svg></button></div></div><div class="bz l g"><div><a href="https://medium.com/membership?source=upgrade_membership---nav_full------------------------" class="cc cd ax ce cf cg ch ci br bw cj ck cl cm cn co cp bb b bc bd be bf cq cr y cs ct bu">Upgrade</a></div></div><div class="ar"><div class="cu cv ar as"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx"><img alt="mohamed refai mohamed rilfi" src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/0_4f53HvVWY5tgWBXr.jpg" class="l cw cx cy" width="32" height="32"></button></div></div></div></span></div></div></section></div></nav><div class="cz aq l da at"></div><article><section class="db dc v w x dd y ar de"></section><span class="l"></span><div><div class="fm o im in io dg"></div><section class="ip iq ir is it"><div class="y eh x dd db dc"><div><div id="da6f" class="iu iv cd bc iw b ix iy iz ja jb jc jd"><h1 class="iw b ix je cd">Feature Engineering in pyspark — Part I</h1></div><div class="jf"><div class="as ar"><div><a href="https://medium.com/@dhiraj.p.rai?source=post_page---------------------------"><div class="dr jg jh"><svg width="52" height="58" viewBox="0 0 52 58" class="ga fm ji jj jk jl dg"><path d="M1.49 16.25A27.53 27.53 0 0 1 26 1.55V.45A28.63 28.63 0 0 0 .51 15.75l.98.5zM26 1.55a27.53 27.53 0 0 1 24.51 14.7l.98-.5A28.63 28.63 0 0 0 26 .45v1.1zm24.51 40.2A27.53 27.53 0 0 1 26 56.45v1.1a28.63 28.63 0 0 0 25.49-15.3l-.98-.5zM26 56.45a27.53 27.53 0 0 1-24.51-14.7l-.98.5A28.63 28.63 0 0 0 26 57.55v-1.1z"></path></svg><img alt="Dhiraj Rai" src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/1_qAdpdVzWtmqiylPC3UKruQ.jpeg" class="l cw jh jg" width="48" height="48"></div></a></div><div class="jm x l"><div class="ar"><div style="flex:1"><span class="bb b bc bd be bf l cd ax"><div class="jn ar as jo" data-test-id="postByline"><span class="bb ec ed bd jp jq jr js jt ju cd"><a class="bi bj bk bl bm bn bo bp bq br ik bu bv bw bx" href="https://medium.com/@dhiraj.p.rai?source=post_page---------------------------">Dhiraj Rai</a></span><div class="jv l ba h"><button class="jw ce gn ga go gp gq gr br cp bb b bc jx eq bf cq cr y cs ct bu">Follow</button></div></div></span></div></div><span class="bb b bc bd be bf l bg bh"><span class="bb ec ed bd jp jq jr js jt ju bg"><div><a class="bi bj bk bl bm bn bo bp bq br ik bu bv bw bx" href="https://medium.com/@dhiraj.p.rai/essentials-of-feature-engineering-in-pyspark-part-i-76a57680a85?source=post_page---------------------------">Oct 29, 2018</a> <!-- -->·<!-- --> <!-- -->8<!-- --> min read</div></span></span></div></div></div></div><figure class="jy jz ka kb kc ef kd v w paragraph-image"><div class="kg l dr kh"><div class="ki l"><div class="df ke fm n o fl x jp t kf"><img src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/1_W8RefeukLmfhlZ1olpkzpQ.jpeg" class="fm n o fl x kj kk" width="300" height="168"></div><img class="mi mj fm n o fl x fj" width="300" height="168" src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/1_W8RefeukLmfhlZ1olpkzpQ(1).jpeg"><noscript><img src="https://miro.medium.com/max/600/1*W8RefeukLmfhlZ1olpkzpQ.jpeg" class="fm n o fl x" width="300" height="168"/></noscript></div></div></figure><p id="0c09" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The most commonly used data pre-processing techniques in approaches in Spark are as follows</p><p id="7633" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">1) VectorAssembler</p><p id="323a" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">2)Bucketing</p><p id="fe59" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">3)Scaling and normalization</p><p id="5e11" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">4) Working with categorical features</p><p id="6567" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">5) Text data transformers</p><p id="2c54" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">6) Feature Manipulation</p><p id="9fce" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">7) PCA</p><p id="e63a" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Please find the complete jupyter notebook <a href="https://github.com/dhirajprai/SparkML/blob/master/SparkML/Feature_Engineering_Part_I.ipynb" class="bi ct kz la lb lc">here</a></p><p id="fbfb" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">This blog is mostly intended for who are new to Spark programming, specially pyspark. Therefore, this blog follows an illustrative approach to explain the commonly known data-preprocessing approaches.</p><p id="cefd" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">But before we do anything, we need to initialize a Spark session. This can be done as follows</p><pre class="jy jz ka kb kc gy eo ld"><span id="9b3d" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph=""># Initializing a Spark session<br>from pyspark.sql import SparkSession<br>spark = SparkSession.builder.master("local").appName("Word Count").config("spark.some.config.option","some-value").getOrCreate()</span></pre><p id="0e88" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Now let us download some sample datasets to play along with. The datasets I have used in the illustrations can be downloaded from <a href="https://github.com/databricks/Spark-The-Definitive-Guide" class="bi ct kz la lb lc">here</a></p><p id="b69c" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">For the purpose of demonstration we will be using three different datasets</p><p id="e559" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">1) retail-data/by-day</p><p id="d479" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">2) simple-ml-integers</p><p id="1ecf" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">3) simple-ml</p><p id="cb02" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">4) simple-ml-scaling</p><p id="9b32" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Lets us begin by reading the “retail-data/by-day” which is in .csv format and save it into a Spark dataframe named ‘sales’</p><pre class="jy jz ka kb kc gy eo ld"><span id="1826" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">sales = spark.read.format("csv").option("header","true").option("inferSchema", "true").load(r"data/retail-data/by-day/*.csv").coalesce(5).where("Description IS NOT NULL")</span></pre><p id="239b" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Lets us read the parquet files in “simple-ml-integers” and make a Spark dataframe named ‘fakeIntDF’</p><pre class="jy jz ka kb kc gy eo ld"><span id="f1d8" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">fakeIntDF=spark.read.parquet("/home/spark/DhirajR/Spark/feature_engineering/data/simple-ml-integers")</span></pre><p id="c8d8" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Lets us read the parquet files in “simple-ml” and make a Spark dataframe named ‘simpleDF’</p><pre class="jy jz ka kb kc gy eo ld"><span id="6bf2" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">simpleDF=spark.read.json(r"/home/spark/DhirajR/Spark/feature_engineering/data/simple-ml")</span></pre><p id="6794" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Lets us read the parquet files in “simple-ml-scaling” and make a Spark dataframe named ‘scaleDF’</p><pre class="jy jz ka kb kc gy eo ld"><span id="a283" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">scaleDF=spark.read.parquet(r"/home/spark/DhirajR/Spark/feature_engineering/data/simple-ml-scaling")</span></pre><p id="4989" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Please find the complete jupyter notebook <a href="https://github.com/dhirajprai/SparkML/blob/master/SparkML/Feature_Engineering_Part_I.ipynb" class="bi ct kz la lb lc">here</a></p><h1 id="bf7a" class="lk lf cd bc bb gk ll lm ln lo lp lq lr ls lt lu lv" data-selectable-paragraph="">Vector assembler</h1><p id="63d6" class="kl km cd bc kn b ko lw kq lx ks ly ku lz kw ma ky" data-selectable-paragraph="">The vector assembler is basically use to concatenate all the features into a single vector which can be further passed to the estimator or ML algorithm. In order to demo the ‘Vector Assembler’ we will use the ‘fakeIntDF’ which we had created in the previous steps.</p><p id="3849" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Let us see what columns we have in ‘fakeIntDF’ dataframe</p><pre class="jy jz ka kb kc gy eo ld"><span id="14c7" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">fakeIntDF.cache()<br>fakeIntDF.show()</span><span id="1620" class="le lf cd bc lg b ed mb mc md me mf li l lj" data-selectable-paragraph="">+----+----+----+<br>|int1|int2|int3|<br>+----+----+----+<br>|   7|   8|   9|<br>|   1|   2|   3|<br>|   4|   5|   6|<br>+----+----+----+</span></pre><p id="1353" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">So we have three columns, int1, int2, int3 with integer values within them.</p><p id="5b32" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">First, import the VectorAssembler from pyspark.ml.features. Once the Vector assembler is imported we are required to create the object of the same. Here I will create an object named “assembler”. The above result shows that we have three features in ‘fakeIntDF’ i.e. int1, int2, int3. Let us create the object assembler so as to combine the three features into a single column named features. At last, let us use the transform method to transform our dataset.</p><pre class="jy jz ka kb kc gy eo ld"><span id="ba83" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">from pyspark.ml.feature import VectorAssembler<br>assembler = VectorAssembler(inputCols=["int1", "int2", "int3"],outputCol="features")<br>assembler.transform(fakeIntDF).show()</span></pre><p id="a40e" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The output is as follows</p><pre class="jy jz ka kb kc gy eo ld"><span id="be5e" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">+----+----+----+-------------+<br>|int1|int2|int3|     features|<br>+----+----+----+-------------+<br>|   7|   8|   9|[7.0,8.0,9.0]|<br>|   1|   2|   3|[1.0,2.0,3.0]|<br>|   4|   5|   6|[4.0,5.0,6.0]|<br>+----+----+----+-------------+</span></pre><p id="1bd4" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The above results shows that a new column named “features” has been created which combined the “int1”, “int2”, “int3” into a single vector.</p><p id="c139" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Please find the complete jupyter notebook <a href="https://github.com/dhirajprai/SparkML/blob/master/SparkML/Feature_Engineering_Part_I.ipynb" class="bi ct kz la lb lc">here</a></p><h1 id="575b" class="lk lf cd bc bb gk ll lm ln lo lp lq lr ls lt lu lv" data-selectable-paragraph="">Bucketing</h1><p id="64e4" class="kl km cd bc kn b ko lw kq lx ks ly ku lz kw ma ky" data-selectable-paragraph="">Bucketing is a most straight forward approach for fro converting the continuous variables into categorical variable. In pyspark the task of bucketing can be easily accomplished using the Bucketizer class.</p><p id="50f3" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Firstly, we need to create bucket borders. Let us define a list bucketBorders =[-1.0, 5.0,10.0,250.0,600.0]</p><p id="8061" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Next, let us create a object of the Bucketizer class. Then we will apply the transform method to our target Dataframe “dataframe”</p><p id="7525" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Let us create a simple dataframe for demo purpose</p><pre class="jy jz ka kb kc gy eo ld"><span id="8702" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">data = [(-999.9,), (-0.5,), (-0.3,), (0.0,), (0.2,), (999.9,)]<br>dataFrame = spark.createDataFrame(data, ["features"])</span></pre><p id="f571" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Then we can import the Bucketizer class, create an object of this class, and apply the transform method to the dataframe we just created.</p><pre class="jy jz ka kb kc gy eo ld"><span id="d8f4" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">from pyspark.ml.feature import Bucketizer<br>bucketBorders=[-float("inf"), -0.5, 0.0, 0.5, float("inf")]</span><span id="f628" class="le lf cd bc lg b ed mb mc md me mf li l lj" data-selectable-paragraph="">bucketer=Bucketizer().setSplits(bucketBorders).setInputCol("features").setOutputCol("Buckets")<br>bucketer.transform(dataFrame).show()</span></pre><p id="15f4" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The output looks as follows:</p><pre class="jy jz ka kb kc gy eo ld"><span id="0ea9" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">+--------+-------+<br>|features|Buckets|<br>+--------+-------+<br>|  -999.9|    0.0|<br>|    -0.5|    1.0|<br>|    -0.3|    1.0|<br>|     0.0|    2.0|<br>|     0.2|    2.0|<br>|   999.9|    3.0|<br>+--------+-------+</span></pre><h1 id="0a94" class="lk lf cd bc bb gk ll lm ln lo lp lq lr ls lt lu lv" data-selectable-paragraph="">Scaling and normalization</h1><p id="a685" class="kl km cd bc kn b ko lw kq lx ks ly ku lz kw ma ky" data-selectable-paragraph="">Scaling and normalization is another common task that we come across while handling continuous variables. It is not always imperative but, highly recommended to scale and normalize the features before applying an ML algorithm in order to avert the risk of an algorithm being insensitive to a certain features.</p><p id="1b4c" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Spark ML provides us with a class “StandardScaler” for easy scaling and normalization of features</p><p id="cbbb" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Let us use the scaleDF dataframe that we had created previously to demonstrate the StandardScaler in pyspark.</p><pre class="jy jz ka kb kc gy eo ld"><span id="d90e" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">scaleDF.show()</span><span id="ffc1" class="le lf cd bc lg b ed mb mc md me mf li l lj" data-selectable-paragraph="">+---+--------------+<br>| id|      features|<br>+---+--------------+<br>|  0|[1.0,0.1,-1.0]|<br>|  1| [2.0,1.1,1.0]|<br>|  0|[1.0,0.1,-1.0]|<br>|  1| [2.0,1.1,1.0]|<br>|  1|[3.0,10.1,3.0]|<br>+---+--------------+</span><span id="1e8d" class="le lf cd bc lg b ed mb mc md me mf li l lj" data-selectable-paragraph="">from pyspark.ml.feature import StandardScaler<br>Scalerizer=StandardScaler().setInputCol("features").setOutputCol("Scaled_features")<br>Scalerizer.fit(scaleDF).transform(scaleDF).show()</span></pre><p id="dbb3" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The output looks as follows:</p><pre class="jy jz ka kb kc gy eo ld"><span id="5690" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">+---+--------------+------------------------------------------------<br>|id |features      |Scaled_features|<br>+---+--------------+------------------------------------------------<br>|0  |[1.0,0.1,-1.0]|[1.195228,0.02337,-0.597614]|<br>|1  |[2.0,1.1,1.0] |[2.390457,0.25713,0.597614]   |<br>|0  |[1.0,0.1,-1.0]|[1.19522,0.023376,-0.5976143046671968]|<br>|1  |[2.0,1.1,1.0] |[2.390457,0.257138,0.597614]   |<br>|1  |[3.0,10.1,3.0]|[3.585682.3609991,1.792842]  |<br>+---+--------------+------------------------------------------------</span></pre><h1 id="e80d" class="lk lf cd bc bb gk ll lm ln lo lp lq lr ls lt lu lv" data-selectable-paragraph="">MinMaxScaler</h1><p id="e718" class="kl km cd bc kn b ko lw kq lx ks ly ku lz kw ma ky" data-selectable-paragraph="">The StandardScaler standardizes the features with a zero mean and standard deviation of 1. Sometimes, we come across situations where we need to scale values within a given range (i.e. max and min). For such task Spark ML provdies a class named MinMaxScaler.</p><p id="6d62" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The StandardScaler and MinMaxScaler share the common soul, the only difference is that we can provide the minimum value and maximum values within which we wish to scale the features.</p><p id="9fee" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">For the sake of illustration, let us scale the features in the range 5 to 10.</p><pre class="jy jz ka kb kc gy eo ld"><span id="9d02" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">from pyspark.ml.feature import MinMaxScaler<br># Let us create an object of MinMaxScaler class<br>MinMaxScalerizer=MinMaxScaler().setMin(5).setMax(10).setInputCol("features").setOutputCol("MinMax_Scaled_features")<br>MinMaxScalerizer.fit(scaleDF).transform(scaleDF).show()</span></pre><p id="3296" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The output looks like this:</p><pre class="jy jz ka kb kc gy eo ld"><span id="87a9" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">+---+--------------+----------------------+<br>| id|      features|MinMax_Scaled_features|<br>+---+--------------+----------------------+<br>|  0|[1.0,0.1,-1.0]|         [5.0,5.0,5.0]|<br>|  1| [2.0,1.1,1.0]|         [7.5,5.5,7.5]|<br>|  0|[1.0,0.1,-1.0]|         [5.0,5.0,5.0]|<br>|  1| [2.0,1.1,1.0]|         [7.5,5.5,7.5]|<br>|  1|[3.0,10.1,3.0]|      [10.0,10.0,10.0]|<br>+---+--------------+----------------------+</span></pre><h1 id="20e7" class="lk lf cd bc bb gk ll lm ln lo lp lq lr ls lt lu lv" data-selectable-paragraph="">MinAbsScaler</h1><p id="89cc" class="kl km cd bc kn b ko lw kq lx ks ly ku lz kw ma ky" data-selectable-paragraph="">Sometimes we need to scalerize features between -1 to 1. The MinAbsScaler does exactly this by dividing the features by the maximum absolute values.</p><pre class="jy jz ka kb kc gy eo ld"><span id="ef20" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">from pyspark.ml.feature import MaxAbsScaler<br># Let us create an object of MinAbsScaler class<br>MinAbsScalerizer=MaxAbsScaler().setInputCol(“features”).setOutputCol(“MinAbs_Scaled_features”)<br>MinAbsScalerizer.fit(scaleDF).transform(scaleDF).show(truncate =False)</span></pre><p id="09b9" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The output looks like this:</p><pre class="jy jz ka kb kc gy eo ld"><span id="7294" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">+---+--------------+------------------------------------------------<br>|id |features      |MinAbs_Scaled_features|<br>+---+--------------+------------------------------------------------<br>|0  |[1.0,0.1,-1.0]|[0.33333,0.009900,-0.33333]|<br>|1  |[2.0,1.1,1.0] |[0.66666,0.108910,0.333333]|<br>|0  |[1.0,0.1,-1.0]|[0.333333,0.00990,-0.33333]|<br>|1  |[2.0,1.1,1.0] |[0.666666,0.108910,0.33333]|<br>|1  |[3.0,10.1,3.0]|[1.0,1.0,1.0]              |                                        <br>+---+--------------+------------------------------------------------</span></pre><p id="87a8" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">So it is observed that all the features got scaled between -1 to 1.</p><h1 id="bb51" class="lk lf cd bc bb gk ll lm ln lo lp lq lr ls lt lu lv" data-selectable-paragraph="">ElementwiseProduct</h1><p id="757c" class="kl km cd bc kn b ko lw kq lx ks ly ku lz kw ma ky" data-selectable-paragraph="">What differentiates ElementwiseProduct from the previously mentioned scalizers is the fact that, in ElementwiseProduct the features are scaled based on a multiplying factor.</p><p id="7a7a" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The below mentioned code snippet will transform the feature#1 → 10 times, feature#2 → 0.1 times and feature#3 → -1 times</p><p id="8ab6" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">For example → the features [10, 20, 30] if scaled by [10, 0.1, -1] will become [100, 2.0, -30]</p><pre class="jy jz ka kb kc gy eo ld"><span id="8d66" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">from pyspark.ml.feature import ElementwiseProduct<br>from pyspark.ml.linalg import Vectors</span><span id="69df" class="le lf cd bc lg b ed mb mc md me mf li l lj" data-selectable-paragraph=""># Let us define a scaling vector</span><span id="19a4" class="le lf cd bc lg b ed mb mc md me mf li l lj" data-selectable-paragraph="">ScalebyVector=Vectors.dense([10,0.1,-1])</span><span id="29be" class="le lf cd bc lg b ed mb mc md me mf li l lj" data-selectable-paragraph=""># Let us create an object of the class Elementwise product<br>ScalingUp=ElementwiseProduct().setScalingVec(ScalebyVector).setInputCol("features").setOutputCol("ElementWiseProduct")<br># Let us transform<br>ScalingUp.transform(scaleDF).show()</span></pre><p id="cc24" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The output looks like this:</p><pre class="jy jz ka kb kc gy eo ld"><span id="ce9c" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">+---+--------------+-------------------------------+<br>|id |features      |ElementWiseProduct             |<br>+---+--------------+-------------------------------+<br>|0  |[1.0,0.1,-1.0]|[10.0,0.010,1.0]               |<br>|1  |[2.0,1.1,1.0] |[20.0,0.110,-1.0]              |<br>|0  |[1.0,0.1,-1.0]|[10.0,0.010,1.0]               |<br>|1  |[2.0,1.1,1.0] |[20.0,0.110,-1.0]              |<br>|1  |[3.0,10.1,3.0]|[30.0,1.01,-3.0]               |<br>+---+--------------+-------------------------------+</span></pre><p id="e352" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">So it is observed that all the features got scaled between -1 to 1.</p><h1 id="a143" class="lk lf cd bc bb gk ll lm ln lo lp lq lr ls lt lu lv" data-selectable-paragraph="">Normalizer</h1><p id="46ed" class="kl km cd bc kn b ko lw kq lx ks ly ku lz kw ma ky" data-selectable-paragraph="">The normalizer allows the user to calculate distance between features. The most commonly used distance metrics are “Manhattan distance” and the “Euclidean distance”. The Normalizer takes a parameter “p” from the user which represents the power norm.</p><p id="dda7" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">For example, p = 1 indicates L1 norm; p = 2 indicates L2 norm.</p><figure class="jy jz ka kb kc ef mg v w paragraph-image"><div class="kg l dr kh"><div class="mh l"><div class="mi mj fm n o fl x jp t kf"><img src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/1_Hm93mbSIY1P8SMGq75eg9w.png" class="fm n o fl x kj kk" width="700" height="135"></div><img class="df ke fm n o fl x fj" width="700" height="135"><noscript><img src="https://miro.medium.com/max/1400/1*Hm93mbSIY1P8SMGq75eg9w.png" class="fm n o fl x" width="700" height="135"/></noscript></div></div></figure><p id="21dc" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">In fact, p can also be infinity.</p><pre class="jy jz ka kb kc gy eo ld"><span id="b9ae" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">from pyspark.ml.feature import Normalizer<br>l1_norm=Normalizer().setP(1).setInputCol("features").setOutputCol("l1_norm")<br>l2_norm=Normalizer().setP(2).setInputCol("features").setOutputCol("l2_norm")<br>linf_norm=Normalizer().setP(float("inf")).setInputCol("features").setOutputCol("linf_norm")<br># Let us transform<br>l1_norm.transform(scaleDF).show(truncate=False)</span></pre><p id="35c6" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The output looks as follows:</p><pre class="jy jz ka kb kc gy eo ld"><span id="188d" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">+---+--------------+-----------------------------------------------+<br>|id |features      |l1_norm                    |<br>+---+--------------+-----------------------------------------------+<br>|0  |[1.0,0.1,-1.0]|[0.47619,0.047619,-0.47619]|<br>|1  |[2.0,1.1,1.0] |[0.48780,0.26829,0.24390]  |<br>|0  |[1.0,0.1,-1.0]|[0.47619,0.047619,-0.47619]|<br>|1  |[2.0,1.1,1.0] |[0.48780,0.26829,0.24390]  |<br>|1  |[3.0,10.1,3.0]|[0.18633,0.62732,0.18633]  |<br>+---+--------------+-----------------------------------------------+</span></pre><p id="d762" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Please find the complete jupyter notebook <a href="https://github.com/dhirajprai/SparkML/blob/master/SparkML/Feature_Engineering_Part_I.ipynb" class="bi ct kz la lb lc">here</a></p><h1 id="606c" class="lk lf cd bc bb gk ll lm ln lo lp lq lr ls lt lu lv" data-selectable-paragraph="">StringIndexer (Converting strings to numerical values)</h1><p id="b13d" class="kl km cd bc kn b ko lw kq lx ks ly ku lz kw ma ky" data-selectable-paragraph="">Most of the ML algorithms require converting categorical features into numerical ones.</p><p id="7ecd" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Sparks StringIndexer maps strings into different numerical values. We will use the simpleDF dataframe for demo purpose which consist of a feature “lab” which is a categorical variable.</p><pre class="jy jz ka kb kc gy eo ld"><span id="3eb5" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">simpleDF.show(5)</span><span id="4edf" class="le lf cd bc lg b ed mb mc md me mf li l lj" data-selectable-paragraph="">+-----+----+------+------------------+<br>|color| lab|value1|            value2|<br>+-----+----+------+------------------+<br>|green|good|     1|14.386294994851129|<br>| blue| bad|     8|14.386294994851129|<br>| blue| bad|    12|14.386294994851129|<br>|green|good|    15| 38.97187133755819|<br>|green|good|    12|14.386294994851129|<br>+-----+----+------+------------------+<br>only showing top 5 rows</span></pre><p id="060e" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Let us apply string indexer to a categorical variable named “lab” in “simpleDF” DataFrame.</p><pre class="jy jz ka kb kc gy eo ld"><span id="a789" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">from pyspark.ml.feature import StringIndexer<br># Let us create an object of the class StringIndexer<br>lblindexer=StringIndexer().setInputCol("lab").setOutputCol("LabelIndexed")<br># Let us transform<br>idxRes=lblindexer.fit(simpleDF).transform(simpleDF)<br>idxRes=idxRes.drop("value1","value2")<br>idxRes.show(5)</span></pre><p id="3938" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The output looks as follows. It can be seen that a new column is added to the dataframe, which contains encoded values for “good” and “bad” , like, 1.0 for good and 0.0 for bad.</p><pre class="jy jz ka kb kc gy eo ld"><span id="23d9" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">+-----+----+------------+<br>|color| lab|LabelIndexed|<br>+-----+----+------------+<br>|green|good|         1.0|<br>| blue| bad|         0.0|<br>| blue| bad|         0.0|<br>|green|good|         1.0|<br>|green|good|         1.0|<br>+-----+----+------------+<br>only showing top 5 rows</span></pre><h1 id="420f" class="lk lf cd bc bb gk ll lm ln lo lp lq lr ls lt lu lv" data-selectable-paragraph="">IndexToString</h1><p id="9d9c" class="kl km cd bc kn b ko lw kq lx ks ly ku lz kw ma ky" data-selectable-paragraph="">Sometimes we come across situations where it is necessary to convert the indexed values back to text. To do this the Spark ML provides a class “IndextoString”. To demonstrate the “IndextoString” let us use the “LabelIndexed” column of “idxRes” dataframe which was created in the previous code snippet.</p><p id="5adf" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The LabelIndexed column consists of 1.0 → good and 0.0 → bad. Now let us try and reverse this</p><pre class="jy jz ka kb kc gy eo ld"><span id="680c" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">from pyspark.ml.feature import IndexToString</span><span id="e997" class="le lf cd bc lg b ed mb mc md me mf li l lj" data-selectable-paragraph="">LabelReverse=IndexToString().setInputCol("LabelIndexed")\<br>.setOutputCol("ReverseIndex")</span><span id="67a1" class="le lf cd bc lg b ed mb mc md me mf li l lj" data-selectable-paragraph="">LabelReverse.transform(idxRes).show(5)</span></pre><p id="f7dd" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The output looks as follows. It can be seen that a new column named “ReverseIndex” is now added to the dataframe “idxRes” which, obviously reverses the values in “LabelIndexed” column to text. E.g. 1.0 →good and 0.0 → bad</p><pre class="jy jz ka kb kc gy eo ld"><span id="2565" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">+-----+----+------------+------------+<br>|color| lab|LabelIndexed|ReverseIndex|<br>+-----+----+------------+------------+<br>|green|good|         1.0|        good|<br>| blue| bad|         0.0|         bad|<br>| blue| bad|         0.0|         bad|<br>|green|good|         1.0|        good|<br>|green|good|         1.0|        good|<br>+-----+----+------------+------------+<br>only showing top 5 rows</span></pre><h1 id="7f8e" class="lk lf cd bc bb gk ll lm ln lo lp lq lr ls lt lu lv" data-selectable-paragraph="">Indexing within Vectors</h1><p id="5f04" class="kl km cd bc kn b ko lw kq lx ks ly ku lz kw ma ky" data-selectable-paragraph="">Spark offers yet another class named “VectorIndexer”. The “VectorIndexer” identifies the categorical variables with a set of features which is already been vectorized and converts it into a categorical feature with zero based category indices.</p><p id="2f0f" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">For the purpose of illustration let us first create a new DataFrame named “dataln”with features in the form of Vectors.</p><pre class="jy jz ka kb kc gy eo ld"><span id="129c" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">from pyspark.ml.linalg import Vectors<br>dataln=spark.createDataFrame([(Vectors.dense(1,2,3),1),(Vectors.dense(2,5,6),2),(Vectors.dense(1,8,9),3)]).toDF("features","labels")<br>dataln.show()</span></pre><p id="2dbb" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">The dataframe contains three rows and two columns. 1) Three features in the form of Vectors, here the first feature is a categorical variable 2) labels.</p><pre class="jy jz ka kb kc gy eo ld"><span id="3552" class="le lf cd bc lg b ed lh li l lj" data-selectable-paragraph="">+-------------+------+<br>|     features|labels|<br>+-------------+------+<br>|[1.0,2.0,3.0]|     1|<br>|[2.0,5.0,6.0]|     2|<br>|[1.0,8.0,9.0]|     3|<br>+-------------+------+</span></pre><p id="22a4" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">Now let us use the “VectorIndexer” to automatically identify the categorical feature and index it.</p><p id="0aa1" class="kl km cd bc kn b ko kp kq kr ks kt ku kv kw kx ky" data-selectable-paragraph="">There are a few more feature engineering techniques, please refer my python notebook for the same at this github <a href="https://github.com/dhirajprai/SparkML" class="bi ct kz la lb lc">link</a>.</p><h1 id="b46d" class="lk lf cd bc bb gk ll lm ln lo lp lq lr ls lt lu lv" data-selectable-paragraph="">Conclusion</h1><p id="569b" class="kl km cd bc kn b ko lw kq lx ks ly ku lz kw ma ky" data-selectable-paragraph="">In this humble blog I have tried to cover some basic but widely used data preprocessing transformations offered by Spark ML. I have demonstrated each of them with an illustration. However, there is a plethora of Spark tools to aid the feature engineering task some of these I will try to cover them in my next blog. Also, I will try to implement an end-to-end classification model in pyspark in my next blog.</p><h1 id="34b0" class="lk lf cd bc bb gk ll lm ln lo lp lq lr ls lt lu lv" data-selectable-paragraph="">Bibliography</h1><p id="98c9" class="kl km cd bc kn b ko lw kq lx ks ly ku lz kw ma ky" data-selectable-paragraph="">Chambers, B., &amp; Zaharia, M., 2018. Spark: The definitive guide. “ O’Reilly Media, Inc.”.</p></div></section></div></article><div class="mi py dh m di dj dk dl dm e" data-test-id="post-sidebar"><div class="ar de"><div class="dn do dp ar"><div class="ar as"><div class="dq l dr"><div class=""><button class="bp ds dt du dv dw dx dy dz"><svg width="29" height="29"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="ea l"><div class="eb"><h4 class="bb ec ed bd bg"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx">58 </button></h4></div></div></div></div><div class="dy"><div><div class="cs"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div><div><div class="ee ef ar de eg"><div class="eh dd ei x"><ul class="bp bq"><li class="cs ej ek el"><a href="https://medium.com/tag/python" class="em en ct bg l eo ep a b eq">Python</a></li><li class="cs ej ek el"><a href="https://medium.com/tag/feature-engineering" class="em en ct bg l eo ep a b eq">Feature Engineering</a></li><li class="cs ej ek el"><a href="https://medium.com/tag/data-preprocessing" class="em en ct bg l eo ep a b eq">Data Preprocessing</a></li><li class="cs ej ek el"><a href="https://medium.com/tag/spark" class="em en ct bg l eo ep a b eq">Spark</a></li><li class="cs ej ek el"><a href="https://medium.com/tag/pyspark" class="em en ct bg l eo ep a b eq">Pyspark</a></li></ul><div class="er ar es u"><div class="ar as"><div class="bz l dr"><div class=""><div class="c et cw ar as eu dr ev ew ci ex ey ez fa fb fc fd fe ff fg fh"><button class="bp ds dt du dv dw fi as fj cw ar dy eg fk o fl fm n x dz"><svg width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.34l-3.64-6.4c-.3-.43-.71-.73-1.16-.8a1.12 1.12 0 0 0-.9.21c-.62.5-.73 1.18-.32 2.06l1.22 2.6 1.4 2.45c2.23 4.09 1.51 8-2.15 11.66a9.6 9.6 0 0 1-.8.71 6.53 6.53 0 0 0 4.3-2.1c3.82-3.82 3.57-7.87 2.05-10.39zm-6.25 11.08c3.35-3.35 4-6.78 1.98-10.47L21.2 12c-.3-.43-.71-.72-1.16-.8a1.12 1.12 0 0 0-.9.22c-.62.49-.74 1.18-.32 2.06l1.72 3.63a.5.5 0 0 1-.81.57l-8.91-8.9a1.33 1.33 0 0 0-1.89 1.88l5.3 5.3a.5.5 0 0 1-.71.7l-5.3-5.3-1.49-1.49c-.5-.5-1.38-.5-1.88 0a1.34 1.34 0 0 0 0 1.89l1.49 1.5 5.3 5.28a.5.5 0 0 1-.36.86.5.5 0 0 1-.36-.15l-5.29-5.29a1.34 1.34 0 0 0-1.88 0 1.34 1.34 0 0 0 0 1.89l2.23 2.23L9.3 21.4a.5.5 0 0 1-.36.85.5.5 0 0 1-.35-.14l-3.32-3.33a1.33 1.33 0 0 0-1.89 0 1.32 1.32 0 0 0-.39.95c0 .35.14.69.4.94l6.39 6.4c3.53 3.53 8.86 5.3 12.82 1.35zM12.73 9.26l5.68 5.68-.49-1.04c-.52-1.1-.43-2.13.22-2.89l-3.3-3.3a1.34 1.34 0 0 0-1.88 0 1.33 1.33 0 0 0-.4.94c0 .22.07.42.17.61zm14.79 19.18a7.46 7.46 0 0 1-6.41 2.31 7.92 7.92 0 0 1-3.67.9c-3.05 0-6.12-1.63-8.36-3.88l-6.4-6.4A2.31 2.31 0 0 1 2 19.72a2.33 2.33 0 0 1 1.92-2.3l-.87-.87a2.34 2.34 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.64l-.14-.14a2.34 2.34 0 0 1 0-3.3 2.39 2.39 0 0 1 3.3 0l.14.14a2.33 2.33 0 0 1 3.95-1.24l.09.09c.09-.42.29-.83.62-1.16a2.34 2.34 0 0 1 3.3 0l3.38 3.39a2.17 2.17 0 0 1 1.27-.17c.54.08 1.03.35 1.45.76.1-.55.41-1.03.9-1.42a2.12 2.12 0 0 1 1.67-.4 2.8 2.8 0 0 1 1.85 1.25l3.65 6.43c1.7 2.83 2.03 7.37-2.2 11.6zM13.22.48l-1.92.89 2.37 2.83-.45-3.72zm8.48.88L19.78.5l-.44 3.7 2.36-2.84zM16.5 3.3L15.48 0h2.04L16.5 3.3z" fill-rule="evenodd"></path></svg></button></div></div></div><div class="ea l"><div class="eb"><h4 class="bb ec ed bd cd"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx">58 claps</button></h4></div></div></div><div class="ar as"><div class="fn l ba g"><a href="https://medium.com/p/76a57680a85/share/twitter?source=follow_footer--------------------------follow_footer-" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx"><svg width="29" height="29" class="ax"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="fn l ba g"><a href="https://medium.com/p/76a57680a85/share/facebook?source=follow_footer--------------------------follow_footer-" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx"><svg width="29" height="29" class="ax"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="fn aw az"><div class="cs"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx"><svg width="25" height="25" class="ax"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div><div class="fn l ba"><div class="dy"><div><div class="cs"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div><div class="cs"><div class="l ba"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx"><svg width="25" height="25" viewBox="-480.5 272.5 21 21" class="ax"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></button></div></div></div></div><div class="fo fp fq fr l u"><div class="fs ft l dr"><span class="l fu au fv"><div class="l fm fw fx"><a href="https://medium.com/@dhiraj.p.rai?source=follow_footer--------------------------follow_footer-"><div class="dr fy fz"><svg width="82" height="92" viewBox="0 0 82 92" class="ga fm gb gc gd ge dg"><path d="M1.58 26.29C8.86 11.67 23.78 1.65 41 1.65V.35C23.26.35 7.9 10.67.42 25.71l1.16.58zM41 1.65c17.22 0 32.14 10.02 39.42 24.64l1.16-.58C74.1 10.67 58.74.35 41 .35v1.3zm39.42 64.06C73.14 80.33 58.22 90.35 41 90.35v1.3c17.74 0 33.1-10.32 40.58-25.36l-1.16-.58zM41 90.35c-17.22 0-32.14-10.02-39.42-24.64l-1.16.58C7.9 81.33 23.26 91.65 41 91.65v-1.3z"></path></svg><img alt="Dhiraj Rai" src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/1_qAdpdVzWtmqiylPC3UKruQ(1).jpeg" class="l cw fz fy" width="80" height="80"></div></a></div><span class="l"><div class="gf l gg"><p class="bb ec eq bd bg gh gi">Written by</p></div><div class="gf gj ar gg"><div class="x ar as es"><h2 class="bb gk gl gm cd"><a class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx" href="https://medium.com/@dhiraj.p.rai?source=follow_footer--------------------------follow_footer-">Dhiraj Rai</a></h2><div class="l g"><button class="cc ce gn ga go gp gq gr br cp bb b bc bd be bf cq cr y cs ct bu">Follow</button></div></div></div></span></span><div class="gf gs l gg az"><div class="gt l"><h4 class="bb ec gu gv bg"></h4></div><div class="aw gw az"><button class="cc ce gn ga go gp gq gr br cp bb b bc bd be bf cq cr y cs ct bu">Follow</button></div></div></div></div><div class="gx fp l u"><a href="https://medium.com/p/76a57680a85/responses/show?source=follow_footer--------------------------follow_footer-" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx"><div class="gy gz em l ha az"><span class="gn">See responses (1)</span></div></a></div></div><div class="hb l hc u"><div class="eh ac hd he hf hg hh hi hj ap hk x"><div class="mk l ml"><div class="ig mm fs l"><h2 class="bb gk mn mo cd">More From Medium</h2></div><div class="mp ar mq mr eg ms mt mu mv mw mx my mz na nb nc nd ne nf ng"><div class="nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of"><div class="x fl"><div class="l og"><div class="oh oi ms mt mu oj ok mv mw mx ol om my mz na on oo nb nc nd op oq ne nf ng ar mr eg"><div class="nh ni nj nk nl nm nn or np os nr ns ot nu ou nw nx ov nz ow ob oc ox oe oy"><div class="oz l pa f"><h4 class="bb ec ed bd bg">Related reads</h4></div><div class="pb l pc ml"><a href="https://towardsdatascience.com/how-to-get-started-with-pyspark-1adc142456ec?source=post_recirc---------0------------------" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx l"><div class="pd dr"><div class="fl fm x"><div class="pe l pf pg fl x ph pi"></div></div></div></a></div></div><div class="nh ni nj nk nl nm nn or np os nr ns ot nu ou nw nx ov nz ow ob oc ox oe oy"><div class="pb l"><div class="pj aw h pk"><h4 class="bb ec ed bd bg">Related reads</h4></div><a href="https://towardsdatascience.com/how-to-get-started-with-pyspark-1adc142456ec?source=post_recirc---------0------------------"><h3 class="cd ax iw pl bc pm pn po">How to Get Started with PySpark</h3></a></div><div class="ar as es"><div class="pp l pq"><div class="as ar"><div><a href="https://medium.com/@sanket107?source=post_recirc---------0------------------"><img alt="Sanket Gupta" src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/1_sdKbRuYHXmbE1nT0iNHkkw.png" class="l cw pr ps" width="40" height="40"></a></div><div class="jm x l"><div class="ar"><div style="flex: 1 1 0%;"><span class="bb b bc bd be bf l cd ax"><div class="cz ar as jo" data-test-id="postByline"><span class="bb ec ed bd jp jq jr js jt ju cd"><a class="bi bj bk bl bm bn bo bp bq br ik bu bv bw bx" href="https://medium.com/@sanket107?source=post_recirc---------0------------------">Sanket Gupta</a><span> in <a href="https://towardsdatascience.com/?source=post_recirc---------0------------------" class="bi bj bk bl bm bn bo bp bq br ik bu bv bw bx">Towards Data Science</a></span></span></div></span></div></div><span class="bb b bc bd be bf l bg bh"><span class="bb ec ed bd jp jq jr js jt ju bg"><div><a href="https://towardsdatascience.com/how-to-get-started-with-pyspark-1adc142456ec?source=post_recirc---------0------------------" class="bi bj bk bl bm bn bo bp bq br ik bu bv bw bx">Jun 11, 2018</a> · 4 min read</div></span></span></div></div></div><div class="ar as"><div class="ar as"><div class="dq l dr"><div class=""><button class="bp ds dt du dv dw dx dy dz"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="ea l"><div class="eb"><h4 class="bb ec ed bd bg">557 </h4></div></div></div><div class="pt jm pp pu pv l"></div><div class="dy"><div><div class="cs"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div><div class="nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of"><div class="x fl"><div class="l og"><div class="oh oi ms mt mu oj ok mv mw mx ol om my mz na on oo nb nc nd op oq ne nf ng ar mr eg"><div class="nh ni nj nk nl nm nn or np os nr ns ot nu ou nw nx ov nz ow ob oc ox oe oy"><div class="oz l pa f"><h4 class="bb ec ed bd bg">Also tagged Feature Engineering</h4></div><div class="pb l pc ml"><a href="https://towardsdatascience.com/machine-learning-pipelines-nonlinear-model-stacking-668f2b720344?source=post_recirc---------1------------------" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx l"><div class="pd dr"><div class="fl fm x"><div class="pw l pf pg fl x ph pi"></div></div></div></a></div></div><div class="nh ni nj nk nl nm nn or np os nr ns ot nu ou nw nx ov nz ow ob oc ox oe oy"><div class="pb l"><div class="pj aw h pk"><h4 class="bb ec ed bd bg">Also tagged Feature Engineering</h4></div><a href="https://towardsdatascience.com/machine-learning-pipelines-nonlinear-model-stacking-668f2b720344?source=post_recirc---------1------------------"><h3 class="cd ax iw pl bc pm pn po">Machine Learning Pipelines: Nonlinear Model Stacking</h3></a></div><div class="ar as es"><div class="pp l pq"><div class="as ar"><div><a href="https://medium.com/@LesterLeong?source=post_recirc---------1------------------"><img alt="Lester Leong" src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/2__1fKDnKbkCjVPvTxdF_5Gg.jpeg" class="l cw pr ps" width="40" height="40"></a></div><div class="jm x l"><div class="ar"><div style="flex: 1 1 0%;"><span class="bb b bc bd be bf l cd ax"><div class="cz ar as jo" data-test-id="postByline"><span class="bb ec ed bd jp jq jr js jt ju cd"><a class="bi bj bk bl bm bn bo bp bq br ik bu bv bw bx" href="https://medium.com/@LesterLeong?source=post_recirc---------1------------------">Lester Leong</a><span> in <a href="https://towardsdatascience.com/?source=post_recirc---------1------------------" class="bi bj bk bl bm bn bo bp bq br ik bu bv bw bx">Towards Data Science</a></span></span></div></span></div></div><span class="bb b bc bd be bf l bg bh"><span class="bb ec ed bd jp jq jr js jt ju bg"><div><a href="https://towardsdatascience.com/machine-learning-pipelines-nonlinear-model-stacking-668f2b720344?source=post_recirc---------1------------------" class="bi bj bk bl bm bn bo bp bq br ik bu bv bw bx">Jul 30</a> · 8 min read<span style="padding-left: 4px;"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top: -2px;"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div><div class="ar as"><div class="ar as"><div class="dq l dr"><div class=""><button class="bp ds dt du dv dw dx dy dz"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="ea l"><div class="eb"><h4 class="bb ec ed bd bg">35 </h4></div></div></div><div class="pt jm pp pu pv l"></div><div class="dy"><div><div class="cs"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div><div class="nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of"><div class="x fl"><div class="l og"><div class="oh oi ms mt mu oj ok mv mw mx ol om my mz na on oo nb nc nd op oq ne nf ng ar mr eg"><div class="nh ni nj nk nl nm nn or np os nr ns ot nu ou nw nx ov nz ow ob oc ox oe oy"><div class="oz l pa f"><h4 class="bb ec ed bd bg">Also tagged Feature Engineering</h4></div><div class="pb l pc ml"><a href="https://towardsdatascience.com/how-to-do-feature-engineering-with-categorical-data-in-r-d26adeb70fc8?source=post_recirc---------2------------------" class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx l"><div class="pd dr"><div class="fl fm x"><div class="px l pf pg fl x ph pi"></div></div></div></a></div></div><div class="nh ni nj nk nl nm nn or np os nr ns ot nu ou nw nx ov nz ow ob oc ox oe oy"><div class="pb l"><div class="pj aw h pk"><h4 class="bb ec ed bd bg">Also tagged Feature Engineering</h4></div><a href="https://towardsdatascience.com/how-to-do-feature-engineering-with-categorical-data-in-r-d26adeb70fc8?source=post_recirc---------2------------------"><h3 class="cd ax iw pl bc pm pn po">How to do feature engineering with categorical data in R</h3></a></div><div class="ar as es"><div class="pp l pq"><div class="as ar"><div><a href="https://medium.com/@rgwoodiii?source=post_recirc---------2------------------"><img alt="Robert Wood" src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/0_ZrXkl1rDDh_2SjOj.jpg" class="l cw pr ps" width="40" height="40"></a></div><div class="jm x l"><div class="ar"><div style="flex: 1 1 0%;"><span class="bb b bc bd be bf l cd ax"><div class="cz ar as jo" data-test-id="postByline"><span class="bb ec ed bd jp jq jr js jt ju cd"><a class="bi bj bk bl bm bn bo bp bq br ik bu bv bw bx" href="https://medium.com/@rgwoodiii?source=post_recirc---------2------------------">Robert Wood</a><span> in <a href="https://towardsdatascience.com/?source=post_recirc---------2------------------" class="bi bj bk bl bm bn bo bp bq br ik bu bv bw bx">Towards Data Science</a></span></span></div></span></div></div><span class="bb b bc bd be bf l bg bh"><span class="bb ec ed bd jp jq jr js jt ju bg"><div><a href="https://towardsdatascience.com/how-to-do-feature-engineering-with-categorical-data-in-r-d26adeb70fc8?source=post_recirc---------2------------------" class="bi bj bk bl bm bn bo bp bq br ik bu bv bw bx">Jul 28</a> · 6 min read<span style="padding-left: 4px;"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top: -2px;"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div><div class="ar as"><div class="ar as"><div class="dq l dr"><div class=""><button class="bp ds dt du dv dw dx dy dz"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="ea l"><div class="eb"><h4 class="bb ec ed bd bg">3 </h4></div></div></div><div class="pt jm pp pu pv l"></div><div class="dy"><div><div class="cs"><button class="bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="hl l hm hn"><section class="v w x y l z ab ac ae af ag ah ai aj ak al am an ao ap"><div class="ho hp fs ar es g"><div class="hq ar es"><div class="hr l hs"><div class="ht l"><a href="https://medium.com/about?autoplay=1&amp;source=post_page---------------------------" class="bi bj bk bl bm bn bo bp bq br hu hv bu bv hw hx"><h4 class="hy hz ia bb gk bc gv ib ic l">Discover <!-- -->Medium</h4></a></div><span class="bb b bc bd be bf l id ie">Welcome to a place where words matter. On <!-- -->Medium<!-- -->, smart voices and original ideas take center stage - with no ads in sight.<!-- --> <a href="https://medium.com/about?autoplay=1&amp;source=post_page---------------------------" class="bi bj bk bl bm bn bo bp bq br bu bv hw hx if">Watch</a></span></div><div class="hr l hs"><div class="ig l"><a href="https://medium.com/topics?source=post_page---------------------------" class="bi bj bk bl bm bn bo bp bq br hu hv bu bv hw hx"><h4 class="hy hz ia bb gk bc gv ib ic l">Make <!-- -->Medium<!-- --> yours</h4></a></div><span class="bb b bc bd be bf l id ie">Follow all the topics you care about, and we’ll deliver the best stories for you to your homepage and inbox.<!-- --> <a href="https://medium.com/topics?source=post_page---------------------------" class="bi bj bk bl bm bn bo bp bq br bu bv hw hx if">Explore</a></span></div><div class="hr l hs"><div class="ht l"><a href="https://medium.com/membership?source=post_page---------------------------" class="bi bj bk bl bm bn bo bp bq br hu hv bu bv hw hx"><h4 class="hy hz ia bb gk bc gv ib ic l">Become a member</h4></a></div><span class="bb b bc bd be bf l id ie">Get unlimited access to the best stories on <!-- -->Medium<!-- --> — and support writers while you’re at it. Just $5/month.<!-- --> <a href="https://medium.com/membership?source=post_page---------------------------" class="bi bj bk bl bm bn bo bp bq br bu bv hw hx if">Upgrade</a></span></div></div></div><div class="ar as es"><a href="https://medium.com/?source=post_page---------------------------" class="bi bj bk bl bm bn bo bp bq br hu hv bu bv hw hx"><svg height="22" width="112" viewBox="0 0 111.5 22" class="hz"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></a><span class="bb b bc bd be bf l id ie"><div class="ih ii ar es ij au"><a href="https://medium.com/about?autoplay=1&amp;source=post_page---------------------------" class="bi bj bk bl bm bn bo bp bq br ik bu bv hw hx">About</a><a href="https://help.medium.com/?source=post_page---------------------------" class="bi bj bk bl bm bn bo bp bq br ik bu bv hw hx">Help</a><a class="bi bj bk bl bm bn bo bp bq br ik bu bv hw hx" href="https://medium.com/policy/9db0094a1e0f?source=post_page---------------------------">Legal</a></div></span></div></section></div><script>window.PARSELY = window.PARSELY || {autotrack: false}</script></div></div><script>window.__BUILD_ID__ = "development"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"config":{"nodeEnv":"production","version":"master-20190802-202335-6a8537f364","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","iTunesAppId":"828256236","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"collector-medium.lightstep.com","token":"ce5be895bef60919541332990ac9fef2","appVersion":"master-20190802-202335-6a8537f364"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ","sentry":{"dsn":"https:\u002F\u002F589e367c28ca47b195ce200d1507d18b@sentry.io\u002F1423575","environment":"production"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"]},"debug":{"requestId":"10f8a104-9c02-4319-a54d-044510b499f3","originalSpanCarrier":{"ot-tracer-spanid":"3deb19402d600bd4","ot-tracer-traceid":"6493d40678de69e5","ot-tracer-sampled":"true"}},"session":{"user":{"id":"5cdcbf5e0372"},"xsrf":"mOhzEbvyzOmj"},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"showBranchBanner":null,"hideGoogleOneTap":false,"currentLocation":"https:\u002F\u002Fmedium.com\u002F@dhiraj.p.rai\u002Fessentials-of-feature-engineering-in-pyspark-part-i-76a57680a85","host":"medium.com","hostname":"medium.com","referrer":"https:\u002F\u002Fwww.google.com\u002F","currentHash":""},"client":{"isBot":false,"isDnt":false,"isEu":false,"isNativeMedium":false,"isCustomDomain":false},"multiVote":{"clapsPerPost":{}},"metadata":{"faviconImageId":null}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY.variantFlags.0":{"name":"allow_access","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.0.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.0.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.1":{"name":"allow_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.1.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.1.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.2":{"name":"allow_test_auth","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.2.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.2.valueType":{"__typename":"VariantFlagString","value":"disallow"},"ROOT_QUERY.variantFlags.3":{"name":"signin_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.3.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.3.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.4":{"name":"signup_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.4.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.4.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.5":{"name":"google_sign_in_android","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.5.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.5.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.6":{"name":"browsable_stream_config_bucket","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.6.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.6.valueType":{"__typename":"VariantFlagString","value":"curated-topics"},"ROOT_QUERY.variantFlags.7":{"name":"enable_dedicated_series_tab_api_ios","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.7.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.7.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.8":{"name":"enable_post_import","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.8.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.8.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.9":{"name":"available_monthly_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.9.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.9.valueType":{"__typename":"VariantFlagString","value":"60e220181034"},"ROOT_QUERY.variantFlags.10":{"name":"available_annual_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.10.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.10.valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"},"ROOT_QUERY.variantFlags.11":{"name":"disable_ios_resume_reading_toast","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.11.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.11.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.12":{"name":"is_not_medium_subscriber","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.12.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.12.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.13":{"name":"glyph_font_set","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.13.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.13.valueType":{"__typename":"VariantFlagString","value":"m2"},"ROOT_QUERY.variantFlags.14":{"name":"enable_branding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.14.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.14.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.15":{"name":"enable_branding_fonts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.15.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.15.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.16":{"name":"enable_automated_mission_control_triggers","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.16.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.16.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.17":{"name":"enable_lite_profile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.17.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.17.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.18":{"name":"enable_marketing_emails","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.18.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.18.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.19":{"name":"enable_topic_lifecycle_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.19.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.19.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.20":{"name":"enable_parsely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.20.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.20.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.21":{"name":"enable_branch_io","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.21.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.21.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.22":{"name":"enable_ios_post_stats","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.22.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.22.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.23":{"name":"enable_lite_topics","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.23.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.23.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.24":{"name":"enable_lite_stories","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.24.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.24.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.25":{"name":"redis_read_write_splitting","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.25.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.25.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.26":{"name":"enable_tipalti_onboarding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.26.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.26.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.27":{"name":"enable_annual_renewal_reminder_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.27.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.27.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.28":{"name":"enable_janky_spam_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.28.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.28.valueType":{"__typename":"VariantFlagString","value":"users,posts"},"ROOT_QUERY.variantFlags.29":{"name":"enable_new_collaborative_filtering_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.29.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.29.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.30":{"name":"enable_google_one_tap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.30.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.30.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.31":{"name":"enable_email_sign_in_captcha","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.31.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.31.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.32":{"name":"enable_primary_topic_for_mobile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.32.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.32.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.33":{"name":"enable_lite_post","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.33.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.33.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.34":{"name":"enable_logged_out_homepage_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.34.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.34.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.35":{"name":"use_new_admin_topic_backend","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.35.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.35.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.36":{"name":"enable_quarantine_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.36.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.36.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.37":{"name":"enable_patronus_on_kubernetes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.37.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.37.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.38":{"name":"pub_sidebar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.38.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.38.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.39":{"name":"disable_mobile_featured_chunk","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.39.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.39.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.40":{"name":"enable_embedding_based_diversification","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.40.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.40.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.41":{"name":"enable_lite_pub_header_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.41.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.41.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.42":{"name":"enable_lite_claps","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.42.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.42.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.43":{"name":"enable_live_user_post_scoring","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.43.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.43.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.44":{"name":"enable_lite_post_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.44.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.44.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.45":{"name":"enable_lite_post_highlights_view_only","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.45.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.45.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.46":{"name":"enable_tick_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.46.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.46.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.47":{"name":"enable_lite_post_cd","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.47.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.47.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.48":{"name":"enable_trumpland_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.48.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.48.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.49":{"name":"enable_lite_email_sign_in_flow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.49.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.49.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.50":{"name":"enable_daily_read_digest_promo","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.50.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.50.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.51":{"name":"enable_lite_paywall_alert","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.51.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.51.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.52":{"name":"enable_edit_alt_text","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.52.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.52.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.53":{"name":"enable_serve_recs_from_ml_rank_homepage","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.53.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.53.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.54":{"name":"enable_serve_recs_from_ml_rank_digest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.54.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.54.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.55":{"name":"enable_serve_recs_from_ml_rank_app_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.55.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.55.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.56":{"name":"enable_cold_start_post_experiment_tags","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.56.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.56.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.57":{"name":"enable_lite_thanks_to","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.57.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.57.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.58":{"name":"enable_lite_google_captcha","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.58.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.58.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.59":{"name":"enable_lite_branch_io","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.59.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.59.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.60":{"name":"enable_lite_notifications","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.60.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.60.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.61":{"name":"enable_lite_audio_upsells","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.61.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.61.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.62":{"name":"enable_ticks_digest_promo","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.62.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.62.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.63":{"name":"enable_lite_verify_email_butter_bar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.63.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.63.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.64":{"name":"remove_social_proof_on_digest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.64.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.64.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.65":{"name":"enable_lite_unread_notification_count_mutation","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.65.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.65.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.66":{"name":"enable_quick_reads","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.66.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.66.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.67":{"name":"rank_model","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.67.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.67.valueType":{"__typename":"VariantFlagString","value":"default"},"ROOT_QUERY.variantFlags.68":{"name":"enable_icymi_section_in_digest_with_three_stories","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.68.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.68.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.69":{"name":"disable_gosocial_followers_that_you_follow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.69.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.69.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY":{"variantFlags":[{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.0","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.1","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.2","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.3","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.4","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.5","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.6","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.7","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.8","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.9","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.10","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.11","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.12","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.13","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.14","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.15","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.16","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.17","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.18","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.19","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.20","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.21","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.22","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.23","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.24","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.25","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.26","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.27","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.28","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.29","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.30","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.31","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.32","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.33","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.34","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.35","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.36","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.37","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.38","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.39","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.40","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.41","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.42","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.43","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.44","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.45","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.46","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.47","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.48","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.49","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.50","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.51","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.52","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.53","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.54","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.55","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.56","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.57","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.58","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.59","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.60","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.61","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.62","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.63","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.64","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.65","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.66","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.67","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.68","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.69","typename":"VariantFlag"}],"viewer":{"type":"id","generated":false,"id":"User:5cdcbf5e0372","typename":"User"},"meterPost({\"postId\":\"76a57680a85\",\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"type":"id","generated":false,"id":"MeteringInfo:singleton","typename":"MeteringInfo"},"postResult({\"id\":\"76a57680a85\"})":{"type":"id","generated":false,"id":"Post:76a57680a85","typename":"Post"},"notificationsConnection({})":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({})","typename":"NotificationsConnection"},"notificationStatus":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationStatus","typename":"NotificationStatus"}},"User:5cdcbf5e0372":{"id":"5cdcbf5e0372","username":"rilfiup","name":"mohamed refai mohamed rilfi","imageId":"0*4f53HvVWY5tgWBXr.jpg","mediumMemberAt":0,"hasPastMemberships":false,"isPartnerProgramEnrolled":false,"email":"rilfiup@gmail.com","unverifiedEmail":"","twitterScreenName":"","__typename":"User"},"MeteringInfo:singleton":{"__typename":"MeteringInfo","postIds":{"type":"json","json":[]},"maxUnlockCount":3,"unlocksRemaining":3},"Post:76a57680a85":{"__typename":"Post","visibility":"PUBLIC","latestPublishedVersion":"8428737467c2","collection":null,"id":"76a57680a85","creator":{"type":"id","generated":false,"id":"User:d5f08e31e366","typename":"User"},"isLocked":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","sequence":null,"mediumUrl":"https:\u002F\u002Fmedium.com\u002F@dhiraj.p.rai\u002Fessentials-of-feature-engineering-in-pyspark-part-i-76a57680a85","canonicalUrl":"","content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})","typename":"PostContent"},"firstPublishedAt":1540809180870,"isPublished":true,"layerCake":0,"primaryTopic":null,"title":"Feature Engineering in pyspark — Part I","highlights":[],"readingTime":7.568238993710692,"statusForCollection":null,"allowResponses":true,"tags":[{"type":"id","generated":false,"id":"Tag:python","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:feature-engineering","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:data-preprocessing","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:spark","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:pyspark","typename":"Tag"}],"viewerClapCount":null,"readingList":"READING_LIST_NONE","clapCount":58,"voterCount":12,"recommenders":[],"pendingCollection":null,"responsesCount":1,"collaborators":[],"inResponseToPostResult":null,"inResponseToMediaResource":null,"curationEligibleAt":0,"audioVersionUrl":null,"socialTitle":"","socialDek":"","metaDescription":"Feature Engineering in pyspark — Part I","latestPublishedAt":1540877616369,"previewContent":{"type":"id","generated":true,"id":"$Post:76a57680a85.previewContent","typename":"PreviewContent"},"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:","typename":"ImageMetadata"},"updatedAt":1540877616369,"topics":[],"isSuspended":false},"User:d5f08e31e366":{"id":"d5f08e31e366","__typename":"User","isSuspended":false,"allowNotes":true,"name":"Dhiraj Rai","isFollowing":false,"username":"dhiraj.p.rai","bio":"","imageId":"1*qAdpdVzWtmqiylPC3UKruQ.jpeg","mediumMemberAt":1555087123528,"isBlocking":false,"isPartnerProgramEnrolled":false,"twitterScreenName":""},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"isLockedPreviewOnly":false,"__typename":"PostContent","bodyModel":{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel","typename":"RichText"}},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.0":{"name":"42b9","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel":{"sections":[{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.0","typename":"Section"}],"paragraphs":[{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.0","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.1","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.2","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.3","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.4","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.5","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.6","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.7","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.8","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.9","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.10","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.11","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.12","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.13","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.14","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.15","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.16","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.17","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.18","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.19","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.20","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.21","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.22","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.23","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.24","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.25","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.26","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.27","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.28","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.29","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.30","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.31","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.32","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.33","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.34","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.35","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.36","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.37","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.38","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.39","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.40","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.41","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.42","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.43","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.44","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.45","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.46","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.47","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.48","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.49","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.50","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.51","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.52","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.53","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.54","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.55","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.56","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.57","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.58","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.59","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.60","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.61","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.62","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.63","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.64","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.65","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.66","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.67","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.68","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.69","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.70","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.71","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.72","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.73","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.74","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.75","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.76","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.77","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.78","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.79","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.80","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.81","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.82","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.83","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.84","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.85","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.86","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.87","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.88","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.89","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.90","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.91","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.92","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.93","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.94","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.95","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.96","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.97","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.98","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.99","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.100","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.101","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.102","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.103","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.104","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.105","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.106","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.107","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.108","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.109","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.110","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.111","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.112","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.113","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.114","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.115","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.116","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.117","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.118","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.119","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.120","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.121","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.122","typename":"Paragraph"}],"__typename":"RichText"},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.0":{"name":"da6f","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Feature Engineering in pyspark — Part I","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.1":{"name":"f7c7","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*W8RefeukLmfhlZ1olpkzpQ.jpeg","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*W8RefeukLmfhlZ1olpkzpQ.jpeg":{"id":"1*W8RefeukLmfhlZ1olpkzpQ.jpeg","originalHeight":168,"originalWidth":300,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.2":{"name":"0c09","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The most commonly used data pre-processing techniques in approaches in Spark are as follows","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.3":{"name":"7633","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"1) VectorAssembler","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.4":{"name":"323a","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"2)Bucketing","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.5":{"name":"fe59","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"3)Scaling and normalization","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.6":{"name":"5e11","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"4) Working with categorical features","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.7":{"name":"6567","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"5) Text data transformers","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.8":{"name":"2c54","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"6) Feature Manipulation","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.9":{"name":"9fce","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"7) PCA","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.10":{"name":"e63a","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Please find the complete jupyter notebook here","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.10.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.10.markups.0":{"type":"A","start":42,"end":46,"href":"https:\u002F\u002Fgithub.com\u002Fdhirajprai\u002FSparkML\u002Fblob\u002Fmaster\u002FSparkML\u002FFeature_Engineering_Part_I.ipynb","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.11":{"name":"fbfb","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"This blog is mostly intended for who are new to Spark programming, specially pyspark. Therefore, this blog follows an illustrative approach to explain the commonly known data-preprocessing approaches.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.12":{"name":"cefd","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"But before we do anything, we need to initialize a Spark session. This can be done as follows","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.13":{"name":"9b3d","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Initializing a Spark session\nfrom pyspark.sql import SparkSession\nspark = SparkSession.builder.master(\"local\").appName(\"Word Count\").config(\"spark.some.config.option\",\"some-value\").getOrCreate()","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.14":{"name":"0e88","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Now let us download some sample datasets to play along with. The datasets I have used in the illustrations can be downloaded from here","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.14.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.14.markups.0":{"type":"A","start":130,"end":134,"href":"https:\u002F\u002Fgithub.com\u002Fdatabricks\u002FSpark-The-Definitive-Guide","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.15":{"name":"b69c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"For the purpose of demonstration we will be using three different datasets","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.16":{"name":"e559","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"1) retail-data\u002Fby-day","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.17":{"name":"d479","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"2) simple-ml-integers","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.18":{"name":"1ecf","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"3) simple-ml","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.19":{"name":"cb02","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"4) simple-ml-scaling","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.20":{"name":"9b32","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Lets us begin by reading the “retail-data\u002Fby-day” which is in .csv format and save it into a Spark dataframe named ‘sales’","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.21":{"name":"1826","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sales = spark.read.format(\"csv\").option(\"header\",\"true\").option(\"inferSchema\", \"true\").load(r\"data\u002Fretail-data\u002Fby-day\u002F*.csv\").coalesce(5).where(\"Description IS NOT NULL\")","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.22":{"name":"239b","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Lets us read the parquet files in “simple-ml-integers” and make a Spark dataframe named ‘fakeIntDF’","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.23":{"name":"f1d8","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"fakeIntDF=spark.read.parquet(\"\u002Fhome\u002Fspark\u002FDhirajR\u002FSpark\u002Ffeature_engineering\u002Fdata\u002Fsimple-ml-integers\")","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.24":{"name":"c8d8","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Lets us read the parquet files in “simple-ml” and make a Spark dataframe named ‘simpleDF’","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.25":{"name":"6bf2","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"simpleDF=spark.read.json(r\"\u002Fhome\u002Fspark\u002FDhirajR\u002FSpark\u002Ffeature_engineering\u002Fdata\u002Fsimple-ml\")","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.26":{"name":"6794","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Lets us read the parquet files in “simple-ml-scaling” and make a Spark dataframe named ‘scaleDF’","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.27":{"name":"a283","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"scaleDF=spark.read.parquet(r\"\u002Fhome\u002Fspark\u002FDhirajR\u002FSpark\u002Ffeature_engineering\u002Fdata\u002Fsimple-ml-scaling\")","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.28":{"name":"4989","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Please find the complete jupyter notebook here","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.28.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.28.markups.0":{"type":"A","start":42,"end":46,"href":"https:\u002F\u002Fgithub.com\u002Fdhirajprai\u002FSparkML\u002Fblob\u002Fmaster\u002FSparkML\u002FFeature_Engineering_Part_I.ipynb","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.29":{"name":"bf7a","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Vector assembler","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.30":{"name":"63d6","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The vector assembler is basically use to concatenate all the features into a single vector which can be further passed to the estimator or ML algorithm. In order to demo the ‘Vector Assembler’ we will use the ‘fakeIntDF’ which we had created in the previous steps.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.31":{"name":"3849","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Let us see what columns we have in ‘fakeIntDF’ dataframe","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.32":{"name":"14c7","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"fakeIntDF.cache()\nfakeIntDF.show()","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.33":{"name":"1620","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+----+----+----+\n|int1|int2|int3|\n+----+----+----+\n|   7|   8|   9|\n|   1|   2|   3|\n|   4|   5|   6|\n+----+----+----+","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.34":{"name":"1353","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"So we have three columns, int1, int2, int3 with integer values within them.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.35":{"name":"5b32","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"First, import the VectorAssembler from pyspark.ml.features. Once the Vector assembler is imported we are required to create the object of the same. Here I will create an object named “assembler”. The above result shows that we have three features in ‘fakeIntDF’ i.e. int1, int2, int3. Let us create the object assembler so as to combine the three features into a single column named features. At last, let us use the transform method to transform our dataset.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.36":{"name":"ba83","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from pyspark.ml.feature import VectorAssembler\nassembler = VectorAssembler(inputCols=[\"int1\", \"int2\", \"int3\"],outputCol=\"features\")\nassembler.transform(fakeIntDF).show()","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.37":{"name":"a40e","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The output is as follows","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.38":{"name":"be5e","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+----+----+----+-------------+\n|int1|int2|int3|     features|\n+----+----+----+-------------+\n|   7|   8|   9|[7.0,8.0,9.0]|\n|   1|   2|   3|[1.0,2.0,3.0]|\n|   4|   5|   6|[4.0,5.0,6.0]|\n+----+----+----+-------------+","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.39":{"name":"1bd4","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The above results shows that a new column named “features” has been created which combined the “int1”, “int2”, “int3” into a single vector.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.40":{"name":"c139","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Please find the complete jupyter notebook here","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.40.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.40.markups.0":{"type":"A","start":42,"end":46,"href":"https:\u002F\u002Fgithub.com\u002Fdhirajprai\u002FSparkML\u002Fblob\u002Fmaster\u002FSparkML\u002FFeature_Engineering_Part_I.ipynb","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.41":{"name":"575b","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Bucketing","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.42":{"name":"64e4","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Bucketing is a most straight forward approach for fro converting the continuous variables into categorical variable. In pyspark the task of bucketing can be easily accomplished using the Bucketizer class.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.43":{"name":"50f3","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Firstly, we need to create bucket borders. Let us define a list bucketBorders =[-1.0, 5.0,10.0,250.0,600.0]","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.44":{"name":"8061","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Next, let us create a object of the Bucketizer class. Then we will apply the transform method to our target Dataframe “dataframe”","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.45":{"name":"7525","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Let us create a simple dataframe for demo purpose","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.46":{"name":"8702","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"data = [(-999.9,), (-0.5,), (-0.3,), (0.0,), (0.2,), (999.9,)]\ndataFrame = spark.createDataFrame(data, [\"features\"])","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.47":{"name":"f571","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Then we can import the Bucketizer class, create an object of this class, and apply the transform method to the dataframe we just created.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.48":{"name":"d8f4","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from pyspark.ml.feature import Bucketizer\nbucketBorders=[-float(\"inf\"), -0.5, 0.0, 0.5, float(\"inf\")]","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.49":{"name":"f628","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"bucketer=Bucketizer().setSplits(bucketBorders).setInputCol(\"features\").setOutputCol(\"Buckets\")\nbucketer.transform(dataFrame).show()","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.50":{"name":"15f4","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The output looks as follows:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.51":{"name":"0ea9","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+--------+-------+\n|features|Buckets|\n+--------+-------+\n|  -999.9|    0.0|\n|    -0.5|    1.0|\n|    -0.3|    1.0|\n|     0.0|    2.0|\n|     0.2|    2.0|\n|   999.9|    3.0|\n+--------+-------+","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.52":{"name":"0a94","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Scaling and normalization","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.53":{"name":"a685","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Scaling and normalization is another common task that we come across while handling continuous variables. It is not always imperative but, highly recommended to scale and normalize the features before applying an ML algorithm in order to avert the risk of an algorithm being insensitive to a certain features.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.54":{"name":"1b4c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Spark ML provides us with a class “StandardScaler” for easy scaling and normalization of features","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.55":{"name":"cbbb","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Let us use the scaleDF dataframe that we had created previously to demonstrate the StandardScaler in pyspark.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.56":{"name":"d90e","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"scaleDF.show()","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.57":{"name":"ffc1","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+---+--------------+\n| id|      features|\n+---+--------------+\n|  0|[1.0,0.1,-1.0]|\n|  1| [2.0,1.1,1.0]|\n|  0|[1.0,0.1,-1.0]|\n|  1| [2.0,1.1,1.0]|\n|  1|[3.0,10.1,3.0]|\n+---+--------------+","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.58":{"name":"1e8d","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from pyspark.ml.feature import StandardScaler\nScalerizer=StandardScaler().setInputCol(\"features\").setOutputCol(\"Scaled_features\")\nScalerizer.fit(scaleDF).transform(scaleDF).show()","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.59":{"name":"dbb3","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The output looks as follows:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.60":{"name":"5690","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+---+--------------+------------------------------------------------\n|id |features      |Scaled_features|\n+---+--------------+------------------------------------------------\n|0  |[1.0,0.1,-1.0]|[1.195228,0.02337,-0.597614]|\n|1  |[2.0,1.1,1.0] |[2.390457,0.25713,0.597614]   |\n|0  |[1.0,0.1,-1.0]|[1.19522,0.023376,-0.5976143046671968]|\n|1  |[2.0,1.1,1.0] |[2.390457,0.257138,0.597614]   |\n|1  |[3.0,10.1,3.0]|[3.585682.3609991,1.792842]  |\n+---+--------------+------------------------------------------------","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.61":{"name":"e80d","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"MinMaxScaler","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.62":{"name":"e718","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The StandardScaler standardizes the features with a zero mean and standard deviation of 1. Sometimes, we come across situations where we need to scale values within a given range (i.e. max and min). For such task Spark ML provdies a class named MinMaxScaler.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.63":{"name":"6d62","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The StandardScaler and MinMaxScaler share the common soul, the only difference is that we can provide the minimum value and maximum values within which we wish to scale the features.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.64":{"name":"9fee","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"For the sake of illustration, let us scale the features in the range 5 to 10.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.65":{"name":"9d02","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from pyspark.ml.feature import MinMaxScaler\n# Let us create an object of MinMaxScaler class\nMinMaxScalerizer=MinMaxScaler().setMin(5).setMax(10).setInputCol(\"features\").setOutputCol(\"MinMax_Scaled_features\")\nMinMaxScalerizer.fit(scaleDF).transform(scaleDF).show()","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.66":{"name":"3296","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The output looks like this:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.67":{"name":"87a9","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+---+--------------+----------------------+\n| id|      features|MinMax_Scaled_features|\n+---+--------------+----------------------+\n|  0|[1.0,0.1,-1.0]|         [5.0,5.0,5.0]|\n|  1| [2.0,1.1,1.0]|         [7.5,5.5,7.5]|\n|  0|[1.0,0.1,-1.0]|         [5.0,5.0,5.0]|\n|  1| [2.0,1.1,1.0]|         [7.5,5.5,7.5]|\n|  1|[3.0,10.1,3.0]|      [10.0,10.0,10.0]|\n+---+--------------+----------------------+","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.68":{"name":"20e7","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"MinAbsScaler","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.69":{"name":"89cc","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Sometimes we need to scalerize features between -1 to 1. The MinAbsScaler does exactly this by dividing the features by the maximum absolute values.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.70":{"name":"ef20","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from pyspark.ml.feature import MaxAbsScaler\n# Let us create an object of MinAbsScaler class\nMinAbsScalerizer=MaxAbsScaler().setInputCol(“features”).setOutputCol(“MinAbs_Scaled_features”)\nMinAbsScalerizer.fit(scaleDF).transform(scaleDF).show(truncate =False)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.71":{"name":"09b9","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The output looks like this:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.72":{"name":"7294","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+---+--------------+------------------------------------------------\n|id |features      |MinAbs_Scaled_features|\n+---+--------------+------------------------------------------------\n|0  |[1.0,0.1,-1.0]|[0.33333,0.009900,-0.33333]|\n|1  |[2.0,1.1,1.0] |[0.66666,0.108910,0.333333]|\n|0  |[1.0,0.1,-1.0]|[0.333333,0.00990,-0.33333]|\n|1  |[2.0,1.1,1.0] |[0.666666,0.108910,0.33333]|\n|1  |[3.0,10.1,3.0]|[1.0,1.0,1.0]              |                                        \n+---+--------------+------------------------------------------------","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.73":{"name":"87a8","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"So it is observed that all the features got scaled between -1 to 1.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.74":{"name":"bb51","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"ElementwiseProduct","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.75":{"name":"757c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"What differentiates ElementwiseProduct from the previously mentioned scalizers is the fact that, in ElementwiseProduct the features are scaled based on a multiplying factor.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.76":{"name":"7a7a","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The below mentioned code snippet will transform the feature#1 → 10 times, feature#2 → 0.1 times and feature#3 → -1 times","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.77":{"name":"8ab6","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"For example → the features [10, 20, 30] if scaled by [10, 0.1, -1] will become [100, 2.0, -30]","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.78":{"name":"8d66","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from pyspark.ml.feature import ElementwiseProduct\nfrom pyspark.ml.linalg import Vectors","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.79":{"name":"69df","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Let us define a scaling vector","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.80":{"name":"19a4","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ScalebyVector=Vectors.dense([10,0.1,-1])","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.81":{"name":"29be","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Let us create an object of the class Elementwise product\nScalingUp=ElementwiseProduct().setScalingVec(ScalebyVector).setInputCol(\"features\").setOutputCol(\"ElementWiseProduct\")\n# Let us transform\nScalingUp.transform(scaleDF).show()","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.82":{"name":"cc24","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The output looks like this:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.83":{"name":"ce9c","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+---+--------------+-------------------------------+\n|id |features      |ElementWiseProduct             |\n+---+--------------+-------------------------------+\n|0  |[1.0,0.1,-1.0]|[10.0,0.010,1.0]               |\n|1  |[2.0,1.1,1.0] |[20.0,0.110,-1.0]              |\n|0  |[1.0,0.1,-1.0]|[10.0,0.010,1.0]               |\n|1  |[2.0,1.1,1.0] |[20.0,0.110,-1.0]              |\n|1  |[3.0,10.1,3.0]|[30.0,1.01,-3.0]               |\n+---+--------------+-------------------------------+","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.84":{"name":"e352","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"So it is observed that all the features got scaled between -1 to 1.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.85":{"name":"a143","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Normalizer","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.86":{"name":"46ed","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The normalizer allows the user to calculate distance between features. The most commonly used distance metrics are “Manhattan distance” and the “Euclidean distance”. The Normalizer takes a parameter “p” from the user which represents the power norm.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.87":{"name":"dda7","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"For example, p = 1 indicates L1 norm; p = 2 indicates L2 norm.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.88":{"name":"5ac6","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*Hm93mbSIY1P8SMGq75eg9w.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Hm93mbSIY1P8SMGq75eg9w.png":{"id":"1*Hm93mbSIY1P8SMGq75eg9w.png","originalHeight":196,"originalWidth":1013,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.89":{"name":"21dc","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In fact, p can also be infinity.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.90":{"name":"b9ae","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from pyspark.ml.feature import Normalizer\nl1_norm=Normalizer().setP(1).setInputCol(\"features\").setOutputCol(\"l1_norm\")\nl2_norm=Normalizer().setP(2).setInputCol(\"features\").setOutputCol(\"l2_norm\")\nlinf_norm=Normalizer().setP(float(\"inf\")).setInputCol(\"features\").setOutputCol(\"linf_norm\")\n# Let us transform\nl1_norm.transform(scaleDF).show(truncate=False)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.91":{"name":"35c6","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The output looks as follows:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.92":{"name":"188d","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+---+--------------+-----------------------------------------------+\n|id |features      |l1_norm                    |\n+---+--------------+-----------------------------------------------+\n|0  |[1.0,0.1,-1.0]|[0.47619,0.047619,-0.47619]|\n|1  |[2.0,1.1,1.0] |[0.48780,0.26829,0.24390]  |\n|0  |[1.0,0.1,-1.0]|[0.47619,0.047619,-0.47619]|\n|1  |[2.0,1.1,1.0] |[0.48780,0.26829,0.24390]  |\n|1  |[3.0,10.1,3.0]|[0.18633,0.62732,0.18633]  |\n+---+--------------+-----------------------------------------------+","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.93":{"name":"d762","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Please find the complete jupyter notebook here","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.93.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.93.markups.0":{"type":"A","start":42,"end":46,"href":"https:\u002F\u002Fgithub.com\u002Fdhirajprai\u002FSparkML\u002Fblob\u002Fmaster\u002FSparkML\u002FFeature_Engineering_Part_I.ipynb","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.94":{"name":"606c","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"StringIndexer (Converting strings to numerical values)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.95":{"name":"b13d","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Most of the ML algorithms require converting categorical features into numerical ones.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.96":{"name":"7ecd","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Sparks StringIndexer maps strings into different numerical values. We will use the simpleDF dataframe for demo purpose which consist of a feature “lab” which is a categorical variable.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.97":{"name":"3eb5","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"simpleDF.show(5)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.98":{"name":"4edf","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+-----+----+------+------------------+\n|color| lab|value1|            value2|\n+-----+----+------+------------------+\n|green|good|     1|14.386294994851129|\n| blue| bad|     8|14.386294994851129|\n| blue| bad|    12|14.386294994851129|\n|green|good|    15| 38.97187133755819|\n|green|good|    12|14.386294994851129|\n+-----+----+------+------------------+\nonly showing top 5 rows","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.99":{"name":"060e","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Let us apply string indexer to a categorical variable named “lab” in “simpleDF” DataFrame.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.100":{"name":"a789","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from pyspark.ml.feature import StringIndexer\n# Let us create an object of the class StringIndexer\nlblindexer=StringIndexer().setInputCol(\"lab\").setOutputCol(\"LabelIndexed\")\n# Let us transform\nidxRes=lblindexer.fit(simpleDF).transform(simpleDF)\nidxRes=idxRes.drop(\"value1\",\"value2\")\nidxRes.show(5)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.101":{"name":"3938","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The output looks as follows. It can be seen that a new column is added to the dataframe, which contains encoded values for “good” and “bad” , like, 1.0 for good and 0.0 for bad.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.102":{"name":"23d9","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+-----+----+------------+\n|color| lab|LabelIndexed|\n+-----+----+------------+\n|green|good|         1.0|\n| blue| bad|         0.0|\n| blue| bad|         0.0|\n|green|good|         1.0|\n|green|good|         1.0|\n+-----+----+------------+\nonly showing top 5 rows","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.103":{"name":"420f","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"IndexToString","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.104":{"name":"9d9c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Sometimes we come across situations where it is necessary to convert the indexed values back to text. To do this the Spark ML provides a class “IndextoString”. To demonstrate the “IndextoString” let us use the “LabelIndexed” column of “idxRes” dataframe which was created in the previous code snippet.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.105":{"name":"5adf","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The LabelIndexed column consists of 1.0 → good and 0.0 → bad. Now let us try and reverse this","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.106":{"name":"680c","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from pyspark.ml.feature import IndexToString","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.107":{"name":"e997","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"LabelReverse=IndexToString().setInputCol(\"LabelIndexed\")\\\n.setOutputCol(\"ReverseIndex\")","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.108":{"name":"67a1","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"LabelReverse.transform(idxRes).show(5)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.109":{"name":"f7dd","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The output looks as follows. It can be seen that a new column named “ReverseIndex” is now added to the dataframe “idxRes” which, obviously reverses the values in “LabelIndexed” column to text. E.g. 1.0 →good and 0.0 → bad","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.110":{"name":"2565","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+-----+----+------------+------------+\n|color| lab|LabelIndexed|ReverseIndex|\n+-----+----+------------+------------+\n|green|good|         1.0|        good|\n| blue| bad|         0.0|         bad|\n| blue| bad|         0.0|         bad|\n|green|good|         1.0|        good|\n|green|good|         1.0|        good|\n+-----+----+------------+------------+\nonly showing top 5 rows","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.111":{"name":"7f8e","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Indexing within Vectors","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.112":{"name":"5f04","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Spark offers yet another class named “VectorIndexer”. The “VectorIndexer” identifies the categorical variables with a set of features which is already been vectorized and converts it into a categorical feature with zero based category indices.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.113":{"name":"2f0f","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"For the purpose of illustration let us first create a new DataFrame named “dataln”with features in the form of Vectors.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.114":{"name":"129c","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from pyspark.ml.linalg import Vectors\ndataln=spark.createDataFrame([(Vectors.dense(1,2,3),1),(Vectors.dense(2,5,6),2),(Vectors.dense(1,8,9),3)]).toDF(\"features\",\"labels\")\ndataln.show()","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.115":{"name":"2dbb","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The dataframe contains three rows and two columns. 1) Three features in the form of Vectors, here the first feature is a categorical variable 2) labels.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.116":{"name":"3552","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+-------------+------+\n|     features|labels|\n+-------------+------+\n|[1.0,2.0,3.0]|     1|\n|[2.0,5.0,6.0]|     2|\n|[1.0,8.0,9.0]|     3|\n+-------------+------+","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.117":{"name":"22a4","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Now let us use the “VectorIndexer” to automatically identify the categorical feature and index it.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.118":{"name":"0aa1","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"There are a few more feature engineering techniques, please refer my python notebook for the same at this github link.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.118.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.118.markups.0":{"type":"A","start":113,"end":117,"href":"https:\u002F\u002Fgithub.com\u002Fdhirajprai\u002FSparkML","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.119":{"name":"b46d","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.120":{"name":"569b","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In this humble blog I have tried to cover some basic but widely used data preprocessing transformations offered by Spark ML. I have demonstrated each of them with an illustration. However, there is a plethora of Spark tools to aid the feature engineering task some of these I will try to cover them in my next blog. Also, I will try to implement an end-to-end classification model in pyspark in my next blog.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.121":{"name":"34b0","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Bibliography","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:76a57680a85.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.paragraphs.122":{"name":"98c9","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Chambers, B., & Zaharia, M., 2018. Spark: The definitive guide. “ O’Reilly Media, Inc.”.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Tag:python":{"id":"python","displayTitle":"Python","__typename":"Tag"},"Tag:feature-engineering":{"id":"feature-engineering","displayTitle":"Feature Engineering","__typename":"Tag"},"Tag:data-preprocessing":{"id":"data-preprocessing","displayTitle":"Data Preprocessing","__typename":"Tag"},"Tag:spark":{"id":"spark","displayTitle":"Spark","__typename":"Tag"},"Tag:pyspark":{"id":"pyspark","displayTitle":"Pyspark","__typename":"Tag"},"$Post:76a57680a85.previewContent":{"subtitle":"Feature Engineering in pyspark — Part I","__typename":"PreviewContent"},"ImageMetadata:":{"id":"","focusPercentX":null,"focusPercentY":null,"originalHeight":0,"originalWidth":0,"__typename":"ImageMetadata"},"$ROOT_QUERY.notificationsConnection({})":{"notifications":[],"pagingInfo":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({}).pagingInfo","typename":"Paging"},"__typename":"NotificationsConnection"},"$ROOT_QUERY.notificationsConnection({}).pagingInfo":{"next":null,"__typename":"Paging"},"$ROOT_QUERY.notificationStatus":{"unreadNotificationCount":0,"__typename":"NotificationStatus"}}</script><script src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/manifest.8ebc85af.js.download"></script><script src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/vendors_main.4648f493.chunk.js.download"></script><script src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/main.bf4718e7.chunk.js.download"></script><script src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/vendors_screen.landingpages.trumpland_screen.post_screen.post.amp_screen.post.series_screen.profile__b319665e.f2be28a6.chunk.js.download"></script>
<script src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/screen.post_screen.post.amp_screen.post.series_screen.profile_screen.sequence.library_screen.sequenc_036c6b37.c3e22cf9.chunk.js.download"></script>
<script src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/screen.landingpages.trumpland_screen.post_screen.post.amp_screen.post.series_screen.profile_screen.s_5e114ebe.059ddc28.chunk.js.download"></script>
<script src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/screen.post_screen.post.amp_screen.sequence.post.32a4848e.chunk.js.download"></script>
<script src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/screen.post.e6dc1782.chunk.js.download"></script><script>window.main();</script><script src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/p.js.download" async="" id="parsely-cf"></script><iframe frameborder="0" scrolling="no" style="background-color: transparent; border: 0px; display: none;" src="./Feature Engineering in pyspark — Part I - Dhiraj Rai - Medium_files/saved_resource.html"></iframe><div id="GOOGLE_INPUT_CHEXT_FLAG" input="" input_stat="{&quot;tlang&quot;:true,&quot;tsbc&quot;:true,&quot;pun&quot;:true,&quot;mk&quot;:true,&quot;ss&quot;:true}" style="display: none;"></div></body><span class="gr__tooltip"><span class="gr__tooltip-content"></span><i class="gr__tooltip-logo"></i><span class="gr__triangle"></span></span></html>