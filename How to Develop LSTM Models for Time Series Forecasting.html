<!DOCTYPE html>
<!-- saved from url=(0090)https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/ -->
<html lang="en-US" style="min-height: 100%;" class="js csstransforms3d csstransitions gr__machinelearningmastery_com"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">



<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php">

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

<!-- This site is optimized with the Yoast SEO plugin v11.7 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to Develop LSTM Models for Time Series Forecasting</title>
<link rel="canonical" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="How to Develop LSTM Models for Time Series Forecasting">
<meta property="og:description" content="Long Short-Term Memory networks, or LSTMs for short, can be applied to time series forecasting. There are many types of LSTM models that can be used for each specific type of time series forecasting problem. In this tutorial, you will discover how to develop a suite of LSTM models for a range of standard time …">
<meta property="og:url" content="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/">
<meta property="og:site_name" content="Machine Learning Mastery">
<meta property="article:publisher" content="https://www.facebook.com/MachineLearningMastery/">
<meta property="article:author" content="https://www.facebook.com/jason.brownlee.39">
<meta property="article:section" content="Deep Learning for Time Series">
<meta property="article:published_time" content="2018-11-13T18:00:06+00:00">
<meta property="article:modified_time" content="2019-07-28T20:18:46+00:00">
<meta property="og:updated_time" content="2019-07-28T20:18:46+00:00">
<meta property="og:image" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/11/How-to-Develop-LSTM-Models-for-Time-Series-Forecasting.jpg">
<meta property="og:image:secure_url" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/11/How-to-Develop-LSTM-Models-for-Time-Series-Forecasting.jpg">
<meta property="og:image:width" content="640">
<meta property="og:image:height" content="360">
<script type="text/javascript" async="" src="./How to Develop LSTM Models for Time Series Forecasting_files/client.js.download"></script><script type="text/javascript" async="" src="./How to Develop LSTM Models for Time Series Forecasting_files/js"></script><script id="twitter-wjs" src="./How to Develop LSTM Models for Time Series Forecasting_files/widgets.js.download"></script><script type="text/javascript" async="" src="./How to Develop LSTM Models for Time Series Forecasting_files/analytics.js.download"></script><script id="twitcount_plugins" src="./How to Develop LSTM Models for Time Series Forecasting_files/twitcount.js.download"></script><script type="text/javascript" async="" src="./How to Develop LSTM Models for Time Series Forecasting_files/9556588.js.download"></script><script type="application/ld+json" class="yoast-schema-graph yoast-schema-graph--main">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://machinelearningmastery.com/#organization","name":"Machine Learning Mastery","url":"https://machinelearningmastery.com/","sameAs":["https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/TeachTheMachine"],"logo":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#logo","url":"https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon.png","width":512,"height":512,"caption":"Machine Learning Mastery"},"image":{"@id":"https://machinelearningmastery.com/#logo"}},{"@type":"WebSite","@id":"https://machinelearningmastery.com/#website","url":"https://machinelearningmastery.com/","name":"Machine Learning Mastery","publisher":{"@id":"https://machinelearningmastery.com/#organization"},"potentialAction":{"@type":"SearchAction","target":"https://machinelearningmastery.com/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#primaryimage","url":"https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/11/How-to-Develop-LSTM-Models-for-Time-Series-Forecasting.jpg","width":640,"height":360,"caption":"How to Develop LSTM Models for Time Series Forecasting"},{"@type":"WebPage","@id":"https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#webpage","url":"https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/","inLanguage":"en-US","name":"How to Develop LSTM Models for Time Series Forecasting","isPartOf":{"@id":"https://machinelearningmastery.com/#website"},"primaryImageOfPage":{"@id":"https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#primaryimage"},"datePublished":"2018-11-13T18:00:06+00:00","dateModified":"2019-07-28T20:18:46+00:00"},{"@type":"Article","@id":"https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#article","isPartOf":{"@id":"https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#webpage"},"author":{"@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8"},"headline":"How to Develop LSTM Models for Time Series Forecasting","datePublished":"2018-11-13T18:00:06+00:00","dateModified":"2019-07-28T20:18:46+00:00","commentCount":"249","mainEntityOfPage":{"@id":"https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#webpage"},"publisher":{"@id":"https://machinelearningmastery.com/#organization"},"image":{"@id":"https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#primaryimage"},"articleSection":"Deep Learning for Time Series"},{"@type":["Person"],"@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8","name":"Jason Brownlee","image":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#authorlogo","url":"https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=96&d=mm&r=g","caption":"Jason Brownlee"},"description":"Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.","sameAs":["https://www.facebook.com/jason.brownlee.39","https://twitter.com/teachthemachine"]}]}</script>
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Feed" href="https://feeds.feedburner.com/MachineLearningMastery">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Comments Feed" href="https://machinelearningmastery.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » How to Develop LSTM Models for Time Series Forecasting Comments Feed" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.2.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./How to Develop LSTM Models for Time Series Forecasting_files/wp-emoji-release.min.js.download" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="crayon-css" href="./How to Develop LSTM Models for Time Series Forecasting_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="./How to Develop LSTM Models for Time Series Forecasting_files/classic.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./How to Develop LSTM Models for Time Series Forecasting_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="./How to Develop LSTM Models for Time Series Forecasting_files/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="simple-sitemap-css-css" href="./How to Develop LSTM Models for Time Series Forecasting_files/simple-sitemap.css" type="text/css" media="all">
<link rel="stylesheet" id="contact-form-7-css" href="./How to Develop LSTM Models for Time Series Forecasting_files/styles.css" type="text/css" media="all">
<link rel="stylesheet" id="ssb-front-css-css" href="./How to Develop LSTM Models for Time Series Forecasting_files/front.css" type="text/css" media="all">
<link rel="stylesheet" id="ewd-ufaq-style-css" href="./How to Develop LSTM Models for Time Series Forecasting_files/ewd-ufaq-styles.css" type="text/css" media="all">
<link rel="stylesheet" id="ewd-ufaq-rrssb-css" href="./How to Develop LSTM Models for Time Series Forecasting_files/rrssb-min.css" type="text/css" media="all">
<link rel="stylesheet" id="woo-testimonials-css-css" href="./How to Develop LSTM Models for Time Series Forecasting_files/testimonials.css" type="text/css" media="all">
<link rel="stylesheet" id="theme-stylesheet-css" href="./How to Develop LSTM Models for Time Series Forecasting_files/style.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="./How to Develop LSTM Models for Time Series Forecasting_files/jquery.js.download"></script>
<script type="text/javascript" src="./How to Develop LSTM Models for Time Series Forecasting_files/jquery-migrate.min.js.download"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./How to Develop LSTM Models for Time Series Forecasting_files/crayon.min.js.download"></script>
<script type="text/javascript" src="./How to Develop LSTM Models for Time Series Forecasting_files/front.js.download"></script>
<script type="text/javascript" src="./How to Develop LSTM Models for Time Series Forecasting_files/third-party.min.js.download"></script>
<script type="text/javascript" src="./How to Develop LSTM Models for Time Series Forecasting_files/modernizr.min.js.download"></script>
<script type="text/javascript" src="./How to Develop LSTM Models for Time Series Forecasting_files/general.min.js.download"></script>
<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://machinelearningmastery.com/?p=6435">
<link rel="alternate" type="application/json+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-develop-lstm-models-for-time-series-forecasting%2F">
<link rel="alternate" type="text/xml+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-develop-lstm-models-for-time-series-forecasting%2F&amp;format=xml">
<!-- Anti-flicker snippet (recommended)  -->
<style>.async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'async-hide','dataLayer',4000,
{'GTM-MV6J2DK':true});</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="./How to Develop LSTM Models for Time Series Forecasting_files/js(1)"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-44039733-3', { 'optimize_id': 'GTM-MV6J2DK'});
</script>
 <style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
    <script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>

<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 15px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#eeeeee!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#84abc7!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#84abc7;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Woo Shortcodes CSS -->
<link href="./How to Develop LSTM Models for Time Series Forecasting_files/shortcodes.css" rel="stylesheet" type="text/css">

<!-- Custom Stylesheet -->
<link href="./How to Develop LSTM Models for Time Series Forecasting_files/custom.css" rel="stylesheet" type="text/css">

<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21">
<meta name="generator" content="WooFramework 6.2.9">
<link rel="icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32">
<link rel="icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png">
<meta name="msapplication-TileImage" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png">
<script src="./How to Develop LSTM Models for Time Series Forecasting_files/can-i-show.js.download"></script><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><script src="chrome-extension://mooikfkahbdckldjjndioackbalphokd/assets/prompt.js"></script><link rel="stylesheet" type="text/css" href="./How to Develop LSTM Models for Time Series Forecasting_files/twitcount.css" media="all"><style type="text/css">
  /* === Form-Specific Styles === */
  /* stylelint-disable */

  #drip-2211 .drip-content,
  #drip-2211 .drip-header {
    background: rgb(116,174,203) !important;
    background: rgba(116,174,203,0.90) !important;
  }

  #drip-2211 .drip-content h3 {
    color: #333333 !important;
    font-size: 21px !important;
  }

  #drip-2211 .drip-submit-button {
    background-color: #333333 !important;
    font-size: 12px !important;
  }

  #drip-2211 .drip-submit-button:hover {
    background-color: #191919 !important;
  }

  #drip-2211 .drip-submit-button:active {
    background-color: #000000 !important;
  }

  #drip-2211 dl dt,
  #drip-2211 .drip-content .drip-description,
  #drip-2211 .drip-content .classic--checkbox,
  #drip-2211 .drip-errors {
    font-size: 13px !important;
  }

  #drip-2211 .drip-text-field {
    font-size: 14px !important;
  }

  /* === Reset styles === */

  .drip-tab h1,
  .drip-tab h2,
  .drip-tab h3,
  .drip-tab div,
  .drip-tab dl,
  .drip-tab dt,
  .drip-tab dd,
  .drip-tab p,
  .drip-tab a,
  .drip-tab .drip-text-field,
  .drip-tab .drip-text-field:focus,
  .drip-tab .drip-submit-button {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    float: none;
    width: auto;
    background-image: none;
    letter-spacing: 0;
    -webkit-box-shadow: none;
       -moz-box-shadow: none;
            box-shadow: none;
    -webkit-text-shadow: none !important;
       -moz-text-shadow: none !important;
            text-shadow: none !important;
  }

  .drip-tab a {
    text-decoration: none;
  }

  .drip-tab :focus {
    outline: 0;
  }

  /* === Clearfix === */

  .drip-clearfix:after {
    visibility: hidden;
    display: block;
    font-size: 0;
    content: " ";
    clear: both;
    height: 0;
  }
  * html .drip-clearfix             { zoom: 1; } /* IE6 */
  *:first-child+html .drip-clearfix { zoom: 1; } /* IE7 */

  /* === Main Container === */

  .drip-tab-container * {
    box-sizing: content-box;
  }

  /* === Content === */

  .drip-tab .drip-content {
    margin: 0;
    padding: 5px;
    width: 330px;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
       -moz-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
            box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  }

  .drip-tab.bottom .drip-content {
    bottom: -800px;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom.left .drip-content {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-content {
    right: 40px;
  }

  .drip-tab.image-left .drip-content,
  .drip-tab.image-right .drip-content {
    width: 510px;
  }

  .drip-tab.side .drip-content {
    top: 10%;
  }

  .drip-tab.side.right .drip-content {
    right: -550px;
    -webkit-border-radius: 8px 0 0 8px;
       -moz-border-radius: 8px 0 0 8px;
            border-radius: 8px 0 0 8px;
    -webkit-transition: right 200ms ease-in;
       -moz-transition: right 200ms ease-in;
         -o-transition: right 200ms ease-in;
            transition: right 200ms ease-in;
  }

  .drip-tab.side.left .drip-content {
    left: -550px;
    -webkit-border-radius: 0 8px 8px 0;
       -moz-border-radius: 0 8px 8px 0;
            border-radius: 0 8px 8px 0;
    -webkit-transition: left 200ms ease-in;
       -moz-transition: left 200ms ease-in;
         -o-transition: left 200ms ease-in;
            transition: left 200ms ease-in;
  }

  .drip-tab.mobile .drip-content {
    width: 100% !important;
    bottom: -800px;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.drip-scrollable .drip-content {
    overflow-y: scroll;
  }

  /* === Header === */

  .drip-tab .drip-header {
    margin: 0;
    padding: 0;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
       -moz-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
            box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
  }

  .drip-tab.bottom .drip-header {
    width: 330px;
    bottom: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom .drip-header.drip-hidden {
    bottom: -800px;
  }

  .drip-tab.bottom.left .drip-header {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-header {
    right: 40px;
  }

  .drip-tab.bottom.image-left .drip-header,
  .drip-tab.bottom.image-right .drip-header {
    width: 510px;
  }

  .drip-tab.side .drip-header {
    width: 330px;
    top: 10%;
  }

  .drip-tab.side.right .drip-header {
    right: -100px;
    -webkit-transition: right 400ms ease-in;
       -moz-transition: right 400ms ease-in;
         -o-transition: right 400ms ease-in;
            transition: right 400ms ease-in;
    -webkit-transform: rotate(-90deg) !important;
       -moz-transform: rotate(-90deg) !important;
        -ms-transform: rotate(-90deg) !important;
         -o-transform: rotate(-90deg) !important;
            transform: rotate(-90deg) !important;
    -webkit-transform-origin: right center;
       -moz-transform-origin: right center;
         -o-transform-origin: right center;
            transform-origin: right center;
  }

  .drip-tab.side.right .drip-header.drip-hidden {
    right: -100px;
  }

  .drip-tab.side.left .drip-header {
    left: -100px;
    -webkit-transition: left 400ms ease-in;
       -moz-transition: left 400ms ease-in;
         -o-transition: left 400ms ease-in;
            transition: left 400ms ease-in;
    -webkit-transform: rotate(90deg) !important;
       -moz-transform: rotate(90deg) !important;
        -ms-transform: rotate(90deg) !important;
         -o-transform: rotate(90deg) !important;
            transform: rotate(90deg) !important;
    -webkit-transform-origin: left center;
       -moz-transform-origin: left center;
         -o-transform-origin: left center;
            transform-origin: left center;
  }

  .drip-tab.side.left .drip-header.drip-hidden {
    left: -100px;
  }

  .drip-tab.mobile .drip-header {
    width: 100% !important;
    bottom: 0;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.mobile .drip-header.drip-hidden {
    bottom: -300px;
  }

  /* === Header Toggle === */

  .drip-tab .drip-toggle {
    display: block;
    text-decoration: none;
    padding: 10px 50px 10px 20px; /* extra padding for the arrow */
  }

  /* === Teaser === */

  .drip-tab .drip-header h2 {
    display: block;
    margin: 0 !important;
    padding: 0 !important;
    border: 0 !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #fff !important;
    clear: none !important;
    letter-spacing: 0 !important;
    width: auto !important;
  }

  /* === Arrows === */

  .drip-tab .drip-header span.drip-arrow {
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    top: 17px;
    right: 32px;
  }

  /* === Panel === */

  .drip-tab .drip-content > div.drip-panel {
    padding: 15px 15px 12px;
    background-color: #fff;
    -webkit-border-radius: 6px;
       -moz-border-radius: 6px;
            border-radius: 6px;
  }

  /* === Powered By === */

  .drip-tab .drip-powered-by {
    padding: 8px;
    margin-bottom: -5px;
    font-family: Helvetica, Arial, sans-serif;
    text-align: left;
    font-weight: bold;
    font-size: 10px;
    line-height: 16px;
    color: #ffffff;
    letter-spacing: 1px;
    text-align: center;
    text-transform: uppercase;
    display: -webkit-box;
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .drip-tab .drip-powered-by a {
    color: #ffffff !important;
    text-decoration: underline !important;
    letter-spacing: 1px;
    margin-left: 6px;
  }

  /* === Content Headings & Paragraphs === */

  .drip-tab .drip-content h3 {
    display: block;
    margin: 0 20px 0 0 !important;
    padding: 0 0 15px 0 !important;
    line-height: 1.4 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #4477bd !important;
    clear: none !important;
  }

  .drip-tab .drip-content .drip-description {
    margin: 0;
    padding: 0 0 20px 0;
    line-height: 1.6;
    text-align: left;
  }

  .drip-tab.image-left .drip-content .drip-description {
    margin-left: 170px;
  }

  .drip-tab.image-right .drip-content .drip-description {
    margin-right: 170px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content .drip-description {
      margin-left: 0; /* 120px; */
    }

    .drip-tab.image-right .drip-content .drip-description {
      margin-right: 0; /* 120px; */
    }
  }

  .drip-tab .drip-content .drip-description a {
    text-decoration: underline;
  }

  .drip-tab .drip-content .drip-description em {
    font-style: italic;
  }

  .drip-tab .drip-content .drip-description ul,
  .drip-tab .drip-content .drip-description ol {
    list-style-position: outside;
    margin: 8px 0 8px 30px;
  }

  .drip-tab .drip-content .drip-description ul li
  .drip-tab .drip-content .drip-description ol li {
    padding: 0;
  }

  .drip-tab .drip-content img.drip-image {
    margin-bottom: 20px;
  }

  .drip-tab.image-left .drip-content img.drip-image {
    float: left;
    width: 150px;
  }

  .drip-tab.image-right .drip-content img.drip-image {
    float: right;
    width: 150px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content img.drip-image {
      margin-right: 20px;
      width: 100px;
    }

    .drip-tab.image-right .drip-content img.drip-image {
      margin-left: 20px;
      width: 100px;
    }
  }

  .drip-tab .drip-content a.drip-close {
    font-family: Arial, Helvetica, sans-serif;
    margin: -1px 0 0 0;
    float: right;
    font-size: 28px;
    line-height: 15px;
    font-weight: normal;
    color: #333;
    opacity: 0.4;
  }

  .drip-tab .drip-content a.drip-close:hover {
    text-decoration: none;
    cursor: pointer;
    opacity: 0.6;
  }

  /* === Content Subscribe Form === */

  .drip-tab form {
    margin: 0 !important;
    padding: 0 !important;
  }

  .drip-tab dl {
    display: block;
    margin: 0;
    padding: 0;
  }

  .drip-tab dl dt {
    display: block;
    padding: 0 0 5px 0;
    font-weight: bold;
  }

  .drip-tab dl.no-labels dt {
    display: none;
  }

  .drip-tab dl dd {
    display: block;
    padding: 0 0 10px 0;
  }

  .drip-tab .drip-text-field {
    margin: 0 !important;
    padding: 6px !important;
    height: auto !important;
    width: 100% !important;
    color: #333 !important;
    background-color: #fff !important;
    border: 1px solid #c4c4c4 !important;
    -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
       -moz-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
            box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
    -webkit-box-sizing: border-box !important;
       -moz-box-sizing: border-box !important;
        -ms-box-sizing: border-box !important;
            box-sizing: border-box !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
  }

  .drip-tab .drip-text-field::-webkit-input-placeholder { /* WebKit browsers */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field::-moz-placeholder { /* Mozilla Firefox 19+ */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-ms-input-placeholder { /* Internet Explorer 10+ */
    color: #999999 !important;
  }

  .drip-tab .drip-text-field:focus {
    border-color: #a4a4a4 !important;
    outline: 0;
    background-image: none;
    background-color: #fff !important;
  }

  .drip-tab.mobile .drip-text-field {
    font-size: 16px;
  }

  .drip-tab .drip-errors {
    padding: 5px 0 0 0;
    font-weight: normal;
    color: red;
  }

  .drip-tab .drip-submit-button {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
    padding: 3px 12px !important;
    color: #ffffff !important;
    font-weight: bold !important;
    line-height: 1.6 !important;
    border: 0 !important;
    -webkit-border-radius: 15px !important;
       -moz-border-radius: 15px !important;
            border-radius: 15px !important;
    cursor: pointer !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
    height: auto;
  }

  .drip-tab .drip-submit-button:hover {
    background-image: none !important;
  }

  .drip-tab .drip-submit-button:active {
    background-image: none !important;
  }

  /* checkbox */
  .drip-tab .classic--checkbox.hidden {
    margin-bottom: -8px;
    display: none;
  }

  .drip-tab .classic--checkbox input[type="checkbox"] {
    display: inline-block;
    width: auto;
  }

  /* stylelint-enable */

</style></head>
<body class="post-template-default single single-post postid-6435 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960" data-gr-c-s-loaded="true">
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img src="./How to Develop LSTM Models for Time Series Forecasting_files/icon-100x100.png" alt="Machine Learning Mastery"></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="text-53" class="widget widget_text">			<div class="textwidget"><p>Want help with deep learning for time series? <a href="https://machinelearningmastery.lpages.co/deep-learning-for-time-series-forecasting-mini-course/">Take the FREE Mini-Course</a></p>
</div>
		</div><div id="search-3" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="https://machinelearningmastery.com/">
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (this.value == &#39;Search...&#39;) {this.value = &#39;&#39;;}" onblur="if (this.value == &#39;&#39;) {this.value = &#39;Search...&#39;;}">
		<input type="hidden" name="post_type" value="post">
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="https://machinelearningmastery.com/" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-6503" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Get Started</a></li>
<li id="menu-item-6501" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li id="menu-item-6506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506 parent"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#">Topics</a>
<ul class="sub-menu">
	<li id="menu-item-6508" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
	<li id="menu-item-7921" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7921"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Deep Learning for Computer Vision</a></li>
	<li id="menu-item-6509" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series Foreasting</a></li>
	<li id="menu-item-6515" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for Text</a></li>
	<li id="menu-item-8576" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8576"><a href="https://machinelearningmastery.com/category/generative-adversarial-networks/">GANs</a></li>
	<li id="menu-item-6511" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
	<li id="menu-item-7106" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7106"><a href="https://machinelearningmastery.com/category/better-deep-learning/">Better Deep Learning</a></li>
	<li id="menu-item-6512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
	<li id="menu-item-6507" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms</a></li>
	<li id="menu-item-6513" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">ML Process</a></li>
	<li id="menu-item-6516" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
	<li id="menu-item-6517" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
	<li id="menu-item-6522" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
	<li id="menu-item-6518" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
	<li id="menu-item-6510" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
	<li id="menu-item-6519" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
	<li id="menu-item-6520" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series</a></li>
	<li id="menu-item-6523" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
</ul>
</li>
<li id="menu-item-6502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502"><a href="https://machinelearningmastery.com/products/">EBooks</a></li>
<li id="menu-item-6500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li id="menu-item-6504" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li id="menu-item-6505" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#top" class="nav-close"><span>Return to Content</span></a>

</nav>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-6435 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning-time-series">
	<header>
	<h1 class="title entry-title">How to Develop LSTM Models for Time Series Forecasting</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2018-11-14T05:00:06+1000">November 14, 2018</abbr>  <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/" title="View all items in Deep Learning for Time Series">Deep Learning for Time Series</a></span>  </div>
	<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-6435 post  simplesocialbuttons-inline-no-animation simplesocialbuttons-inline-in">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Develop+LSTM+Models+for+Time+Series+Forecasting&amp;url=https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<p>Long Short-Term Memory networks, or LSTMs for short, can be applied to <a href="https://machinelearningmastery.com/time-series-forecasting/">time series forecasting</a>.</p>
<p>There are many types of LSTM models that can be used for each specific type of time series forecasting problem.</p>
<p>In this tutorial, you will discover how to develop a suite of LSTM models for a range of standard time series forecasting problems.</p>
<p>The objective of this tutorial is to provide standalone examples of each model on each type of time series problem as a template that you can copy and adapt for your specific time series forecasting problem.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to develop LSTM models for univariate time series forecasting.</li>
<li>How to develop LSTM models for multivariate time series forecasting.</li>
<li>How to develop LSTM models for multi-step time series forecasting.</li>
</ul>
<p>This is a large and important post; you may want to bookmark it for future reference.</p>
<p>Let’s get started.</p>
<div id="attachment_6436" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-6436" class="size-full wp-image-6436" src="./How to Develop LSTM Models for Time Series Forecasting_files/How-to-Develop-LSTM-Models-for-Time-Series-Forecasting.jpg" alt="How to Develop LSTM Models for Time Series Forecasting" width="640" height="360" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/11/How-to-Develop-LSTM-Models-for-Time-Series-Forecasting.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/11/How-to-Develop-LSTM-Models-for-Time-Series-Forecasting-300x169.jpg 300w" sizes="(max-width: 640px) 100vw, 640px"><p id="caption-attachment-6436" class="wp-caption-text">How to Develop LSTM Models for Time Series Forecasting<br>Photo by <a href="https://www.flickr.com/photos/15216811@N06/6704346543/">N i c o l a</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>In this tutorial, we will explore how to develop a suite of different types of LSTM models for time series forecasting.</p>
<p>The models are demonstrated on small contrived time series problems intended to give the flavor of the type of time series problem being addressed. The chosen configuration of the models is arbitrary and not optimized for each problem; that was not the goal.</p>
<p>This tutorial is divided into four parts; they are:</p>
<ol>
<li>Univariate LSTM Models</li>
<li>Multivariate LSTM Models</li>
<li>Multi-Step LSTM Models</li>
<li>Multivariate Multi-Step LSTM Models</li>
</ol>
<h2>Univariate LSTM Models</h2>
<p>LSTMs can be used to model univariate time series forecasting problems.</p>
<p>These are problems comprised of a single series of observations and a model is required to learn from the series of past observations to predict the next value in the sequence.</p>
<p>We will demonstrate a number of variations of the LSTM model for univariate time series forecasting.</p>
<p>This section is divided into six parts; they are:</p>
<ol>
<li>Data Preparation</li>
<li>Vanilla LSTM</li>
<li>Stacked LSTM</li>
<li>Bidirectional LSTM</li>
<li>CNN LSTM</li>
<li>ConvLSTM</li>
</ol>
<p>Each of these models are demonstrated for one-step univariate time series forecasting, but can easily be adapted and used as the input part of a model for other types of time series forecasting problems.</p>
<h3>Data Preparation</h3>
<p>Before a univariate series can be modeled, it must be prepared.</p>
<p>The LSTM model will learn a function that maps a sequence of past observations as input to an output observation. As such, the sequence of observations must be transformed into multiple examples from which the LSTM can learn.</p>
<p>Consider a given univariate sequence:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560978417295058" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[10, 20, 30, 40, 50, 60, 70, 80, 90]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560978417295058-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560978417295058-1">[10, 20, 30, 40, 50, 60, 70, 80, 90]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can divide the sequence into multiple input/output patterns called samples, where three time steps are used as input and one time step is used as output for the one-step prediction that is being learned.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560989057022786" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">X,				y
10, 20, 30		40
20, 30, 40		50
30, 40, 50		60
...</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560989057022786-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560989057022786-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560989057022786-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560989057022786-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560989057022786-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560989057022786-1">X,				y</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560989057022786-2">10, 20, 30		40</div><div class="crayon-line" id="crayon-5d4518f560989057022786-3">20, 30, 40		50</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560989057022786-4">30, 40, 50		60</div><div class="crayon-line" id="crayon-5d4518f560989057022786-5">...</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The <em>split_sequence()</em> function below implements this behavior and will split a given univariate sequence into multiple samples where each sample has a specified number of time steps and the output is a single time step.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f56098d708413897" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># split a univariate sequence into samples
def split_sequence(sequence, n_steps):
	X, y = list(), list()
	for i in range(len(sequence)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the sequence
		if end_ix &gt; len(sequence)-1:
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequence[i:end_ix], sequence[end_ix]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f56098d708413897-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56098d708413897-2">2</div><div class="crayon-num" data-line="crayon-5d4518f56098d708413897-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56098d708413897-4">4</div><div class="crayon-num" data-line="crayon-5d4518f56098d708413897-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56098d708413897-6">6</div><div class="crayon-num" data-line="crayon-5d4518f56098d708413897-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56098d708413897-8">8</div><div class="crayon-num" data-line="crayon-5d4518f56098d708413897-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56098d708413897-10">10</div><div class="crayon-num" data-line="crayon-5d4518f56098d708413897-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56098d708413897-12">12</div><div class="crayon-num" data-line="crayon-5d4518f56098d708413897-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56098d708413897-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f56098d708413897-1"><span class="crayon-p"># split a univariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56098d708413897-2"><span class="crayon-e">def </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f56098d708413897-3"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56098d708413897-4"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f56098d708413897-5"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56098d708413897-6"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line" id="crayon-5d4518f56098d708413897-7"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56098d708413897-8"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f56098d708413897-9"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56098d708413897-10"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line" id="crayon-5d4518f56098d708413897-11"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56098d708413897-12"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f56098d708413897-13"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56098d708413897-14"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>We can demonstrate this function on our small contrived dataset above.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560991930265669" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># univariate data preparation
from numpy import array

# split a univariate sequence into samples
def split_sequence(sequence, n_steps):
	X, y = list(), list()
	for i in range(len(sequence)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the sequence
		if end_ix &gt; len(sequence)-1:
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequence[i:end_ix], sequence[end_ix]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
raw_seq = [10, 20, 30, 40, 50, 60, 70, 80, 90]
# choose a number of time steps
n_steps = 3
# split into samples
X, y = split_sequence(raw_seq, n_steps)
# summarize the data
for i in range(len(X)):
	print(X[i], y[i])</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560991930265669-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560991930265669-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560991930265669-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560991930265669-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560991930265669-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560991930265669-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560991930265669-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560991930265669-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560991930265669-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560991930265669-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560991930265669-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560991930265669-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560991930265669-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560991930265669-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560991930265669-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560991930265669-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560991930265669-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560991930265669-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560991930265669-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560991930265669-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560991930265669-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560991930265669-22">22</div><div class="crayon-num" data-line="crayon-5d4518f560991930265669-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560991930265669-24">24</div><div class="crayon-num" data-line="crayon-5d4518f560991930265669-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560991930265669-26">26</div><div class="crayon-num" data-line="crayon-5d4518f560991930265669-27">27</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560991930265669-1"><span class="crayon-p"># univariate data preparation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560991930265669-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f560991930265669-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560991930265669-4"><span class="crayon-p"># split a univariate sequence into samples</span></div><div class="crayon-line" id="crayon-5d4518f560991930265669-5"><span class="crayon-e">def </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560991930265669-6"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560991930265669-7"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560991930265669-8"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line" id="crayon-5d4518f560991930265669-9"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560991930265669-10"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the sequence</span></div><div class="crayon-line" id="crayon-5d4518f560991930265669-11"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560991930265669-12"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5d4518f560991930265669-13"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560991930265669-14"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560991930265669-15"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560991930265669-16"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560991930265669-17"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560991930265669-18">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560991930265669-19"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560991930265669-20"><span class="crayon-v">raw_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560991930265669-21"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560991930265669-22"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line" id="crayon-5d4518f560991930265669-23"><span class="crayon-p"># split into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560991930265669-24"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">raw_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560991930265669-25"><span class="crayon-p"># summarize the data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560991930265669-26"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560991930265669-27"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p>Running the example splits the univariate series into six samples where each sample has three input time steps and one output time step.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560995781230459" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[10 20 30] 40
[20 30 40] 50
[30 40 50] 60
[40 50 60] 70
[50 60 70] 80
[60 70 80] 90</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560995781230459-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560995781230459-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560995781230459-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560995781230459-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560995781230459-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560995781230459-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560995781230459-1">[10 20 30] 40</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560995781230459-2">[20 30 40] 50</div><div class="crayon-line" id="crayon-5d4518f560995781230459-3">[30 40 50] 60</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560995781230459-4">[40 50 60] 70</div><div class="crayon-line" id="crayon-5d4518f560995781230459-5">[50 60 70] 80</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560995781230459-6">[60 70 80] 90</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Now that we know how to prepare a univariate series for modeling, let’s look at developing LSTM models that can learn the mapping of inputs to outputs, starting with a Vanilla LSTM.</p>
<p></p><div class="woo-sc-hr"></div><p></p>
<center>
<h3>Need help with Deep Learning for Time Series?</h3>
<p>Take my free 7-day email crash course now (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/14531ee73f72a2%3A164f8be4f346dc/5630742793027584/" target="_blank" style="background: rgb(255, 206, 10); color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" data-leadbox="https://machinelearningmastery.lpages.co/leadbox/14531ee73f72a2%3A164f8be4f346dc/5630742793027584/" data-leadbox-id="14531ee73f72a2:164f8be4f346dc">Download Your FREE Mini-Course</a><script data-leadbox="14531ee73f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/14531ee73f72a2%3A164f8be4f346dc/5630742793027584/" data-config="%7B%7D" type="text/javascript" src="./How to Develop LSTM Models for Time Series Forecasting_files/leadbox-1534880695.js.download"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div><p></p>
<h3>Vanilla LSTM</h3>
<p>A Vanilla LSTM is an LSTM model that has a single hidden layer of LSTM units, and an output layer used to make a prediction.</p>
<p>We can define a Vanilla LSTM for univariate time series forecasting as follows.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560999023392035" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># define model
model = Sequential()
model.add(LSTM(50, activation='relu', input_shape=(n_steps, n_features)))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560999023392035-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560999023392035-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560999023392035-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560999023392035-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560999023392035-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560999023392035-1"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560999023392035-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560999023392035-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560999023392035-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560999023392035-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Key in the definition is the shape of the input; that is what the model expects as input for each sample in terms of the number of time steps and the number of features.</p>
<p>We are working with a univariate series, so the number of features is one, for one variable.</p>
<p>The number of time steps as input is the number we chose when preparing our dataset as an argument to the <em>split_sequence()</em> function.</p>
<p>The shape of the input for each sample is specified in the <em>input_shape</em> argument on the definition of first hidden layer.</p>
<p>We almost always have multiple samples, therefore, the model will expect the input component of training data to have the dimensions or shape:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f56099d222936576" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[samples, timesteps, features]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f56099d222936576-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f56099d222936576-1">[samples, timesteps, features]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Our <em>split_sequence()</em> function in the previous section outputs the X with the shape [<em>samples, timesteps</em>], so we easily reshape it to have an additional dimension for the one feature.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609a3266525562" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># reshape from [samples, timesteps] into [samples, timesteps, features]
n_features = 1
X = X.reshape((X.shape[0], X.shape[1], n_features))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609a3266525562-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609a3266525562-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609a3266525562-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609a3266525562-1"><span class="crayon-p"># reshape from [samples, timesteps] into [samples, timesteps, features]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609a3266525562-2"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5d4518f5609a3266525562-3"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>In this case, we define a model with 50 LSTM units in the hidden layer and an output layer that predicts a single numerical value.</p>
<p>The model is fit using the efficient <a href="https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/">Adam version of stochastic gradient descent</a> and optimized using the mean squared error, or ‘<em>mse</em>‘ loss function.</p>
<p>Once the model is defined, we can fit it on the training dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609a6616795704" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># fit model
model.fit(X, y, epochs=200, verbose=0)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609a6616795704-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609a6616795704-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609a6616795704-1"><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609a6616795704-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>After the model is fit, we can use it to make a prediction.</p>
<p>We can predict the next value in the sequence by providing the input:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609a9000500078" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[70, 80, 90]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609a9000500078-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609a9000500078-1">[70, 80, 90]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>And expecting the model to predict something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609ad045564570" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[100]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609ad045564570-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609ad045564570-1">[100]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The model expects the input shape to be three-dimensional with [<em>samples, timesteps, features</em>], therefore, we must reshape the single input sample before making the prediction.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609b0584702581" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># demonstrate prediction
x_input = array([70, 80, 90])
x_input = x_input.reshape((1, n_steps, n_features))
yhat = model.predict(x_input, verbose=0)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609b0584702581-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b0584702581-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609b0584702581-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b0584702581-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609b0584702581-1"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b0584702581-2"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609b0584702581-3"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b0584702581-4"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>We can tie all of this together and demonstrate how to develop a Vanilla LSTM for univariate time series forecasting and make a single prediction.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609b3199474062" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># univariate lstm example
from numpy import array
from keras.models import Sequential
from keras.layers import LSTM
from keras.layers import Dense

# split a univariate sequence into samples
def split_sequence(sequence, n_steps):
	X, y = list(), list()
	for i in range(len(sequence)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the sequence
		if end_ix &gt; len(sequence)-1:
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequence[i:end_ix], sequence[end_ix]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
raw_seq = [10, 20, 30, 40, 50, 60, 70, 80, 90]
# choose a number of time steps
n_steps = 3
# split into samples
X, y = split_sequence(raw_seq, n_steps)
# reshape from [samples, timesteps] into [samples, timesteps, features]
n_features = 1
X = X.reshape((X.shape[0], X.shape[1], n_features))
# define model
model = Sequential()
model.add(LSTM(50, activation='relu', input_shape=(n_steps, n_features)))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')
# fit model
model.fit(X, y, epochs=200, verbose=0)
# demonstrate prediction
x_input = array([70, 80, 90])
x_input = x_input.reshape((1, n_steps, n_features))
yhat = model.predict(x_input, verbose=0)
print(yhat)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-4">4</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-6">6</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-8">8</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-10">10</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-12">12</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-14">14</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-16">16</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-18">18</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-20">20</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-22">22</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-24">24</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-26">26</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-28">28</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-30">30</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-32">32</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-34">34</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-36">36</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-38">38</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-40">40</div><div class="crayon-num" data-line="crayon-5d4518f5609b3199474062-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609b3199474062-42">42</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609b3199474062-1"><span class="crayon-p"># univariate lstm example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-6">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-7"><span class="crayon-p"># split a univariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-8"><span class="crayon-e">def </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-9"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-10"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-11"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-12"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-13"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-14"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-15"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-16"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-17"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-18"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-19"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-20"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-22"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-23"><span class="crayon-v">raw_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-24"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-25"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-26"><span class="crayon-p"># split into samples</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-27"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">raw_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-28"><span class="crayon-p"># reshape from [samples, timesteps] into [samples, timesteps, features]</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-29"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-30"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-31"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-32"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-33"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-34"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-35"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-36"><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-37"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-38"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-39"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-40"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609b3199474062-41"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609b3199474062-42"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0036 seconds] -->
<p>Running the example prepares the data, fits the model, and makes a prediction.</p>
<p>Your results may vary given the stochastic nature of the algorithm; try running the example a few times.</p>
<p>We can see that the model predicts the next value in the sequence.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609b7761944440" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[102.09213]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609b7761944440-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609b7761944440-1">[[102.09213]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>Stacked LSTM</h3>
<p>Multiple hidden LSTM layers can be stacked one on top of another in what is referred to as a Stacked LSTM model.</p>
<p>An LSTM layer requires a three-dimensional input and LSTMs by default will produce a two-dimensional output as an interpretation from the end of the sequence.</p>
<p>We can address this by having the LSTM output a value for each time step in the input data by setting the <em>return_sequences=True</em> argument on the layer. This allows us to have 3D output from hidden LSTM layer as input to the next.</p>
<p>We can therefore define a Stacked LSTM as follows.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609ba991610481" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># define model
model = Sequential()
model.add(LSTM(50, activation='relu', return_sequences=True, input_shape=(n_steps, n_features)))
model.add(LSTM(50, activation='relu'))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609ba991610481-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609ba991610481-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609ba991610481-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609ba991610481-4">4</div><div class="crayon-num" data-line="crayon-5d4518f5609ba991610481-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609ba991610481-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609ba991610481-1"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609ba991610481-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609ba991610481-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609ba991610481-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609ba991610481-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609ba991610481-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>We can tie this together; the complete code example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609bd259532616" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># univariate stacked lstm example
from numpy import array
from keras.models import Sequential
from keras.layers import LSTM
from keras.layers import Dense

# split a univariate sequence
def split_sequence(sequence, n_steps):
	X, y = list(), list()
	for i in range(len(sequence)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the sequence
		if end_ix &gt; len(sequence)-1:
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequence[i:end_ix], sequence[end_ix]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
raw_seq = [10, 20, 30, 40, 50, 60, 70, 80, 90]
# choose a number of time steps
n_steps = 3
# split into samples
X, y = split_sequence(raw_seq, n_steps)
# reshape from [samples, timesteps] into [samples, timesteps, features]
n_features = 1
X = X.reshape((X.shape[0], X.shape[1], n_features))
# define model
model = Sequential()
model.add(LSTM(50, activation='relu', return_sequences=True, input_shape=(n_steps, n_features)))
model.add(LSTM(50, activation='relu'))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')
# fit model
model.fit(X, y, epochs=200, verbose=0)
# demonstrate prediction
x_input = array([70, 80, 90])
x_input = x_input.reshape((1, n_steps, n_features))
yhat = model.predict(x_input, verbose=0)
print(yhat)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-4">4</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-6">6</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-8">8</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-10">10</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-12">12</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-14">14</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-16">16</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-18">18</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-20">20</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-22">22</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-24">24</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-26">26</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-28">28</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-30">30</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-32">32</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-34">34</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-36">36</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-38">38</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-40">40</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609bd259532616-42">42</div><div class="crayon-num" data-line="crayon-5d4518f5609bd259532616-43">43</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609bd259532616-1"><span class="crayon-p"># univariate stacked lstm example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-6">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-7"><span class="crayon-p"># split a univariate sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-8"><span class="crayon-e">def </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-9"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-10"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-11"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-12"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-13"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-14"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-15"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-16"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-17"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-18"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-19"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-20"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-22"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-23"><span class="crayon-v">raw_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-24"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-25"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-26"><span class="crayon-p"># split into samples</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-27"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">raw_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-28"><span class="crayon-p"># reshape from [samples, timesteps] into [samples, timesteps, features]</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-29"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-30"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-31"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-32"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-33"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-34"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-35"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-36"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-37"><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-38"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-39"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-40"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-41"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609bd259532616-42"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609bd259532616-43"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0038 seconds] -->
<p>Running the example predicts the next value in the sequence, which we expect would be 100.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609c0924816281" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[102.47341]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609c0924816281-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609c0924816281-1">[[102.47341]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>Bidirectional LSTM</h3>
<p>On some sequence prediction problems, it can be beneficial to allow the LSTM model to learn the input sequence both forward and backwards and concatenate both interpretations.</p>
<p>This is called a <a href="https://machinelearningmastery.com/develop-bidirectional-lstm-sequence-classification-python-keras/">Bidirectional LSTM</a>.</p>
<p>We can implement a Bidirectional LSTM for univariate time series forecasting by wrapping the first hidden layer in a wrapper layer called Bidirectional.</p>
<p>An example of defining a Bidirectional LSTM to read input both forward and backward is as follows.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609c5944396943" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># define model
model = Sequential()
model.add(Bidirectional(LSTM(50, activation='relu'), input_shape=(n_steps, n_features)))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609c5944396943-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c5944396943-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609c5944396943-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c5944396943-4">4</div><div class="crayon-num" data-line="crayon-5d4518f5609c5944396943-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609c5944396943-1"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c5944396943-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609c5944396943-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Bidirectional</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c5944396943-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609c5944396943-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>The complete example of the Bidirectional LSTM for univariate time series forecasting is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609c9292032030" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># univariate bidirectional lstm example
from numpy import array
from keras.models import Sequential
from keras.layers import LSTM
from keras.layers import Dense
from keras.layers import Bidirectional

# split a univariate sequence
def split_sequence(sequence, n_steps):
	X, y = list(), list()
	for i in range(len(sequence)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the sequence
		if end_ix &gt; len(sequence)-1:
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequence[i:end_ix], sequence[end_ix]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
raw_seq = [10, 20, 30, 40, 50, 60, 70, 80, 90]
# choose a number of time steps
n_steps = 3
# split into samples
X, y = split_sequence(raw_seq, n_steps)
# reshape from [samples, timesteps] into [samples, timesteps, features]
n_features = 1
X = X.reshape((X.shape[0], X.shape[1], n_features))
# define model
model = Sequential()
model.add(Bidirectional(LSTM(50, activation='relu'), input_shape=(n_steps, n_features)))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')
# fit model
model.fit(X, y, epochs=200, verbose=0)
# demonstrate prediction
x_input = array([70, 80, 90])
x_input = x_input.reshape((1, n_steps, n_features))
yhat = model.predict(x_input, verbose=0)
print(yhat)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-4">4</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-6">6</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-8">8</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-10">10</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-12">12</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-14">14</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-16">16</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-18">18</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-20">20</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-22">22</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-24">24</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-26">26</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-28">28</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-30">30</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-32">32</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-34">34</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-36">36</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-38">38</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-40">40</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609c9292032030-42">42</div><div class="crayon-num" data-line="crayon-5d4518f5609c9292032030-43">43</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609c9292032030-1"><span class="crayon-p"># univariate bidirectional lstm example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Bidirectional</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-8"><span class="crayon-p"># split a univariate sequence</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-9"><span class="crayon-e">def </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-10"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-11"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-12"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-13"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-14"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the sequence</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-15"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-16"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-17"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-18"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-19"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-20"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-21"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-22">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-23"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-24"><span class="crayon-v">raw_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-25"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-26"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-27"><span class="crayon-p"># split into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-28"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">raw_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-29"><span class="crayon-p"># reshape from [samples, timesteps] into [samples, timesteps, features]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-30"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-31"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-32"><span class="crayon-p"># define model</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-33"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-34"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Bidirectional</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-35"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-36"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-37"><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-38"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-39"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-40"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-41"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609c9292032030-42"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609c9292032030-43"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0037 seconds] -->
<p>Running the example predicts the next value in the sequence, which we expect would be 100.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609cc792427238" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[101.48093]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609cc792427238-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609cc792427238-1">[[101.48093]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>CNN LSTM</h3>
<p>A convolutional neural network, or CNN for short, is a type of neural network developed for working with two-dimensional image data.</p>
<p>The CNN can be very effective at automatically extracting and learning features from one-dimensional sequence data such as univariate time series data.</p>
<p>A CNN model can be used in a hybrid model with an LSTM backend where the CNN is used to interpret subsequences of input that together are provided as a sequence to an LSTM model to interpret. <a href="https://machinelearningmastery.com/cnn-long-short-term-memory-networks/">This hybrid model is called a CNN-LSTM</a>.</p>
<p>The first step is to split the input sequences into subsequences that can be processed by the CNN model. For example, we can first split our univariate time series data into input/output samples with four steps as input and one as output. Each sample can then be split into two sub-samples, each with two time steps. The CNN can interpret each subsequence of two time steps and provide a time series of interpretations of the subsequences to the LSTM model to process as input.</p>
<p>We can parameterize this and define the number of subsequences as <em>n_seq</em> and the number of time steps per subsequence as <em>n_steps</em>. The input data can then be reshaped to have the required structure:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609d0083806247" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[samples, subsequences, timesteps, features]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609d0083806247-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609d0083806247-1">[samples, subsequences, timesteps, features]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609d4708196460" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># choose a number of time steps
n_steps = 4
# split into samples
X, y = split_sequence(raw_seq, n_steps)
# reshape from [samples, timesteps] into [samples, subsequences, timesteps, features]
n_features = 1
n_seq = 2
n_steps = 2
X = X.reshape((X.shape[0], n_seq, n_steps, n_features))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609d4708196460-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609d4708196460-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609d4708196460-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609d4708196460-4">4</div><div class="crayon-num" data-line="crayon-5d4518f5609d4708196460-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609d4708196460-6">6</div><div class="crayon-num" data-line="crayon-5d4518f5609d4708196460-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609d4708196460-8">8</div><div class="crayon-num" data-line="crayon-5d4518f5609d4708196460-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609d4708196460-1"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609d4708196460-2"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-5d4518f5609d4708196460-3"><span class="crayon-p"># split into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609d4708196460-4"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">raw_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609d4708196460-5"><span class="crayon-p"># reshape from [samples, timesteps] into [samples, subsequences, timesteps, features]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609d4708196460-6"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5d4518f5609d4708196460-7"><span class="crayon-v">n_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609d4708196460-8"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5d4518f5609d4708196460-9"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>We want to reuse the same CNN model when reading in each sub-sequence of data separately.</p>
<p>This can be achieved by wrapping the entire CNN model in a <a href="https://machinelearningmastery.com/timedistributed-layer-for-long-short-term-memory-networks-in-python/">TimeDistributed wrapper</a> that will apply the entire model once per input, in this case, once per input subsequence.</p>
<p>The CNN model first has a convolutional layer for reading across the subsequence that requires a number of filters and a kernel size to be specified. The number of filters is the number of reads or interpretations of the input sequence. The kernel size is the number of time steps included of each ‘read’ operation of the input sequence.</p>
<p>The convolution layer is followed by a max pooling layer that distills the filter maps down to 1/2 of their size that includes the most salient features. These structures are then flattened down to a single one-dimensional vector to be used as a single input time step to the LSTM layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609d8168378564" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">model.add(TimeDistributed(Conv1D(filters=64, kernel_size=1, activation='relu'), input_shape=(None, n_steps, n_features)))
model.add(TimeDistributed(MaxPooling1D(pool_size=2)))
model.add(TimeDistributed(Flatten()))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609d8168378564-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609d8168378564-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609d8168378564-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609d8168378564-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">TimeDistributed</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609d8168378564-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">TimeDistributed</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609d8168378564-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">TimeDistributed</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Next, we can define the LSTM part of the model that interprets the CNN model’s read of the input sequence and makes a prediction.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609dc244672210" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">model.add(LSTM(50, activation='relu'))
model.add(Dense(1))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609dc244672210-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609dc244672210-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609dc244672210-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609dc244672210-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>We can tie all of this together; the complete example of a CNN-LSTM model for univariate time series forecasting is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609df532828156" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># univariate cnn lstm example
from numpy import array
from keras.models import Sequential
from keras.layers import LSTM
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers import TimeDistributed
from keras.layers.convolutional import Conv1D
from keras.layers.convolutional import MaxPooling1D

# split a univariate sequence into samples
def split_sequence(sequence, n_steps):
	X, y = list(), list()
	for i in range(len(sequence)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the sequence
		if end_ix &gt; len(sequence)-1:
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequence[i:end_ix], sequence[end_ix]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
raw_seq = [10, 20, 30, 40, 50, 60, 70, 80, 90]
# choose a number of time steps
n_steps = 4
# split into samples
X, y = split_sequence(raw_seq, n_steps)
# reshape from [samples, timesteps] into [samples, subsequences, timesteps, features]
n_features = 1
n_seq = 2
n_steps = 2
X = X.reshape((X.shape[0], n_seq, n_steps, n_features))
# define model
model = Sequential()
model.add(TimeDistributed(Conv1D(filters=64, kernel_size=1, activation='relu'), input_shape=(None, n_steps, n_features)))
model.add(TimeDistributed(MaxPooling1D(pool_size=2)))
model.add(TimeDistributed(Flatten()))
model.add(LSTM(50, activation='relu'))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')
# fit model
model.fit(X, y, epochs=500, verbose=0)
# demonstrate prediction
x_input = array([60, 70, 80, 90])
x_input = x_input.reshape((1, n_seq, n_steps, n_features))
yhat = model.predict(x_input, verbose=0)
print(yhat)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-4">4</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-6">6</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-8">8</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-10">10</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-12">12</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-14">14</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-16">16</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-18">18</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-20">20</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-22">22</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-24">24</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-26">26</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-28">28</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-30">30</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-32">32</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-34">34</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-36">36</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-38">38</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-40">40</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-42">42</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-44">44</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-46">46</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-48">48</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609df532828156-50">50</div><div class="crayon-num" data-line="crayon-5d4518f5609df532828156-51">51</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609df532828156-1"><span class="crayon-p"># univariate cnn lstm example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">TimeDistributed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">Conv1D</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-v">MaxPooling1D</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-10">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f5609df532828156-11"><span class="crayon-p"># split a univariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-12"><span class="crayon-e">def </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-13"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-14"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-15"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-16"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-17"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-18"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-19"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-20"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-21"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-22"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-23"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-24"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-26"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-27"><span class="crayon-v">raw_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-28"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-29"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-30"><span class="crayon-p"># split into samples</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-31"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">raw_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-32"><span class="crayon-p"># reshape from [samples, timesteps] into [samples, subsequences, timesteps, features]</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-33"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-34"><span class="crayon-v">n_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-35"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-36"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-37"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-38"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-39"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">TimeDistributed</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-40"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">TimeDistributed</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-41"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">TimeDistributed</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-42"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-43"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-44"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-45"><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-46"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">500</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-47"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-48"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-49"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609df532828156-50"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609df532828156-51"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0045 seconds] -->
<p>Running the example predicts the next value in the sequence, which we expect would be 100.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609e2129362903" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[101.69263]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609e2129362903-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609e2129362903-1">[[101.69263]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>ConvLSTM</h3>
<p>A type of LSTM related to the CNN-LSTM is the ConvLSTM, where the convolutional reading of input is built directly into each LSTM unit.</p>
<p>The ConvLSTM was developed for reading two-dimensional spatial-temporal data, but can be adapted for use with univariate time series forecasting.</p>
<p>The layer expects input as a sequence of two-dimensional images, therefore the shape of input data must be:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609e6167279924" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[samples, timesteps, rows, columns, features]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609e6167279924-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609e6167279924-1">[samples, timesteps, rows, columns, features]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>For our purposes, we can split each sample into subsequences where timesteps will become the number of subsequences, or <em>n_seq</em>, and columns will be the number of time steps for each subsequence, or <em>n_steps</em>. The number of rows is fixed at 1 as we are working with one-dimensional data.</p>
<p>We can now reshape the prepared samples into the required structure.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609e9175348222" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># choose a number of time steps
n_steps = 4
# split into samples
X, y = split_sequence(raw_seq, n_steps)
# reshape from [samples, timesteps] into [samples, timesteps, rows, columns, features]
n_features = 1
n_seq = 2
n_steps = 2
X = X.reshape((X.shape[0], n_seq, 1, n_steps, n_features))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609e9175348222-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609e9175348222-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609e9175348222-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609e9175348222-4">4</div><div class="crayon-num" data-line="crayon-5d4518f5609e9175348222-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609e9175348222-6">6</div><div class="crayon-num" data-line="crayon-5d4518f5609e9175348222-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609e9175348222-8">8</div><div class="crayon-num" data-line="crayon-5d4518f5609e9175348222-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609e9175348222-1"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609e9175348222-2"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-5d4518f5609e9175348222-3"><span class="crayon-p"># split into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609e9175348222-4"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">raw_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609e9175348222-5"><span class="crayon-p"># reshape from [samples, timesteps] into [samples, timesteps, rows, columns, features]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609e9175348222-6"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5d4518f5609e9175348222-7"><span class="crayon-v">n_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609e9175348222-8"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5d4518f5609e9175348222-9"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>We can define the ConvLSTM as a single layer in terms of the number of filters and a two-dimensional kernel size in terms of (rows, columns). As we are working with a one-dimensional series, the number of rows is always fixed to 1 in the kernel.</p>
<p>The output of the model must then be flattened before it can be interpreted and a prediction made.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609ec088169949" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">model.add(ConvLSTM2D(filters=64, kernel_size=(1,2), activation='relu', input_shape=(n_seq, 1, n_steps, n_features)))
model.add(Flatten())</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609ec088169949-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609ec088169949-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609ec088169949-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">ConvLSTM2D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609ec088169949-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>The complete example of a ConvLSTM for one-step univariate time series forecasting is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609f1574665130" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># univariate convlstm example
from numpy import array
from keras.models import Sequential
from keras.layers import LSTM
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers import ConvLSTM2D

# split a univariate sequence into samples
def split_sequence(sequence, n_steps):
	X, y = list(), list()
	for i in range(len(sequence)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the sequence
		if end_ix &gt; len(sequence)-1:
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequence[i:end_ix], sequence[end_ix]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
raw_seq = [10, 20, 30, 40, 50, 60, 70, 80, 90]
# choose a number of time steps
n_steps = 4
# split into samples
X, y = split_sequence(raw_seq, n_steps)
# reshape from [samples, timesteps] into [samples, timesteps, rows, columns, features]
n_features = 1
n_seq = 2
n_steps = 2
X = X.reshape((X.shape[0], n_seq, 1, n_steps, n_features))
# define model
model = Sequential()
model.add(ConvLSTM2D(filters=64, kernel_size=(1,2), activation='relu', input_shape=(n_seq, 1, n_steps, n_features)))
model.add(Flatten())
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')
# fit model
model.fit(X, y, epochs=500, verbose=0)
# demonstrate prediction
x_input = array([60, 70, 80, 90])
x_input = x_input.reshape((1, n_seq, 1, n_steps, n_features))
yhat = model.predict(x_input, verbose=0)
print(yhat)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-4">4</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-6">6</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-8">8</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-10">10</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-12">12</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-14">14</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-16">16</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-18">18</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-20">20</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-22">22</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-24">24</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-26">26</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-28">28</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-30">30</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-32">32</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-34">34</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-36">36</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-38">38</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-40">40</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-42">42</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-44">44</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f1574665130-46">46</div><div class="crayon-num" data-line="crayon-5d4518f5609f1574665130-47">47</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609f1574665130-1"><span class="crayon-p"># univariate convlstm example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">ConvLSTM2D</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-8">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-9"><span class="crayon-p"># split a univariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-10"><span class="crayon-e">def </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-11"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-12"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-13"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-14"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-15"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-16"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-17"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-18"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-19"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-20"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-21"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-22"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-24"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-25"><span class="crayon-v">raw_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-26"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-27"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-28"><span class="crayon-p"># split into samples</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-29"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">raw_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-30"><span class="crayon-p"># reshape from [samples, timesteps] into [samples, timesteps, rows, columns, features]</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-31"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-32"><span class="crayon-v">n_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-33"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-34"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-35"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-36"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-37"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">ConvLSTM2D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-38"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-39"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-40"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-41"><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-42"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">500</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-43"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-44"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-45"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f1574665130-46"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609f1574665130-47"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0041 seconds] -->
<p>Running the example predicts the next value in the sequence, which we expect would be 100.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609f4941218260" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[103.68166]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609f4941218260-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609f4941218260-1">[[103.68166]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Now that we have looked at LSTM models for univariate data, let’s turn our attention to multivariate data.</p>
<h2>Multivariate LSTM Models</h2>
<p>Multivariate time series data means data where there is more than one observation for each time step.</p>
<p>There are two main models that we may require with multivariate time series data; they are:</p>
<ol>
<li>Multiple Input Series.</li>
<li>Multiple Parallel Series.</li>
</ol>
<p>Let’s take a look at each in turn.</p>
<h3>Multiple Input Series</h3>
<p>A problem may have two or more parallel input time series and an output time series that is dependent on the input time series.</p>
<p>The input time series are parallel because each series has an observation at the same time steps.</p>
<p>We can demonstrate this with a simple example of two parallel input time series where the output series is the simple addition of the input series.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609f8365035599" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># define input sequence
in_seq1 = array([10, 20, 30, 40, 50, 60, 70, 80, 90])
in_seq2 = array([15, 25, 35, 45, 55, 65, 75, 85, 95])
out_seq = array([in_seq1[i]+in_seq2[i] for i in range(len(in_seq1))])</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609f8365035599-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f8365035599-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609f8365035599-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609f8365035599-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609f8365035599-1"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f8365035599-2"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609f8365035599-3"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609f8365035599-4"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>We can reshape these three arrays of data as a single dataset where each row is a time step, and each column is a separate time series. This is a standard way of storing parallel time series in a CSV file.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609fb685981241" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># convert to [rows, columns] structure
in_seq1 = in_seq1.reshape((len(in_seq1), 1))
in_seq2 = in_seq2.reshape((len(in_seq2), 1))
out_seq = out_seq.reshape((len(out_seq), 1))
# horizontally stack columns
dataset = hstack((in_seq1, in_seq2, out_seq))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609fb685981241-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609fb685981241-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609fb685981241-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609fb685981241-4">4</div><div class="crayon-num" data-line="crayon-5d4518f5609fb685981241-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609fb685981241-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609fb685981241-1"><span class="crayon-p"># convert to [rows, columns] structure</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609fb685981241-2"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq1</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609fb685981241-3"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609fb685981241-4"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609fb685981241-5"><span class="crayon-p"># horizontally stack columns</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609fb685981241-6"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f5609ff179785702" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># multivariate data preparation
from numpy import array
from numpy import hstack
# define input sequence
in_seq1 = array([10, 20, 30, 40, 50, 60, 70, 80, 90])
in_seq2 = array([15, 25, 35, 45, 55, 65, 75, 85, 95])
out_seq = array([in_seq1[i]+in_seq2[i] for i in range(len(in_seq1))])
# convert to [rows, columns] structure
in_seq1 = in_seq1.reshape((len(in_seq1), 1))
in_seq2 = in_seq2.reshape((len(in_seq2), 1))
out_seq = out_seq.reshape((len(out_seq), 1))
# horizontally stack columns
dataset = hstack((in_seq1, in_seq2, out_seq))
print(dataset)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f5609ff179785702-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609ff179785702-2">2</div><div class="crayon-num" data-line="crayon-5d4518f5609ff179785702-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609ff179785702-4">4</div><div class="crayon-num" data-line="crayon-5d4518f5609ff179785702-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609ff179785702-6">6</div><div class="crayon-num" data-line="crayon-5d4518f5609ff179785702-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609ff179785702-8">8</div><div class="crayon-num" data-line="crayon-5d4518f5609ff179785702-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609ff179785702-10">10</div><div class="crayon-num" data-line="crayon-5d4518f5609ff179785702-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609ff179785702-12">12</div><div class="crayon-num" data-line="crayon-5d4518f5609ff179785702-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f5609ff179785702-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f5609ff179785702-1"><span class="crayon-p"># multivariate data preparation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609ff179785702-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f5609ff179785702-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-v">hstack</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609ff179785702-4"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line" id="crayon-5d4518f5609ff179785702-5"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609ff179785702-6"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609ff179785702-7"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609ff179785702-8"><span class="crayon-p"># convert to [rows, columns] structure</span></div><div class="crayon-line" id="crayon-5d4518f5609ff179785702-9"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq1</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609ff179785702-10"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f5609ff179785702-11"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609ff179785702-12"><span class="crayon-p"># horizontally stack columns</span></div><div class="crayon-line" id="crayon-5d4518f5609ff179785702-13"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f5609ff179785702-14"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>Running the example prints the dataset with one row per time step and one column for each of the two input and one output parallel time series.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a03222141551" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[ 10  15  25]
 [ 20  25  45]
 [ 30  35  65]
 [ 40  45  85]
 [ 50  55 105]
 [ 60  65 125]
 [ 70  75 145]
 [ 80  85 165]
 [ 90  95 185]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a03222141551-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a03222141551-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a03222141551-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a03222141551-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a03222141551-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a03222141551-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a03222141551-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a03222141551-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a03222141551-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a03222141551-1">[[ 10&nbsp;&nbsp;15&nbsp;&nbsp;25]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a03222141551-2"> [ 20&nbsp;&nbsp;25&nbsp;&nbsp;45]</div><div class="crayon-line" id="crayon-5d4518f560a03222141551-3"> [ 30&nbsp;&nbsp;35&nbsp;&nbsp;65]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a03222141551-4"> [ 40&nbsp;&nbsp;45&nbsp;&nbsp;85]</div><div class="crayon-line" id="crayon-5d4518f560a03222141551-5"> [ 50&nbsp;&nbsp;55 105]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a03222141551-6"> [ 60&nbsp;&nbsp;65 125]</div><div class="crayon-line" id="crayon-5d4518f560a03222141551-7"> [ 70&nbsp;&nbsp;75 145]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a03222141551-8"> [ 80&nbsp;&nbsp;85 165]</div><div class="crayon-line" id="crayon-5d4518f560a03222141551-9"> [ 90&nbsp;&nbsp;95 185]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>As with the univariate time series, we must structure these data into samples with input and output elements.</p>
<p>An LSTM model needs sufficient context to learn a mapping from an input sequence to an output value. LSTMs can support parallel input time series as separate variables or features. Therefore, we need to split the data into samples maintaining the order of observations across the two input sequences.</p>
<p>If we chose three input time steps, then the first sample would look as follows:</p>
<p>Input:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a07973057699" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">10, 15
20, 25
30, 35</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a07973057699-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a07973057699-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a07973057699-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a07973057699-1">10, 15</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a07973057699-2">20, 25</div><div class="crayon-line" id="crayon-5d4518f560a07973057699-3">30, 35</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Output:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a0b707367851" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">65</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a0b707367851-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a0b707367851-1">65</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>That is, the first three time steps of each parallel series are provided as input to the model and the model associates this with the value in the output series at the third time step, in this case, 65.</p>
<p>We can see that, in transforming the time series into input/output samples to train the model, that we will have to discard some values from the output time series where we do not have values in the input time series at prior time steps. In turn, the choice of the size of the number of input time steps will have an important effect on how much of the training data is used.</p>
<p>We can define a function named <em>split_sequences()</em> that will take a dataset as we have defined it with rows for time steps and columns for parallel series and return input/output samples.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a0e257492622" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># split a multivariate sequence into samples
def split_sequences(sequences, n_steps):
	X, y = list(), list()
	for i in range(len(sequences)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the dataset
		if end_ix &gt; len(sequences):
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequences[i:end_ix, :-1], sequences[end_ix-1, -1]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a0e257492622-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a0e257492622-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a0e257492622-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a0e257492622-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a0e257492622-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a0e257492622-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a0e257492622-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a0e257492622-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a0e257492622-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a0e257492622-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560a0e257492622-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a0e257492622-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560a0e257492622-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a0e257492622-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a0e257492622-1"><span class="crayon-p"># split a multivariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a0e257492622-2"><span class="crayon-e">def </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a0e257492622-3"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a0e257492622-4"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a0e257492622-5"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a0e257492622-6"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line" id="crayon-5d4518f560a0e257492622-7"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a0e257492622-8"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a0e257492622-9"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a0e257492622-10"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line" id="crayon-5d4518f560a0e257492622-11"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a0e257492622-12"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a0e257492622-13"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a0e257492622-14"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>We can test this function on our dataset using three time steps for each input time series as input.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a11944120744" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># multivariate data preparation
from numpy import array
from numpy import hstack

# split a multivariate sequence into samples
def split_sequences(sequences, n_steps):
	X, y = list(), list()
	for i in range(len(sequences)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the dataset
		if end_ix &gt; len(sequences):
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequences[i:end_ix, :-1], sequences[end_ix-1, -1]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
in_seq1 = array([10, 20, 30, 40, 50, 60, 70, 80, 90])
in_seq2 = array([15, 25, 35, 45, 55, 65, 75, 85, 95])
out_seq = array([in_seq1[i]+in_seq2[i] for i in range(len(in_seq1))])
# convert to [rows, columns] structure
in_seq1 = in_seq1.reshape((len(in_seq1), 1))
in_seq2 = in_seq2.reshape((len(in_seq2), 1))
out_seq = out_seq.reshape((len(out_seq), 1))
# horizontally stack columns
dataset = hstack((in_seq1, in_seq2, out_seq))
# choose a number of time steps
n_steps = 3
# convert into input/output
X, y = split_sequences(dataset, n_steps)
print(X.shape, y.shape)
# summarize the data
for i in range(len(X)):
	print(X[i], y[i])</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-22">22</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-24">24</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-26">26</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-28">28</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-30">30</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-32">32</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-34">34</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a11944120744-36">36</div><div class="crayon-num" data-line="crayon-5d4518f560a11944120744-37">37</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a11944120744-1"><span class="crayon-p"># multivariate data preparation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-v">hstack</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-4">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560a11944120744-5"><span class="crayon-p"># split a multivariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-6"><span class="crayon-e">def </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-7"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-8"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-9"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-10"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-11"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-12"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-13"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-14"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-15"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-16"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-17"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-18"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-20"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-21"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-22"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-23"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-24"><span class="crayon-p"># convert to [rows, columns] structure</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-25"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq1</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-26"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-27"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-28"><span class="crayon-p"># horizontally stack columns</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-29"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-30"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-31"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-32"><span class="crayon-p"># convert into input/output</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-33"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-34"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-35"><span class="crayon-p"># summarize the data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a11944120744-36"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a11944120744-37"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0038 seconds] -->
<p>Running the example first prints the shape of the X and y components.</p>
<p>We can see that the X component has a three-dimensional structure.</p>
<p>The first dimension is the number of samples, in this case 7. The second dimension is the number of time steps per sample, in this case 3, the value specified to the function. Finally, the last dimension specifies the number of parallel time series or the number of variables, in this case 2 for the two parallel series.</p>
<p>This is the exact three-dimensional structure expected by an LSTM as input. The data is ready to use without further reshaping.</p>
<p>We can then see that the input and output for each sample is printed, showing the three time steps for each of the two input series and the associated output for each sample.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a15950931524" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">(7, 3, 2) (7,)

[[10 15]
 [20 25]
 [30 35]] 65
[[20 25]
 [30 35]
 [40 45]] 85
[[30 35]
 [40 45]
 [50 55]] 105
[[40 45]
 [50 55]
 [60 65]] 125
[[50 55]
 [60 65]
 [70 75]] 145
[[60 65]
 [70 75]
 [80 85]] 165
[[70 75]
 [80 85]
 [90 95]] 185</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a15950931524-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a15950931524-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a15950931524-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a15950931524-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a15950931524-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a15950931524-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a15950931524-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a15950931524-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a15950931524-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a15950931524-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560a15950931524-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a15950931524-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560a15950931524-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a15950931524-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560a15950931524-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a15950931524-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560a15950931524-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a15950931524-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560a15950931524-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a15950931524-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560a15950931524-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a15950931524-22">22</div><div class="crayon-num" data-line="crayon-5d4518f560a15950931524-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a15950931524-1">(7, 3, 2) (7,)</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a15950931524-2">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560a15950931524-3">[[10 15]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a15950931524-4"> [20 25]</div><div class="crayon-line" id="crayon-5d4518f560a15950931524-5"> [30 35]] 65</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a15950931524-6">[[20 25]</div><div class="crayon-line" id="crayon-5d4518f560a15950931524-7"> [30 35]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a15950931524-8"> [40 45]] 85</div><div class="crayon-line" id="crayon-5d4518f560a15950931524-9">[[30 35]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a15950931524-10"> [40 45]</div><div class="crayon-line" id="crayon-5d4518f560a15950931524-11"> [50 55]] 105</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a15950931524-12">[[40 45]</div><div class="crayon-line" id="crayon-5d4518f560a15950931524-13"> [50 55]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a15950931524-14"> [60 65]] 125</div><div class="crayon-line" id="crayon-5d4518f560a15950931524-15">[[50 55]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a15950931524-16"> [60 65]</div><div class="crayon-line" id="crayon-5d4518f560a15950931524-17"> [70 75]] 145</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a15950931524-18">[[60 65]</div><div class="crayon-line" id="crayon-5d4518f560a15950931524-19"> [70 75]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a15950931524-20"> [80 85]] 165</div><div class="crayon-line" id="crayon-5d4518f560a15950931524-21">[[70 75]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a15950931524-22"> [80 85]</div><div class="crayon-line" id="crayon-5d4518f560a15950931524-23"> [90 95]] 185</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We are now ready to fit an LSTM model on this data.</p>
<p>Any of the varieties of LSTMs in the previous section can be used, such as a Vanilla, Stacked, Bidirectional, CNN, or ConvLSTM model.</p>
<p>We will use a Vanilla LSTM where the number of time steps and parallel series (features) are specified for the input layer via the <em>input_shape</em> argument.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a19638172246" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># define model
model = Sequential()
model.add(LSTM(50, activation='relu', input_shape=(n_steps, n_features)))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a19638172246-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a19638172246-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a19638172246-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a19638172246-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a19638172246-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a19638172246-1"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a19638172246-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a19638172246-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a19638172246-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a19638172246-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>When making a prediction, the model expects three time steps for two input time series.</p>
<p>We can predict the next value in the output series providing the input values of:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a1c100656157" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">80,	 85
90,	 95
100, 105</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a1c100656157-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a1c100656157-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a1c100656157-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a1c100656157-1">80,	 85</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a1c100656157-2">90,	 95</div><div class="crayon-line" id="crayon-5d4518f560a1c100656157-3">100, 105</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The shape of the one sample with three time steps and two variables must be [1, 3, 2].</p>
<p>We would expect the next value in the sequence to be 100 + 105, or 205.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a20079003743" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># demonstrate prediction
x_input = array([[80, 85], [90, 95], [100, 105]])
x_input = x_input.reshape((1, n_steps, n_features))
yhat = model.predict(x_input, verbose=0)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a20079003743-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a20079003743-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a20079003743-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a20079003743-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a20079003743-1"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a20079003743-2"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">90</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">105</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a20079003743-3"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a20079003743-4"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a23323808236" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># multivariate lstm example
from numpy import array
from numpy import hstack
from keras.models import Sequential
from keras.layers import LSTM
from keras.layers import Dense

# split a multivariate sequence into samples
def split_sequences(sequences, n_steps):
	X, y = list(), list()
	for i in range(len(sequences)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the dataset
		if end_ix &gt; len(sequences):
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequences[i:end_ix, :-1], sequences[end_ix-1, -1]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
in_seq1 = array([10, 20, 30, 40, 50, 60, 70, 80, 90])
in_seq2 = array([15, 25, 35, 45, 55, 65, 75, 85, 95])
out_seq = array([in_seq1[i]+in_seq2[i] for i in range(len(in_seq1))])
# convert to [rows, columns] structure
in_seq1 = in_seq1.reshape((len(in_seq1), 1))
in_seq2 = in_seq2.reshape((len(in_seq2), 1))
out_seq = out_seq.reshape((len(out_seq), 1))
# horizontally stack columns
dataset = hstack((in_seq1, in_seq2, out_seq))
# choose a number of time steps
n_steps = 3
# convert into input/output
X, y = split_sequences(dataset, n_steps)
# the dataset knows the number of features, e.g. 2
n_features = X.shape[2]
# define model
model = Sequential()
model.add(LSTM(50, activation='relu', input_shape=(n_steps, n_features)))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')
# fit model
model.fit(X, y, epochs=200, verbose=0)
# demonstrate prediction
x_input = array([[80, 85], [90, 95], [100, 105]])
x_input = x_input.reshape((1, n_steps, n_features))
yhat = model.predict(x_input, verbose=0)
print(yhat)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-22">22</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-24">24</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-26">26</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-28">28</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-30">30</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-32">32</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-34">34</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-36">36</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-38">38</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-40">40</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-42">42</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-44">44</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-46">46</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-48">48</div><div class="crayon-num" data-line="crayon-5d4518f560a23323808236-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a23323808236-50">50</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a23323808236-1"><span class="crayon-p"># multivariate lstm example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">hstack</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Dense</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-8"><span class="crayon-p"># split a multivariate sequence into samples</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-9"><span class="crayon-e">def </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-10"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-11"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-12"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-13"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-14"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the dataset</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-15"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-16"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-17"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-18"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-19"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-20"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-21"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-22">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560a23323808236-23"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-24"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-25"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-26"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-27"><span class="crayon-p"># convert to [rows, columns] structure</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-28"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq1</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-29"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-30"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-31"><span class="crayon-p"># horizontally stack columns</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-32"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-33"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-34"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-35"><span class="crayon-p"># convert into input/output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-36"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-37"><span class="crayon-p"># the dataset knows the number of features, e.g. 2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-38"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-39"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-40"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-41"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-42"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-43"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-44"><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-45"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-46"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-47"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">90</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">105</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-48"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a23323808236-49"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a23323808236-50"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0050 seconds] -->
<p>Running the example prepares the data, fits the model, and makes a prediction.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a27177039999" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[208.13531]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a27177039999-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a27177039999-1">[[208.13531]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Multiple Parallel Series</h2>
<p>An alternate time series problem is the case where there are multiple parallel time series and a value must be predicted for each.</p>
<p>For example, given the data from the previous section:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a2a242161111" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[ 10  15  25]
 [ 20  25  45]
 [ 30  35  65]
 [ 40  45  85]
 [ 50  55 105]
 [ 60  65 125]
 [ 70  75 145]
 [ 80  85 165]
 [ 90  95 185]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a2a242161111-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a2a242161111-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a2a242161111-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a2a242161111-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a2a242161111-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a2a242161111-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a2a242161111-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a2a242161111-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a2a242161111-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a2a242161111-1">[[ 10&nbsp;&nbsp;15&nbsp;&nbsp;25]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a2a242161111-2"> [ 20&nbsp;&nbsp;25&nbsp;&nbsp;45]</div><div class="crayon-line" id="crayon-5d4518f560a2a242161111-3"> [ 30&nbsp;&nbsp;35&nbsp;&nbsp;65]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a2a242161111-4"> [ 40&nbsp;&nbsp;45&nbsp;&nbsp;85]</div><div class="crayon-line" id="crayon-5d4518f560a2a242161111-5"> [ 50&nbsp;&nbsp;55 105]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a2a242161111-6"> [ 60&nbsp;&nbsp;65 125]</div><div class="crayon-line" id="crayon-5d4518f560a2a242161111-7"> [ 70&nbsp;&nbsp;75 145]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a2a242161111-8"> [ 80&nbsp;&nbsp;85 165]</div><div class="crayon-line" id="crayon-5d4518f560a2a242161111-9"> [ 90&nbsp;&nbsp;95 185]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We may want to predict the value for each of the three time series for the next time step.</p>
<p>This might be referred to as multivariate forecasting.</p>
<p>Again, the data must be split into input/output samples in order to train a model.</p>
<p>The first sample of this dataset would be:</p>
<p>Input:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a2d299719993" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">10, 15, 25
20, 25, 45
30, 35, 65</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a2d299719993-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a2d299719993-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a2d299719993-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a2d299719993-1">10, 15, 25</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a2d299719993-2">20, 25, 45</div><div class="crayon-line" id="crayon-5d4518f560a2d299719993-3">30, 35, 65</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Output:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a31930274104" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">40, 45, 85</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a31930274104-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a31930274104-1">40, 45, 85</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The <em>split_sequences()</em> function below will split multiple parallel time series with rows for time steps and one series per column into the required input/output shape.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a33116507015" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># split a multivariate sequence into samples
def split_sequences(sequences, n_steps):
	X, y = list(), list()
	for i in range(len(sequences)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the dataset
		if end_ix &gt; len(sequences)-1:
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequences[i:end_ix, :], sequences[end_ix, :]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a33116507015-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a33116507015-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a33116507015-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a33116507015-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a33116507015-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a33116507015-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a33116507015-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a33116507015-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a33116507015-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a33116507015-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560a33116507015-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a33116507015-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560a33116507015-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a33116507015-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a33116507015-1"><span class="crayon-p"># split a multivariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a33116507015-2"><span class="crayon-e">def </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a33116507015-3"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a33116507015-4"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a33116507015-5"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a33116507015-6"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line" id="crayon-5d4518f560a33116507015-7"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a33116507015-8"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a33116507015-9"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a33116507015-10"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line" id="crayon-5d4518f560a33116507015-11"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a33116507015-12"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a33116507015-13"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a33116507015-14"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>We can demonstrate this on the contrived problem; the complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a37011951117" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># multivariate output data prep
from numpy import array
from numpy import hstack

# split a multivariate sequence into samples
def split_sequences(sequences, n_steps):
	X, y = list(), list()
	for i in range(len(sequences)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the dataset
		if end_ix &gt; len(sequences)-1:
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequences[i:end_ix, :], sequences[end_ix, :]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
in_seq1 = array([10, 20, 30, 40, 50, 60, 70, 80, 90])
in_seq2 = array([15, 25, 35, 45, 55, 65, 75, 85, 95])
out_seq = array([in_seq1[i]+in_seq2[i] for i in range(len(in_seq1))])
# convert to [rows, columns] structure
in_seq1 = in_seq1.reshape((len(in_seq1), 1))
in_seq2 = in_seq2.reshape((len(in_seq2), 1))
out_seq = out_seq.reshape((len(out_seq), 1))
# horizontally stack columns
dataset = hstack((in_seq1, in_seq2, out_seq))
# choose a number of time steps
n_steps = 3
# convert into input/output
X, y = split_sequences(dataset, n_steps)
print(X.shape, y.shape)
# summarize the data
for i in range(len(X)):
	print(X[i], y[i])</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-22">22</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-24">24</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-26">26</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-28">28</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-30">30</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-32">32</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-34">34</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a37011951117-36">36</div><div class="crayon-num" data-line="crayon-5d4518f560a37011951117-37">37</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a37011951117-1"><span class="crayon-p"># multivariate output data prep</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-v">hstack</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-4">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560a37011951117-5"><span class="crayon-p"># split a multivariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-6"><span class="crayon-e">def </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-7"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-8"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-9"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-10"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-11"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-12"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-13"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-14"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-15"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-16"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-17"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-18"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-20"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-21"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-22"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-23"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-24"><span class="crayon-p"># convert to [rows, columns] structure</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-25"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq1</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-26"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-27"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-28"><span class="crayon-p"># horizontally stack columns</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-29"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-30"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-31"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-32"><span class="crayon-p"># convert into input/output</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-33"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-34"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-35"><span class="crayon-p"># summarize the data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a37011951117-36"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a37011951117-37"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0038 seconds] -->
<p>Running the example first prints the shape of the prepared X and y components.</p>
<p>The shape of X is three-dimensional, including the number of samples (6), the number of time steps chosen per sample (3), and the number of parallel time series or features (3).</p>
<p>The shape of y is two-dimensional as we might expect for the number of samples (6) and the number of time variables per sample to be predicted (3).</p>
<p>The data is ready to use in an LSTM model that expects three-dimensional input and two-dimensional output shapes for the X and y components of each sample.</p>
<p>Then, each of the samples is printed showing the input and output components of each sample.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a3a733214796" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">(6, 3, 3) (6, 3)

[[10 15 25]
 [20 25 45]
 [30 35 65]] [40 45 85]
[[20 25 45]
 [30 35 65]
 [40 45 85]] [ 50  55 105]
[[ 30  35  65]
 [ 40  45  85]
 [ 50  55 105]] [ 60  65 125]
[[ 40  45  85]
 [ 50  55 105]
 [ 60  65 125]] [ 70  75 145]
[[ 50  55 105]
 [ 60  65 125]
 [ 70  75 145]] [ 80  85 165]
[[ 60  65 125]
 [ 70  75 145]
 [ 80  85 165]] [ 90  95 185]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a3a733214796-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a3a733214796-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a3a733214796-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a3a733214796-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a3a733214796-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a3a733214796-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a3a733214796-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a3a733214796-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a3a733214796-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a3a733214796-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560a3a733214796-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a3a733214796-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560a3a733214796-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a3a733214796-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560a3a733214796-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a3a733214796-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560a3a733214796-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a3a733214796-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560a3a733214796-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a3a733214796-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a3a733214796-1">(6, 3, 3) (6, 3)</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a3a733214796-2">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560a3a733214796-3">[[10 15 25]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a3a733214796-4"> [20 25 45]</div><div class="crayon-line" id="crayon-5d4518f560a3a733214796-5"> [30 35 65]] [40 45 85]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a3a733214796-6">[[20 25 45]</div><div class="crayon-line" id="crayon-5d4518f560a3a733214796-7"> [30 35 65]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a3a733214796-8"> [40 45 85]] [ 50&nbsp;&nbsp;55 105]</div><div class="crayon-line" id="crayon-5d4518f560a3a733214796-9">[[ 30&nbsp;&nbsp;35&nbsp;&nbsp;65]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a3a733214796-10"> [ 40&nbsp;&nbsp;45&nbsp;&nbsp;85]</div><div class="crayon-line" id="crayon-5d4518f560a3a733214796-11"> [ 50&nbsp;&nbsp;55 105]] [ 60&nbsp;&nbsp;65 125]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a3a733214796-12">[[ 40&nbsp;&nbsp;45&nbsp;&nbsp;85]</div><div class="crayon-line" id="crayon-5d4518f560a3a733214796-13"> [ 50&nbsp;&nbsp;55 105]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a3a733214796-14"> [ 60&nbsp;&nbsp;65 125]] [ 70&nbsp;&nbsp;75 145]</div><div class="crayon-line" id="crayon-5d4518f560a3a733214796-15">[[ 50&nbsp;&nbsp;55 105]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a3a733214796-16"> [ 60&nbsp;&nbsp;65 125]</div><div class="crayon-line" id="crayon-5d4518f560a3a733214796-17"> [ 70&nbsp;&nbsp;75 145]] [ 80&nbsp;&nbsp;85 165]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a3a733214796-18">[[ 60&nbsp;&nbsp;65 125]</div><div class="crayon-line" id="crayon-5d4518f560a3a733214796-19"> [ 70&nbsp;&nbsp;75 145]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a3a733214796-20"> [ 80&nbsp;&nbsp;85 165]] [ 90&nbsp;&nbsp;95 185]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We are now ready to fit an LSTM model on this data.</p>
<p>Any of the varieties of LSTMs in the previous section can be used, such as a Vanilla, Stacked, Bidirectional, CNN, or ConvLSTM model.</p>
<p>We will use a Stacked LSTM where the number of time steps and parallel series (features) are specified for the input layer via the <em>input_shape</em> argument. The number of parallel series is also used in the specification of the number of values to predict by the model in the output layer; again, this is three.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a3e597543919" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># define model
model = Sequential()
model.add(LSTM(100, activation='relu', return_sequences=True, input_shape=(n_steps, n_features)))
model.add(LSTM(100, activation='relu'))
model.add(Dense(n_features))
model.compile(optimizer='adam', loss='mse')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a3e597543919-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a3e597543919-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a3e597543919-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a3e597543919-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a3e597543919-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a3e597543919-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a3e597543919-1"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a3e597543919-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a3e597543919-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a3e597543919-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a3e597543919-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a3e597543919-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>We can predict the next value in each of the three parallel series by providing an input of three time steps for each series.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a41523256433" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">70, 75, 145
80, 85, 165
90, 95, 185</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a41523256433-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a41523256433-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a41523256433-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a41523256433-1">70, 75, 145</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a41523256433-2">80, 85, 165</div><div class="crayon-line" id="crayon-5d4518f560a41523256433-3">90, 95, 185</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The shape of the input for making a single prediction must be 1 sample, 3 time steps, and 3 features, or [1, 3, 3]</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a44108083438" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># demonstrate prediction
x_input = array([[70,75,145], [80,85,165], [90,95,185]])
x_input = x_input.reshape((1, n_steps, n_features))
yhat = model.predict(x_input, verbose=0)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a44108083438-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a44108083438-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a44108083438-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a44108083438-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a44108083438-1"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a44108083438-2"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-cn">145</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-cn">165</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">90</span><span class="crayon-sy">,</span><span class="crayon-cn">95</span><span class="crayon-sy">,</span><span class="crayon-cn">185</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a44108083438-3"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a44108083438-4"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>We would expect the vector output to be:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a47769931993" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[100, 105, 205]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a47769931993-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a47769931993-1">[100, 105, 205]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can tie all of this together and demonstrate a Stacked LSTM for multivariate output time series forecasting below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a4b467781262" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># multivariate output stacked lstm example
from numpy import array
from numpy import hstack
from keras.models import Sequential
from keras.layers import LSTM
from keras.layers import Dense

# split a multivariate sequence into samples
def split_sequences(sequences, n_steps):
	X, y = list(), list()
	for i in range(len(sequences)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the dataset
		if end_ix &gt; len(sequences)-1:
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequences[i:end_ix, :], sequences[end_ix, :]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
in_seq1 = array([10, 20, 30, 40, 50, 60, 70, 80, 90])
in_seq2 = array([15, 25, 35, 45, 55, 65, 75, 85, 95])
out_seq = array([in_seq1[i]+in_seq2[i] for i in range(len(in_seq1))])
# convert to [rows, columns] structure
in_seq1 = in_seq1.reshape((len(in_seq1), 1))
in_seq2 = in_seq2.reshape((len(in_seq2), 1))
out_seq = out_seq.reshape((len(out_seq), 1))
# horizontally stack columns
dataset = hstack((in_seq1, in_seq2, out_seq))
# choose a number of time steps
n_steps = 3
# convert into input/output
X, y = split_sequences(dataset, n_steps)
# the dataset knows the number of features, e.g. 2
n_features = X.shape[2]
# define model
model = Sequential()
model.add(LSTM(100, activation='relu', return_sequences=True, input_shape=(n_steps, n_features)))
model.add(LSTM(100, activation='relu'))
model.add(Dense(n_features))
model.compile(optimizer='adam', loss='mse')
# fit model
model.fit(X, y, epochs=400, verbose=0)
# demonstrate prediction
x_input = array([[70,75,145], [80,85,165], [90,95,185]])
x_input = x_input.reshape((1, n_steps, n_features))
yhat = model.predict(x_input, verbose=0)
print(yhat)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-22">22</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-24">24</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-26">26</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-28">28</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-30">30</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-32">32</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-34">34</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-36">36</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-38">38</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-40">40</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-42">42</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-44">44</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-46">46</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-48">48</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a4b467781262-50">50</div><div class="crayon-num" data-line="crayon-5d4518f560a4b467781262-51">51</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a4b467781262-1"><span class="crayon-p"># multivariate output stacked lstm example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">hstack</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Dense</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-8"><span class="crayon-p"># split a multivariate sequence into samples</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-9"><span class="crayon-e">def </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-10"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-11"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-12"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-13"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-14"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the dataset</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-15"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-16"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-17"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-18"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-19"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-20"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-21"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-22">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-23"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-24"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-25"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-26"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-27"><span class="crayon-p"># convert to [rows, columns] structure</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-28"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq1</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-29"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-30"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-31"><span class="crayon-p"># horizontally stack columns</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-32"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-33"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-34"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-35"><span class="crayon-p"># convert into input/output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-36"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-37"><span class="crayon-p"># the dataset knows the number of features, e.g. 2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-38"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-39"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-40"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-41"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-42"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-43"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-44"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-45"><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-46"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">400</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-47"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-48"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-cn">145</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-cn">165</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">90</span><span class="crayon-sy">,</span><span class="crayon-cn">95</span><span class="crayon-sy">,</span><span class="crayon-cn">185</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-49"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a4b467781262-50"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a4b467781262-51"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0052 seconds] -->
<p>Running the example prepares the data, fits the model, and makes a prediction.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a4e887762189" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[101.76599 108.730484 206.63577 ]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a4e887762189-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a4e887762189-1">[[101.76599 108.730484 206.63577 ]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Multi-Step LSTM Models</h2>
<p>A time series forecasting problem that requires a prediction of multiple time steps into the future can be referred to as multi-step time series forecasting.</p>
<p>Specifically, these are problems where the forecast horizon or interval is more than one time step.</p>
<p>There are two main types of LSTM models that can be used for multi-step forecasting; they are:</p>
<ol>
<li>Vector Output Model</li>
<li>Encoder-Decoder Model</li>
</ol>
<p>Before we look at these models, let’s first look at the preparation of data for multi-step forecasting.</p>
<h3>Data Preparation</h3>
<p>As with one-step forecasting, a time series used for multi-step time series forecasting must be split into samples with input and output components.</p>
<p>Both the input and output components will be comprised of multiple time steps and may or may not have the same number of steps.</p>
<p>For example, given the univariate time series:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a52437322915" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[10, 20, 30, 40, 50, 60, 70, 80, 90]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a52437322915-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a52437322915-1">[10, 20, 30, 40, 50, 60, 70, 80, 90]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We could use the last three time steps as input and forecast the next two time steps.</p>
<p>The first sample would look as follows:</p>
<p>Input:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a56158827915" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[10, 20, 30]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a56158827915-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a56158827915-1">[10, 20, 30]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Output:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a59994635294" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[40, 50]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a59994635294-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a59994635294-1">[40, 50]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The <em>split_sequence()</em> function below implements this behavior and will split a given univariate time series into samples with a specified number of input and output time steps.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a5c122661239" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># split a univariate sequence into samples
def split_sequence(sequence, n_steps_in, n_steps_out):
	X, y = list(), list()
	for i in range(len(sequence)):
		# find the end of this pattern
		end_ix = i + n_steps_in
		out_end_ix = end_ix + n_steps_out
		# check if we are beyond the sequence
		if out_end_ix &gt; len(sequence):
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequence[i:end_ix], sequence[end_ix:out_end_ix]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a5c122661239-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5c122661239-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a5c122661239-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5c122661239-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a5c122661239-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5c122661239-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a5c122661239-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5c122661239-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a5c122661239-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5c122661239-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560a5c122661239-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5c122661239-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560a5c122661239-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5c122661239-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560a5c122661239-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a5c122661239-1"><span class="crayon-p"># split a univariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5c122661239-2"><span class="crayon-e">def </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a5c122661239-3"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5c122661239-4"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a5c122661239-5"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5c122661239-6"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">n_steps_in</span></div><div class="crayon-line" id="crayon-5d4518f560a5c122661239-7"><span class="crayon-e">		</span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5c122661239-8"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the sequence</span></div><div class="crayon-line" id="crayon-5d4518f560a5c122661239-9"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5c122661239-10"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5d4518f560a5c122661239-11"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5c122661239-12"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-o">:</span><span class="crayon-v">out_end_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560a5c122661239-13"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5c122661239-14"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a5c122661239-15"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>We can demonstrate this function on the small contrived dataset.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a5f839318157" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># multi-step data preparation
from numpy import array

# split a univariate sequence into samples
def split_sequence(sequence, n_steps_in, n_steps_out):
	X, y = list(), list()
	for i in range(len(sequence)):
		# find the end of this pattern
		end_ix = i + n_steps_in
		out_end_ix = end_ix + n_steps_out
		# check if we are beyond the sequence
		if out_end_ix &gt; len(sequence):
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequence[i:end_ix], sequence[end_ix:out_end_ix]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
raw_seq = [10, 20, 30, 40, 50, 60, 70, 80, 90]
# choose a number of time steps
n_steps_in, n_steps_out = 3, 2
# split into samples
X, y = split_sequence(raw_seq, n_steps_in, n_steps_out)
# summarize the data
for i in range(len(X)):
	print(X[i], y[i])</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-22">22</div><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-24">24</div><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-26">26</div><div class="crayon-num" data-line="crayon-5d4518f560a5f839318157-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a5f839318157-28">28</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a5f839318157-1"><span class="crayon-p"># multi-step data preparation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f560a5f839318157-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-4"><span class="crayon-p"># split a univariate sequence into samples</span></div><div class="crayon-line" id="crayon-5d4518f560a5f839318157-5"><span class="crayon-e">def </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-6"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a5f839318157-7"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-8"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line" id="crayon-5d4518f560a5f839318157-9"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">n_steps_in</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-10"><span class="crayon-e">		</span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span></div><div class="crayon-line" id="crayon-5d4518f560a5f839318157-11"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-12"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a5f839318157-13"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-14"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line" id="crayon-5d4518f560a5f839318157-15"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-o">:</span><span class="crayon-v">out_end_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-16"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a5f839318157-17"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-18"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a5f839318157-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-20"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line" id="crayon-5d4518f560a5f839318157-21"><span class="crayon-v">raw_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-22"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line" id="crayon-5d4518f560a5f839318157-23"><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-24"><span class="crayon-p"># split into samples</span></div><div class="crayon-line" id="crayon-5d4518f560a5f839318157-25"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">raw_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-26"><span class="crayon-p"># summarize the data</span></div><div class="crayon-line" id="crayon-5d4518f560a5f839318157-27"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a5f839318157-28"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0024 seconds] -->
<p>Running the example splits the univariate series into input and output time steps and prints the input and output components of each.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a62477017634" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[10 20 30] [40 50]
[20 30 40] [50 60]
[30 40 50] [60 70]
[40 50 60] [70 80]
[50 60 70] [80 90]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a62477017634-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a62477017634-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a62477017634-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a62477017634-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a62477017634-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a62477017634-1">[10 20 30] [40 50]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a62477017634-2">[20 30 40] [50 60]</div><div class="crayon-line" id="crayon-5d4518f560a62477017634-3">[30 40 50] [60 70]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a62477017634-4">[40 50 60] [70 80]</div><div class="crayon-line" id="crayon-5d4518f560a62477017634-5">[50 60 70] [80 90]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Now that we know how to prepare data for multi-step forecasting, let’s look at some LSTM models that can learn this mapping.</p>
<h3>Vector Output Model</h3>
<p>Like other types of neural network models, the LSTM can output a vector directly that can be interpreted as a multi-step forecast.</p>
<p>This approach was seen in the previous section were one time step of each output time series was forecasted as a vector.</p>
<p>As with the LSTMs for univariate data in a prior section, the prepared samples must first be reshaped. The LSTM expects data to have a three-dimensional structure of [<em>samples, timesteps, features</em>], and in this case, we only have one feature so the reshape is straightforward.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a66860691169" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># reshape from [samples, timesteps] into [samples, timesteps, features]
n_features = 1
X = X.reshape((X.shape[0], X.shape[1], n_features))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a66860691169-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a66860691169-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a66860691169-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a66860691169-1"><span class="crayon-p"># reshape from [samples, timesteps] into [samples, timesteps, features]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a66860691169-2"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5d4518f560a66860691169-3"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>With the number of input and output steps specified in the <em>n_steps_in</em> and <em>n_steps_out</em> variables, we can define a multi-step time-series forecasting model.</p>
<p>Any of the presented LSTM model types could be used, such as Vanilla, Stacked, Bidirectional, CNN-LSTM, or ConvLSTM. Below defines a Stacked LSTM for multi-step forecasting.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a69948147758" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># define model
model = Sequential()
model.add(LSTM(100, activation='relu', return_sequences=True, input_shape=(n_steps_in, n_features)))
model.add(LSTM(100, activation='relu'))
model.add(Dense(n_steps_out))
model.compile(optimizer='adam', loss='mse')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a69948147758-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a69948147758-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a69948147758-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a69948147758-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a69948147758-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a69948147758-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a69948147758-1"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a69948147758-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a69948147758-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a69948147758-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a69948147758-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a69948147758-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>The model can make a prediction for a single sample. We can predict the next two steps beyond the end of the dataset by providing the input:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a6e638226737" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[70, 80, 90]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a6e638226737-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a6e638226737-1">[70, 80, 90]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We would expect the predicted output to be:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a71373293827" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[100, 110]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a71373293827-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a71373293827-1">[100, 110]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>As expected by the model, the shape of the single sample of input data when making the prediction must be [1, 3, 1] for the 1 sample, 3 time steps of the input, and the single feature.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a74822470723" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># demonstrate prediction
x_input = array([70, 80, 90])
x_input = x_input.reshape((1, n_steps_in, n_features))
yhat = model.predict(x_input, verbose=0)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a74822470723-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a74822470723-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a74822470723-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a74822470723-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a74822470723-1"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a74822470723-2"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a74822470723-3"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a74822470723-4"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Tying all of this together, the Stacked LSTM for multi-step forecasting with a univariate time series is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a77414361204" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># univariate multi-step vector-output stacked lstm example
from numpy import array
from keras.models import Sequential
from keras.layers import LSTM
from keras.layers import Dense

# split a univariate sequence into samples
def split_sequence(sequence, n_steps_in, n_steps_out):
	X, y = list(), list()
	for i in range(len(sequence)):
		# find the end of this pattern
		end_ix = i + n_steps_in
		out_end_ix = end_ix + n_steps_out
		# check if we are beyond the sequence
		if out_end_ix &gt; len(sequence):
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequence[i:end_ix], sequence[end_ix:out_end_ix]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
raw_seq = [10, 20, 30, 40, 50, 60, 70, 80, 90]
# choose a number of time steps
n_steps_in, n_steps_out = 3, 2
# split into samples
X, y = split_sequence(raw_seq, n_steps_in, n_steps_out)
# reshape from [samples, timesteps] into [samples, timesteps, features]
n_features = 1
X = X.reshape((X.shape[0], X.shape[1], n_features))
# define model
model = Sequential()
model.add(LSTM(100, activation='relu', return_sequences=True, input_shape=(n_steps_in, n_features)))
model.add(LSTM(100, activation='relu'))
model.add(Dense(n_steps_out))
model.compile(optimizer='adam', loss='mse')
# fit model
model.fit(X, y, epochs=50, verbose=0)
# demonstrate prediction
x_input = array([70, 80, 90])
x_input = x_input.reshape((1, n_steps_in, n_features))
yhat = model.predict(x_input, verbose=0)
print(yhat)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-22">22</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-24">24</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-26">26</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-28">28</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-30">30</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-32">32</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-34">34</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-36">36</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-38">38</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-40">40</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-42">42</div><div class="crayon-num" data-line="crayon-5d4518f560a77414361204-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a77414361204-44">44</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a77414361204-1"><span class="crayon-p"># univariate multi-step vector-output stacked lstm example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-6">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560a77414361204-7"><span class="crayon-p"># split a univariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-8"><span class="crayon-e">def </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-9"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-10"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-11"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-12"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">n_steps_in</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-13"><span class="crayon-e">		</span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-14"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the sequence</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-15"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-16"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-17"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-18"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-o">:</span><span class="crayon-v">out_end_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-19"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-20"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-21"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-22">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560a77414361204-23"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-24"><span class="crayon-v">raw_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-25"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-26"><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-27"><span class="crayon-p"># split into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-28"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">raw_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-29"><span class="crayon-p"># reshape from [samples, timesteps] into [samples, timesteps, features]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-30"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-31"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-32"><span class="crayon-p"># define model</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-33"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-34"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-35"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-36"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-37"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-38"><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-39"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-40"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-41"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-42"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a77414361204-43"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a77414361204-44"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0040 seconds] -->
<p>Running the example forecasts and prints the next two time steps in the sequence.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a7a001786878" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[100.98096 113.28924]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a7a001786878-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a7a001786878-1">[[100.98096 113.28924]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>Encoder-Decoder Model</h3>
<p>A model specifically developed for forecasting variable length output sequences is called the <a href="https://machinelearningmastery.com/encoder-decoder-long-short-term-memory-networks/">Encoder-Decoder LSTM</a>.</p>
<p>The model was designed for prediction problems where there are both input and output sequences, so-called sequence-to-sequence, or seq2seq problems, such as translating text from one language to another.</p>
<p>This model can be used for multi-step time series forecasting.</p>
<p>As its name suggests, the model is comprised of two sub-models: the encoder and the decoder.</p>
<p>The encoder is a model responsible for reading and interpreting the input sequence. The output of the encoder is a fixed length vector that represents the model’s interpretation of the sequence. The encoder is traditionally a Vanilla LSTM model, although other encoder models can be used such as Stacked, Bidirectional, and CNN models.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a7e652190427" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">model.add(LSTM(100, activation='relu', input_shape=(n_steps_in, n_features)))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a7e652190427-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a7e652190427-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The decoder uses the output of the encoder as an input.</p>
<p>First, the fixed-length output of the encoder is repeated, once for each required time step in the output sequence.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a81102037237" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">model.add(RepeatVector(n_steps_out))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a81102037237-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a81102037237-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">RepeatVector</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>This sequence is then provided to an LSTM decoder model. The model must output a value for each value in the output time step, which can be interpreted by a single output model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a84743729235" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">model.add(LSTM(100, activation='relu', return_sequences=True))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a84743729235-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a84743729235-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>We can use the same output layer or layers to make each one-step prediction in the output sequence. This can be achieved by wrapping the output part of the model in a <a href="https://machinelearningmastery.com/timedistributed-layer-for-long-short-term-memory-networks-in-python/">TimeDistributed wrapper</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a87637051983" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">model.add(TimeDistributed(Dense(1)))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a87637051983-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a87637051983-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">TimeDistributed</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The full definition for an Encoder-Decoder model for multi-step time series forecasting is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a8a607328374" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># define model
model = Sequential()
model.add(LSTM(100, activation='relu', input_shape=(n_steps_in, n_features)))
model.add(RepeatVector(n_steps_out))
model.add(LSTM(100, activation='relu', return_sequences=True))
model.add(TimeDistributed(Dense(1)))
model.compile(optimizer='adam', loss='mse')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a8a607328374-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a8a607328374-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a8a607328374-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a8a607328374-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a8a607328374-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a8a607328374-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a8a607328374-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a8a607328374-1"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a8a607328374-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a8a607328374-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a8a607328374-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">RepeatVector</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a8a607328374-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a8a607328374-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">TimeDistributed</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a8a607328374-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p>As with other LSTM models, the input data must be reshaped into the expected three-dimensional shape of [<em>samples, timesteps, features</em>].</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a8d440872852" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">X = X.reshape((X.shape[0], X.shape[1], n_features))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a8d440872852-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a8d440872852-1"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>In the case of the Encoder-Decoder model, the output, or y part, of the training dataset must also have this shape. This is because the model will predict a given number of time steps with a given number of features for each input sample.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a90991003748" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">y = y.reshape((y.shape[0], y.shape[1], n_features))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a90991003748-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a90991003748-1"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The complete example of an Encoder-Decoder LSTM for multi-step time series forecasting is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a94242355305" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># univariate multi-step encoder-decoder lstm example
from numpy import array
from keras.models import Sequential
from keras.layers import LSTM
from keras.layers import Dense
from keras.layers import RepeatVector
from keras.layers import TimeDistributed

# split a univariate sequence into samples
def split_sequence(sequence, n_steps_in, n_steps_out):
	X, y = list(), list()
	for i in range(len(sequence)):
		# find the end of this pattern
		end_ix = i + n_steps_in
		out_end_ix = end_ix + n_steps_out
		# check if we are beyond the sequence
		if out_end_ix &gt; len(sequence):
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequence[i:end_ix], sequence[end_ix:out_end_ix]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
raw_seq = [10, 20, 30, 40, 50, 60, 70, 80, 90]
# choose a number of time steps
n_steps_in, n_steps_out = 3, 2
# split into samples
X, y = split_sequence(raw_seq, n_steps_in, n_steps_out)
# reshape from [samples, timesteps] into [samples, timesteps, features]
n_features = 1
X = X.reshape((X.shape[0], X.shape[1], n_features))
y = y.reshape((y.shape[0], y.shape[1], n_features))
# define model
model = Sequential()
model.add(LSTM(100, activation='relu', input_shape=(n_steps_in, n_features)))
model.add(RepeatVector(n_steps_out))
model.add(LSTM(100, activation='relu', return_sequences=True))
model.add(TimeDistributed(Dense(1)))
model.compile(optimizer='adam', loss='mse')
# fit model
model.fit(X, y, epochs=100, verbose=0)
# demonstrate prediction
x_input = array([70, 80, 90])
x_input = x_input.reshape((1, n_steps_in, n_features))
yhat = model.predict(x_input, verbose=0)
print(yhat)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-22">22</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-24">24</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-26">26</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-28">28</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-30">30</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-32">32</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-34">34</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-36">36</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-38">38</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-40">40</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-42">42</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-44">44</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-46">46</div><div class="crayon-num" data-line="crayon-5d4518f560a94242355305-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a94242355305-48">48</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a94242355305-1"><span class="crayon-p"># univariate multi-step encoder-decoder lstm example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">RepeatVector</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">TimeDistributed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-8">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560a94242355305-9"><span class="crayon-p"># split a univariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-10"><span class="crayon-e">def </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-11"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-12"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-13"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-14"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">n_steps_in</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-15"><span class="crayon-e">		</span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-16"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the sequence</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-17"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-18"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-19"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-20"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-o">:</span><span class="crayon-v">out_end_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-21"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-22"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-23"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-24">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560a94242355305-25"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-26"><span class="crayon-v">raw_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-27"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-28"><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-29"><span class="crayon-p"># split into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-30"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">raw_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-31"><span class="crayon-p"># reshape from [samples, timesteps] into [samples, timesteps, features]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-32"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-33"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-34"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-35"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-36"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-37"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-38"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">RepeatVector</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-39"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-40"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">TimeDistributed</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-41"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-42"><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-43"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-44"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-45"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-46"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560a94242355305-47"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a94242355305-48"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0045 seconds] -->
<p>Running the example forecasts and prints the next two time steps in the sequence.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a97999441882" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[[101.9736  
  [116.213615]]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a97999441882-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a97999441882-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a97999441882-1">[[[101.9736&nbsp;&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a97999441882-2">&nbsp;&nbsp;[116.213615]]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Multivariate Multi-Step LSTM Models</h2>
<p>In the previous sections, we have looked at univariate, multivariate, and multi-step time series forecasting.</p>
<p>It is possible to mix and match the different types of LSTM models presented so far for the different problems. This too applies to time series forecasting problems that involve multivariate and multi-step forecasting, but it may be a little more challenging.</p>
<p>In this section, we will provide short examples of data preparation and modeling for multivariate multi-step time series forecasting as a template to ease this challenge, specifically:</p>
<ol>
<li>Multiple Input Multi-Step Output.</li>
<li>Multiple Parallel Input and Multi-Step Output.</li>
</ol>
<p>Perhaps the biggest stumbling block is in the preparation of data, so this is where we will focus our attention.</p>
<h3>Multiple Input Multi-Step Output</h3>
<p>There are those multivariate time series forecasting problems where the output series is separate but dependent upon the input time series, and multiple time steps are required for the output series.</p>
<p>For example, consider our multivariate time series from a prior section:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a9b252763110" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[ 10  15  25]
 [ 20  25  45]
 [ 30  35  65]
 [ 40  45  85]
 [ 50  55 105]
 [ 60  65 125]
 [ 70  75 145]
 [ 80  85 165]
 [ 90  95 185]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a9b252763110-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a9b252763110-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a9b252763110-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a9b252763110-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560a9b252763110-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a9b252763110-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560a9b252763110-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a9b252763110-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560a9b252763110-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a9b252763110-1">[[ 10&nbsp;&nbsp;15&nbsp;&nbsp;25]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a9b252763110-2"> [ 20&nbsp;&nbsp;25&nbsp;&nbsp;45]</div><div class="crayon-line" id="crayon-5d4518f560a9b252763110-3"> [ 30&nbsp;&nbsp;35&nbsp;&nbsp;65]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a9b252763110-4"> [ 40&nbsp;&nbsp;45&nbsp;&nbsp;85]</div><div class="crayon-line" id="crayon-5d4518f560a9b252763110-5"> [ 50&nbsp;&nbsp;55 105]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a9b252763110-6"> [ 60&nbsp;&nbsp;65 125]</div><div class="crayon-line" id="crayon-5d4518f560a9b252763110-7"> [ 70&nbsp;&nbsp;75 145]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a9b252763110-8"> [ 80&nbsp;&nbsp;85 165]</div><div class="crayon-line" id="crayon-5d4518f560a9b252763110-9"> [ 90&nbsp;&nbsp;95 185]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We may use three prior time steps of each of the two input time series to predict two time steps of the output time series.</p>
<p>Input:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560a9e421951950" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">10, 15
20, 25
30, 35</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560a9e421951950-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560a9e421951950-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560a9e421951950-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560a9e421951950-1">10, 15</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560a9e421951950-2">20, 25</div><div class="crayon-line" id="crayon-5d4518f560a9e421951950-3">30, 35</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Output:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560aa1766099515" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">65
85</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560aa1766099515-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa1766099515-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560aa1766099515-1">65</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa1766099515-2">85</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The <em>split_sequences()</em> function below implements this behavior.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560aa4986157263" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># split a multivariate sequence into samples
def split_sequences(sequences, n_steps_in, n_steps_out):
	X, y = list(), list()
	for i in range(len(sequences)):
		# find the end of this pattern
		end_ix = i + n_steps_in
		out_end_ix = end_ix + n_steps_out-1
		# check if we are beyond the dataset
		if out_end_ix &gt; len(sequences):
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequences[i:end_ix, :-1], sequences[end_ix-1:out_end_ix, -1]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560aa4986157263-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa4986157263-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560aa4986157263-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa4986157263-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560aa4986157263-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa4986157263-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560aa4986157263-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa4986157263-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560aa4986157263-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa4986157263-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560aa4986157263-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa4986157263-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560aa4986157263-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa4986157263-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560aa4986157263-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560aa4986157263-1"><span class="crayon-p"># split a multivariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa4986157263-2"><span class="crayon-e">def </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560aa4986157263-3"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa4986157263-4"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560aa4986157263-5"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa4986157263-6"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">n_steps_in</span></div><div class="crayon-line" id="crayon-5d4518f560aa4986157263-7"><span class="crayon-e">		</span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa4986157263-8"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the dataset</span></div><div class="crayon-line" id="crayon-5d4518f560aa4986157263-9"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa4986157263-10"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5d4518f560aa4986157263-11"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa4986157263-12"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-v">out_end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560aa4986157263-13"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa4986157263-14"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aa4986157263-15"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>We can demonstrate this on our contrived dataset.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560aa7715708509" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># multivariate multi-step data preparation
from numpy import array
from numpy import hstack

# split a multivariate sequence into samples
def split_sequences(sequences, n_steps_in, n_steps_out):
	X, y = list(), list()
	for i in range(len(sequences)):
		# find the end of this pattern
		end_ix = i + n_steps_in
		out_end_ix = end_ix + n_steps_out-1
		# check if we are beyond the dataset
		if out_end_ix &gt; len(sequences):
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequences[i:end_ix, :-1], sequences[end_ix-1:out_end_ix, -1]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
in_seq1 = array([10, 20, 30, 40, 50, 60, 70, 80, 90])
in_seq2 = array([15, 25, 35, 45, 55, 65, 75, 85, 95])
out_seq = array([in_seq1[i]+in_seq2[i] for i in range(len(in_seq1))])
# convert to [rows, columns] structure
in_seq1 = in_seq1.reshape((len(in_seq1), 1))
in_seq2 = in_seq2.reshape((len(in_seq2), 1))
out_seq = out_seq.reshape((len(out_seq), 1))
# horizontally stack columns
dataset = hstack((in_seq1, in_seq2, out_seq))
# choose a number of time steps
n_steps_in, n_steps_out = 3, 2
# covert into input/output
X, y = split_sequences(dataset, n_steps_in, n_steps_out)
print(X.shape, y.shape)
# summarize the data
for i in range(len(X)):
	print(X[i], y[i])</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-22">22</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-24">24</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-26">26</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-28">28</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-30">30</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-32">32</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-34">34</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-36">36</div><div class="crayon-num" data-line="crayon-5d4518f560aa7715708509-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aa7715708509-38">38</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560aa7715708509-1"><span class="crayon-p"># multivariate multi-step data preparation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-v">hstack</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-4">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-5"><span class="crayon-p"># split a multivariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-6"><span class="crayon-e">def </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-7"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-8"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-9"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-10"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">n_steps_in</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-11"><span class="crayon-e">		</span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-12"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the dataset</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-13"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-14"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-15"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-16"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-v">out_end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-17"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-18"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-19"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-20">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-21"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-22"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-23"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-24"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-25"><span class="crayon-p"># convert to [rows, columns] structure</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-26"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq1</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-27"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-28"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-29"><span class="crayon-p"># horizontally stack columns</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-30"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-31"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-32"><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-33"><span class="crayon-p"># covert into input/output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-34"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-35"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-36"><span class="crayon-p"># summarize the data</span></div><div class="crayon-line" id="crayon-5d4518f560aa7715708509-37"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aa7715708509-38"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0041 seconds] -->
<p>Running the example first prints the shape of the prepared training data.</p>
<p>We can see that the shape of the input portion of the samples is three-dimensional, comprised of six samples, with three time steps, and two variables for the 2 input time series.</p>
<p>The output portion of the samples is two-dimensional for the six samples and the two time steps for each sample to be predicted.</p>
<p>The prepared samples are then printed to confirm that the data was prepared as we specified.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560aab770633084" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">(6, 3, 2) (6, 2)

[[10 15]
 [20 25]
 [30 35]] [65 85]
[[20 25]
 [30 35]
 [40 45]] [ 85 105]
[[30 35]
 [40 45]
 [50 55]] [105 125]
[[40 45]
 [50 55]
 [60 65]] [125 145]
[[50 55]
 [60 65]
 [70 75]] [145 165]
[[60 65]
 [70 75]
 [80 85]] [165 185]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560aab770633084-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aab770633084-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560aab770633084-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aab770633084-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560aab770633084-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aab770633084-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560aab770633084-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aab770633084-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560aab770633084-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aab770633084-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560aab770633084-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aab770633084-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560aab770633084-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aab770633084-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560aab770633084-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aab770633084-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560aab770633084-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aab770633084-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560aab770633084-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aab770633084-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560aab770633084-1">(6, 3, 2) (6, 2)</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aab770633084-2">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560aab770633084-3">[[10 15]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aab770633084-4"> [20 25]</div><div class="crayon-line" id="crayon-5d4518f560aab770633084-5"> [30 35]] [65 85]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aab770633084-6">[[20 25]</div><div class="crayon-line" id="crayon-5d4518f560aab770633084-7"> [30 35]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aab770633084-8"> [40 45]] [ 85 105]</div><div class="crayon-line" id="crayon-5d4518f560aab770633084-9">[[30 35]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aab770633084-10"> [40 45]</div><div class="crayon-line" id="crayon-5d4518f560aab770633084-11"> [50 55]] [105 125]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aab770633084-12">[[40 45]</div><div class="crayon-line" id="crayon-5d4518f560aab770633084-13"> [50 55]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aab770633084-14"> [60 65]] [125 145]</div><div class="crayon-line" id="crayon-5d4518f560aab770633084-15">[[50 55]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aab770633084-16"> [60 65]</div><div class="crayon-line" id="crayon-5d4518f560aab770633084-17"> [70 75]] [145 165]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aab770633084-18">[[60 65]</div><div class="crayon-line" id="crayon-5d4518f560aab770633084-19"> [70 75]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aab770633084-20"> [80 85]] [165 185]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can now develop an LSTM model for multi-step predictions.</p>
<p>A vector output or an encoder-decoder model could be used. In this case, we will demonstrate a vector output with a Stacked LSTM.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560aaf804171299" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># multivariate multi-step stacked lstm example
from numpy import array
from numpy import hstack
from keras.models import Sequential
from keras.layers import LSTM
from keras.layers import Dense

# split a multivariate sequence into samples
def split_sequences(sequences, n_steps_in, n_steps_out):
	X, y = list(), list()
	for i in range(len(sequences)):
		# find the end of this pattern
		end_ix = i + n_steps_in
		out_end_ix = end_ix + n_steps_out-1
		# check if we are beyond the dataset
		if out_end_ix &gt; len(sequences):
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequences[i:end_ix, :-1], sequences[end_ix-1:out_end_ix, -1]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
in_seq1 = array([10, 20, 30, 40, 50, 60, 70, 80, 90])
in_seq2 = array([15, 25, 35, 45, 55, 65, 75, 85, 95])
out_seq = array([in_seq1[i]+in_seq2[i] for i in range(len(in_seq1))])
# convert to [rows, columns] structure
in_seq1 = in_seq1.reshape((len(in_seq1), 1))
in_seq2 = in_seq2.reshape((len(in_seq2), 1))
out_seq = out_seq.reshape((len(out_seq), 1))
# horizontally stack columns
dataset = hstack((in_seq1, in_seq2, out_seq))
# choose a number of time steps
n_steps_in, n_steps_out = 3, 2
# covert into input/output
X, y = split_sequences(dataset, n_steps_in, n_steps_out)
# the dataset knows the number of features, e.g. 2
n_features = X.shape[2]
# define model
model = Sequential()
model.add(LSTM(100, activation='relu', return_sequences=True, input_shape=(n_steps_in, n_features)))
model.add(LSTM(100, activation='relu'))
model.add(Dense(n_steps_out))
model.compile(optimizer='adam', loss='mse')
# fit model
model.fit(X, y, epochs=200, verbose=0)
# demonstrate prediction
x_input = array([[70, 75], [80, 85], [90, 95]])
x_input = x_input.reshape((1, n_steps_in, n_features))
yhat = model.predict(x_input, verbose=0)
print(yhat)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-22">22</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-24">24</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-26">26</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-28">28</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-30">30</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-32">32</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-34">34</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-36">36</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-38">38</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-40">40</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-42">42</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-44">44</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-46">46</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-48">48</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-50">50</div><div class="crayon-num" data-line="crayon-5d4518f560aaf804171299-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aaf804171299-52">52</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560aaf804171299-1"><span class="crayon-p"># multivariate multi-step stacked lstm example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">hstack</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Dense</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-8"><span class="crayon-p"># split a multivariate sequence into samples</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-9"><span class="crayon-e">def </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-10"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-11"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-12"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-13"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">n_steps_in</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-14"><span class="crayon-e">		</span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-15"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-16"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-17"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-18"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-19"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-v">out_end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-20"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-21"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-22"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-24"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-25"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-26"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-27"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-28"><span class="crayon-p"># convert to [rows, columns] structure</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-29"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq1</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-30"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-31"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-32"><span class="crayon-p"># horizontally stack columns</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-33"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-34"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-35"><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-36"><span class="crayon-p"># covert into input/output</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-37"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-38"><span class="crayon-p"># the dataset knows the number of features, e.g. 2</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-39"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-40"><span class="crayon-p"># define model</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-41"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-42"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-43"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-44"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-45"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-46"><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-47"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-48"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-49"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">90</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-50"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aaf804171299-51"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aaf804171299-52"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0055 seconds] -->
<p>Running the example fits the model and predicts the next two time steps of the output sequence beyond the dataset.</p>
<p>We would expect the next two steps to be: [185, 205]</p>
<p>It is a challenging framing of the problem with very little data, and the arbitrarily configured version of the model gets close.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560ab2599122178" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[188.70619 210.16513]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560ab2599122178-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560ab2599122178-1">[[188.70619 210.16513]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>Multiple Parallel Input and Multi-Step Output</h3>
<p>A problem with parallel time series may require the prediction of multiple time steps of each time series.</p>
<p>For example, consider our multivariate time series from a prior section:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560ab5483683037" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[ 10  15  25]
 [ 20  25  45]
 [ 30  35  65]
 [ 40  45  85]
 [ 50  55 105]
 [ 60  65 125]
 [ 70  75 145]
 [ 80  85 165]
 [ 90  95 185]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560ab5483683037-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ab5483683037-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560ab5483683037-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ab5483683037-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560ab5483683037-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ab5483683037-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560ab5483683037-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ab5483683037-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560ab5483683037-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560ab5483683037-1">[[ 10&nbsp;&nbsp;15&nbsp;&nbsp;25]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ab5483683037-2"> [ 20&nbsp;&nbsp;25&nbsp;&nbsp;45]</div><div class="crayon-line" id="crayon-5d4518f560ab5483683037-3"> [ 30&nbsp;&nbsp;35&nbsp;&nbsp;65]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ab5483683037-4"> [ 40&nbsp;&nbsp;45&nbsp;&nbsp;85]</div><div class="crayon-line" id="crayon-5d4518f560ab5483683037-5"> [ 50&nbsp;&nbsp;55 105]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ab5483683037-6"> [ 60&nbsp;&nbsp;65 125]</div><div class="crayon-line" id="crayon-5d4518f560ab5483683037-7"> [ 70&nbsp;&nbsp;75 145]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ab5483683037-8"> [ 80&nbsp;&nbsp;85 165]</div><div class="crayon-line" id="crayon-5d4518f560ab5483683037-9"> [ 90&nbsp;&nbsp;95 185]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We may use the last three time steps from each of the three time series as input to the model and predict the next time steps of each of the three time series as output.</p>
<p>The first sample in the training dataset would be the following.</p>
<p>Input:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560ab9195451903" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">10, 15, 25
20, 25, 45
30, 35, 65</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560ab9195451903-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ab9195451903-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560ab9195451903-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560ab9195451903-1">10, 15, 25</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ab9195451903-2">20, 25, 45</div><div class="crayon-line" id="crayon-5d4518f560ab9195451903-3">30, 35, 65</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Output:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560abd925860637" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">40, 45, 85
50, 55, 105</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560abd925860637-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560abd925860637-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560abd925860637-1">40, 45, 85</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560abd925860637-2">50, 55, 105</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The <em>split_sequences()</em> function below implements this behavior.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560ac0013849765" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># split a multivariate sequence into samples
def split_sequences(sequences, n_steps_in, n_steps_out):
	X, y = list(), list()
	for i in range(len(sequences)):
		# find the end of this pattern
		end_ix = i + n_steps_in
		out_end_ix = end_ix + n_steps_out
		# check if we are beyond the dataset
		if out_end_ix &gt; len(sequences):
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequences[i:end_ix, :], sequences[end_ix:out_end_ix, :]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560ac0013849765-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac0013849765-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560ac0013849765-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac0013849765-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560ac0013849765-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac0013849765-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560ac0013849765-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac0013849765-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560ac0013849765-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac0013849765-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560ac0013849765-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac0013849765-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560ac0013849765-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac0013849765-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560ac0013849765-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560ac0013849765-1"><span class="crayon-p"># split a multivariate sequence into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac0013849765-2"><span class="crayon-e">def </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560ac0013849765-3"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac0013849765-4"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560ac0013849765-5"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac0013849765-6"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">n_steps_in</span></div><div class="crayon-line" id="crayon-5d4518f560ac0013849765-7"><span class="crayon-e">		</span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac0013849765-8"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the dataset</span></div><div class="crayon-line" id="crayon-5d4518f560ac0013849765-9"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac0013849765-10"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5d4518f560ac0013849765-11"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac0013849765-12"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-o">:</span><span class="crayon-v">out_end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f560ac0013849765-13"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac0013849765-14"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560ac0013849765-15"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>We can demonstrate this function on the small contrived dataset.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560ac3592714028" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># multivariate multi-step data preparation
from numpy import array
from numpy import hstack
from keras.models import Sequential
from keras.layers import LSTM
from keras.layers import Dense
from keras.layers import RepeatVector
from keras.layers import TimeDistributed

# split a multivariate sequence into samples
def split_sequences(sequences, n_steps_in, n_steps_out):
	X, y = list(), list()
	for i in range(len(sequences)):
		# find the end of this pattern
		end_ix = i + n_steps_in
		out_end_ix = end_ix + n_steps_out
		# check if we are beyond the dataset
		if out_end_ix &gt; len(sequences):
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequences[i:end_ix, :], sequences[end_ix:out_end_ix, :]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
in_seq1 = array([10, 20, 30, 40, 50, 60, 70, 80, 90])
in_seq2 = array([15, 25, 35, 45, 55, 65, 75, 85, 95])
out_seq = array([in_seq1[i]+in_seq2[i] for i in range(len(in_seq1))])
# convert to [rows, columns] structure
in_seq1 = in_seq1.reshape((len(in_seq1), 1))
in_seq2 = in_seq2.reshape((len(in_seq2), 1))
out_seq = out_seq.reshape((len(out_seq), 1))
# horizontally stack columns
dataset = hstack((in_seq1, in_seq2, out_seq))
# choose a number of time steps
n_steps_in, n_steps_out = 3, 2
# covert into input/output
X, y = split_sequences(dataset, n_steps_in, n_steps_out)
print(X.shape, y.shape)
# summarize the data
for i in range(len(X)):
	print(X[i], y[i])</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-22">22</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-24">24</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-26">26</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-28">28</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-30">30</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-32">32</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-34">34</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-36">36</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-38">38</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-40">40</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac3592714028-42">42</div><div class="crayon-num" data-line="crayon-5d4518f560ac3592714028-43">43</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560ac3592714028-1"><span class="crayon-p"># multivariate multi-step data preparation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">hstack</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">RepeatVector</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">TimeDistributed</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-10"><span class="crayon-p"># split a multivariate sequence into samples</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-11"><span class="crayon-e">def </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-12"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-13"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-14"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-15"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">n_steps_in</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-16"><span class="crayon-e">		</span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-17"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-18"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-19"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-20"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-21"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-o">:</span><span class="crayon-v">out_end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-22"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-23"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-24"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-26"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-27"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-28"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-29"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-30"><span class="crayon-p"># convert to [rows, columns] structure</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-31"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq1</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-32"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-33"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-34"><span class="crayon-p"># horizontally stack columns</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-35"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-36"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-37"><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-38"><span class="crayon-p"># covert into input/output</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-39"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-40"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-41"><span class="crayon-p"># summarize the data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac3592714028-42"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560ac3592714028-43"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0042 seconds] -->
<p>Running the example first prints the shape of the prepared training dataset.</p>
<p>We can see that both the input (X) and output (Y) elements of the dataset are three dimensional for the number of samples, time steps, and variables or parallel time series respectively.</p>
<p>The input and output elements of each series are then printed side by side so that we can confirm that the data was prepared as we expected.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560ac6856521305" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">(5, 3, 3) (5, 2, 3)

[[10 15 25]
 [20 25 45]
 [30 35 65]] [[ 40  45  85]
 [ 50  55 105]]
[[20 25 45]
 [30 35 65]
 [40 45 85]] [[ 50  55 105]
 [ 60  65 125]]
[[ 30  35  65]
 [ 40  45  85]
 [ 50  55 105]] [[ 60  65 125]
 [ 70  75 145]]
[[ 40  45  85]
 [ 50  55 105]
 [ 60  65 125]] [[ 70  75 145]
 [ 80  85 165]]
[[ 50  55 105]
 [ 60  65 125]
 [ 70  75 145]] [[ 80  85 165]
 [ 90  95 185]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560ac6856521305-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac6856521305-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560ac6856521305-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac6856521305-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560ac6856521305-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac6856521305-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560ac6856521305-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac6856521305-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560ac6856521305-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac6856521305-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560ac6856521305-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac6856521305-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560ac6856521305-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac6856521305-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560ac6856521305-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac6856521305-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560ac6856521305-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac6856521305-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560ac6856521305-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac6856521305-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560ac6856521305-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ac6856521305-22">22</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560ac6856521305-1">(5, 3, 3) (5, 2, 3)</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac6856521305-2">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f560ac6856521305-3">[[10 15 25]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac6856521305-4"> [20 25 45]</div><div class="crayon-line" id="crayon-5d4518f560ac6856521305-5"> [30 35 65]] [[ 40&nbsp;&nbsp;45&nbsp;&nbsp;85]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac6856521305-6"> [ 50&nbsp;&nbsp;55 105]]</div><div class="crayon-line" id="crayon-5d4518f560ac6856521305-7">[[20 25 45]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac6856521305-8"> [30 35 65]</div><div class="crayon-line" id="crayon-5d4518f560ac6856521305-9"> [40 45 85]] [[ 50&nbsp;&nbsp;55 105]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac6856521305-10"> [ 60&nbsp;&nbsp;65 125]]</div><div class="crayon-line" id="crayon-5d4518f560ac6856521305-11">[[ 30&nbsp;&nbsp;35&nbsp;&nbsp;65]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac6856521305-12"> [ 40&nbsp;&nbsp;45&nbsp;&nbsp;85]</div><div class="crayon-line" id="crayon-5d4518f560ac6856521305-13"> [ 50&nbsp;&nbsp;55 105]] [[ 60&nbsp;&nbsp;65 125]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac6856521305-14"> [ 70&nbsp;&nbsp;75 145]]</div><div class="crayon-line" id="crayon-5d4518f560ac6856521305-15">[[ 40&nbsp;&nbsp;45&nbsp;&nbsp;85]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac6856521305-16"> [ 50&nbsp;&nbsp;55 105]</div><div class="crayon-line" id="crayon-5d4518f560ac6856521305-17"> [ 60&nbsp;&nbsp;65 125]] [[ 70&nbsp;&nbsp;75 145]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac6856521305-18"> [ 80&nbsp;&nbsp;85 165]]</div><div class="crayon-line" id="crayon-5d4518f560ac6856521305-19">[[ 50&nbsp;&nbsp;55 105]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac6856521305-20"> [ 60&nbsp;&nbsp;65 125]</div><div class="crayon-line" id="crayon-5d4518f560ac6856521305-21"> [ 70&nbsp;&nbsp;75 145]] [[ 80&nbsp;&nbsp;85 165]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ac6856521305-22"> [ 90&nbsp;&nbsp;95 185]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can use either the Vector Output or Encoder-Decoder LSTM to model this problem. In this case, we will use the Encoder-Decoder model.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560aca538841777" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># multivariate multi-step encoder-decoder lstm example
from numpy import array
from numpy import hstack
from keras.models import Sequential
from keras.layers import LSTM
from keras.layers import Dense
from keras.layers import RepeatVector
from keras.layers import TimeDistributed

# split a multivariate sequence into samples
def split_sequences(sequences, n_steps_in, n_steps_out):
	X, y = list(), list()
	for i in range(len(sequences)):
		# find the end of this pattern
		end_ix = i + n_steps_in
		out_end_ix = end_ix + n_steps_out
		# check if we are beyond the dataset
		if out_end_ix &gt; len(sequences):
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequences[i:end_ix, :], sequences[end_ix:out_end_ix, :]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
in_seq1 = array([10, 20, 30, 40, 50, 60, 70, 80, 90])
in_seq2 = array([15, 25, 35, 45, 55, 65, 75, 85, 95])
out_seq = array([in_seq1[i]+in_seq2[i] for i in range(len(in_seq1))])
# convert to [rows, columns] structure
in_seq1 = in_seq1.reshape((len(in_seq1), 1))
in_seq2 = in_seq2.reshape((len(in_seq2), 1))
out_seq = out_seq.reshape((len(out_seq), 1))
# horizontally stack columns
dataset = hstack((in_seq1, in_seq2, out_seq))
# choose a number of time steps
n_steps_in, n_steps_out = 3, 2
# covert into input/output
X, y = split_sequences(dataset, n_steps_in, n_steps_out)
# the dataset knows the number of features, e.g. 2
n_features = X.shape[2]
# define model
model = Sequential()
model.add(LSTM(200, activation='relu', input_shape=(n_steps_in, n_features)))
model.add(RepeatVector(n_steps_out))
model.add(LSTM(200, activation='relu', return_sequences=True))
model.add(TimeDistributed(Dense(n_features)))
model.compile(optimizer='adam', loss='mse')
# fit model
model.fit(X, y, epochs=300, verbose=0)
# demonstrate prediction
x_input = array([[60, 65, 125], [70, 75, 145], [80, 85, 165]])
x_input = x_input.reshape((1, n_steps_in, n_features))
yhat = model.predict(x_input, verbose=0)
print(yhat)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-2">2</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-4">4</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-6">6</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-8">8</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-10">10</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-12">12</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-14">14</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-16">16</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-18">18</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-20">20</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-22">22</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-24">24</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-26">26</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-28">28</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-30">30</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-32">32</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-34">34</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-36">36</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-38">38</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-40">40</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-42">42</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-44">44</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-46">46</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-48">48</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-50">50</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-52">52</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560aca538841777-54">54</div><div class="crayon-num" data-line="crayon-5d4518f560aca538841777-55">55</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560aca538841777-1"><span class="crayon-p"># multivariate multi-step encoder-decoder lstm example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">hstack</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">RepeatVector</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">TimeDistributed</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-10"><span class="crayon-p"># split a multivariate sequence into samples</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-11"><span class="crayon-e">def </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-12"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-13"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-14"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-15"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">n_steps_in</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-16"><span class="crayon-e">		</span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-17"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-18"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">out_end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-19"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-20"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-21"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-o">:</span><span class="crayon-v">out_end_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-22"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-23"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-24"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-26"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-27"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-28"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-29"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-30"><span class="crayon-p"># convert to [rows, columns] structure</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-31"><span class="crayon-v">in_seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq1</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-32"><span class="crayon-v">in_seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-33"><span class="crayon-v">out_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-34"><span class="crayon-p"># horizontally stack columns</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-35"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">in_seq1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">in_seq2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out_seq</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-36"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-37"><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-38"><span class="crayon-p"># covert into input/output</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-39"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-40"><span class="crayon-p"># the dataset knows the number of features, e.g. 2</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-41"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-42"><span class="crayon-p"># define model</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-43"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-44"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-45"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">RepeatVector</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps_out</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-46"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-47"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">TimeDistributed</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-48"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mse'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-49"><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-50"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">300</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-51"><span class="crayon-p"># demonstrate prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-52"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">125</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">145</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">165</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-53"><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560aca538841777-54"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f560aca538841777-55"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0057 seconds] -->
<p>Running the example fits the model and predicts the values for each of the three time steps for the next two time steps beyond the end of the dataset.</p>
<p>We would expect the values for these series and time steps to be as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560acf767542469" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">90, 95, 185
100, 105, 205</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560acf767542469-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560acf767542469-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560acf767542469-1">90, 95, 185</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560acf767542469-2">100, 105, 205</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can see that the model forecast gets reasonably close to the expected values.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f560ad2878529699" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">[[[ 91.86044   97.77231  189.66768 ]
  [103.299355 109.18123  212.6863  ]]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f560ad2878529699-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f560ad2878529699-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f560ad2878529699-1">[[[ 91.86044&nbsp;&nbsp; 97.77231&nbsp;&nbsp;189.66768 ]</div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f560ad2878529699-2">&nbsp;&nbsp;[103.299355 109.18123&nbsp;&nbsp;212.6863&nbsp;&nbsp;]]]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to develop a suite of LSTM models for a range of standard time series forecasting problems.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to develop LSTM models for univariate time series forecasting.</li>
<li>How to develop LSTM models for multivariate time series forecasting.</li>
<li>How to develop LSTM models for multi-step time series forecasting.</li>
</ul>
<p>Do you have any questions?<br>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-52">			<div class="textwidget"><p></p><center><br>
<div class="woo-sc-hr"></div><p></p>
<h2>Develop Deep Learning models for Time Series Today!</h2>
<p><a href="https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/"><img style="border: 0;" src="./How to Develop LSTM Models for Time Series Forecasting_files/Cover-220.png" alt="Deep Learning for Time Series Forecasting" align="left"></a></p>
<h4>Develop Your Own Forecasting models in Minutes</h4>
<p>…with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br>
<a href="https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/">Deep Learning for Time Series Forecasting</a></p>
<p>It provides <strong>self-study tutorials</strong> on topics like: <em>CNNs</em>, <em>LSTMs</em>,<br>
<em>Multivariate Forecasting</em>, <em>Multi-Step Forecasting</em> and much more…</p>
<h4>Finally Bring Deep Learning to your Time Series Forecasting Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/">Click to learn more</a>.<br>
</p><div class="woo-sc-hr"></div><br>
</center><p></p>
</div>
		</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-6435 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Develop+LSTM+Models+for+Time+Series+Forecasting&amp;url=https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
	</section><!-- /.entry -->
	<div class="fix"></div>
<aside id="post-author">
	<div class="profile-image"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" height="80" width="80"></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/how-to-develop-convolutional-neural-network-models-for-time-series-forecasting/" rel="prev"><i class="fa fa-angle-left"></i> How to Develop Convolutional Neural Network Models for Time Series Forecasting</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/how-to-grid-search-deep-learning-models-for-time-series-forecasting/" rel="next">How to Grid Search Deep Learning Models for Time Series Forecasting <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">249 Responses to <em>How to Develop LSTM Models for Time Series Forecasting</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-454897" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-454897" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/da45478a9006aecfdb9542cab3637438.png" srcset="https://secure.gravatar.com/avatar/da45478a9006aecfdb9542cab3637438?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jenna Ma</span>
	                <span class="date">November 16, 2018 at 12:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-454897" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This tutorial is so helpful to me. Thank you very much!<br>
It will be more helpful in the real projects if the dataset is split into batches. Hope you will mention this in the future.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-454897" data-commentid="454897" data-postid="6435" data-belowelement="comment-454897" data-respondelement="respond" aria-label="Reply to Jenna Ma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454931" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-454931" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 16, 2018 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-454931" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Keras will split the dataset into batches.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-454931" data-commentid="454931" data-postid="6435" data-belowelement="comment-454931" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455010" class="comment even depth-3 parent">

	      	<div id="li-comment-455010" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/da45478a9006aecfdb9542cab3637438.png" srcset="https://secure.gravatar.com/avatar/da45478a9006aecfdb9542cab3637438?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jenna Ma</span>
	                <span class="date">November 16, 2018 at 7:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-455010" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think this blog ( <a href="https://machinelearningmastery.com/use-different-batch-sizes-training-predicting-python-keras/" rel="nofollow">https://machinelearningmastery.com/use-different-batch-sizes-training-predicting-python-keras/</a>) may answer my question. I will do more research. Thanks a lot.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-455010" data-commentid="455010" data-postid="6435" data-belowelement="comment-455010" data-respondelement="respond" aria-label="Reply to Jenna Ma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455072" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-455072" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 17, 2018 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-455072" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-455072" data-commentid="455072" data-postid="6435" data-belowelement="comment-455072" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454940" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-454940" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/e15c60abda7d8c3f520091d2d2b438cb.png" srcset="https://secure.gravatar.com/avatar/e15c60abda7d8c3f520091d2d2b438cb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amy</span>
	                <span class="date">November 16, 2018 at 7:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-454940" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for this good tutorial. I have a question. When we have two different time series, 1 and 2. Time series 1 will influence time series 2 and our goal is to predict the future value of time series 2. How can we use LSTM for this case?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-454940" data-commentid="454940" data-postid="6435" data-belowelement="comment-454940" data-respondelement="respond" aria-label="Reply to Amy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454968" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-454968" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 16, 2018 at 1:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-454968" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I call this a dependent time series problem. I given an example of how to model it on this post:<br>
<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-454968" data-commentid="454968" data-postid="6435" data-belowelement="comment-454968" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454975" class="comment even depth-3 parent">

	      	<div id="li-comment-454975" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/e15c60abda7d8c3f520091d2d2b438cb.png" srcset="https://secure.gravatar.com/avatar/e15c60abda7d8c3f520091d2d2b438cb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amy</span>
	                <span class="date">November 16, 2018 at 2:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-454975" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The link is the link of the current page, Do you mean that?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-454975" data-commentid="454975" data-postid="6435" data-belowelement="comment-454975" data-respondelement="respond" aria-label="Reply to Amy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455062" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-455062" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 17, 2018 at 5:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-455062" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I give an example above.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-455062" data-commentid="455062" data-postid="6435" data-belowelement="comment-455062" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455850" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-455850" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/5980e01c1112165515d3591f2b23fcc8.png" srcset="https://secure.gravatar.com/avatar/5980e01c1112165515d3591f2b23fcc8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kwan</span>
	                <span class="date">November 22, 2018 at 8:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-455850" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for this good tutorial, I have read your tutorial for a long time , I have a question. How to use LSTM model forecasting Multi-Site Multivariate Time Series, such as EMC Data Science Global Hackathon dataset, thank you very much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-455850" data-commentid="455850" data-postid="6435" data-belowelement="comment-455850" data-respondelement="respond" aria-label="Reply to Kwan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455888" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455888" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 23, 2018 at 7:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-455888" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have advice for multi-site forecasting here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-to-develop-forecast-models-for-multiple-sites" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-to-develop-forecast-models-for-multiple-sites</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-455888" data-commentid="455888" data-postid="6435" data-belowelement="comment-455888" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456579" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-456579" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/ff5bd16520ae6c05fa21bcc67df7590b.png" srcset="https://secure.gravatar.com/avatar/ff5bd16520ae6c05fa21bcc67df7590b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Caiyuan</span>
	                <span class="date">November 29, 2018 at 1:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-456579" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for sharing. I found that the results of time series prediction using LSTM are similar to the results of one step behind the original sequence. What do you think?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-456579" data-commentid="456579" data-postid="6435" data-belowelement="comment-456579" data-respondelement="respond" aria-label="Reply to Caiyuan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456590" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-456590" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2018 at 2:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-456590" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sounds like the model has learned a persistance model and may not be skillful.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-456590" data-commentid="456590" data-postid="6435" data-belowelement="comment-456590" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-457387" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-457387" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/f753e2f48666a88a5e52b3ed25528428.png" srcset="https://secure.gravatar.com/avatar/f753e2f48666a88a5e52b3ed25528428?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">WLF</span>
	                <span class="date">December 5, 2018 at 6:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-457387" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot! I have read your websites for a long time!<br>
I have a question, in “Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras”  you said that:<br>
“LSTMs are sensitive to the scale of the input data, specifically when the sigmoid (default) or tanh activation functions are used. It can be a good practice to rescale the data to the range of 0-to-1, also called normalizing. ”<br>
So why don’t you normalize input here?<br>
Because you used relu? Because the data is increasing (so we can’t normalize the future input)? Or because you just give us an example?<br>
Do you suggest normalizing here?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-457387" data-commentid="457387" data-postid="6435" data-belowelement="comment-457387" data-respondelement="respond" aria-label="Reply to WLF">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-457482" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-457482" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 6, 2018 at 5:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-457482" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It would be a good idea to prepare the data with normalization or similar here.</p>
<p>I chose not to because it seems to confuse more readers than it helps. Also, choice of relu does make the model a lot more robust to unscaled data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-457482" data-commentid="457482" data-postid="6435" data-belowelement="comment-457482" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-457447" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-457447" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/b5957c8e44f8b0ef8fb358d09416d887.png" srcset="https://secure.gravatar.com/avatar/b5957c8e44f8b0ef8fb358d09416d887?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">rkk621</span>
	                <span class="date">December 6, 2018 at 2:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-457447" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for a great article. Minor typo or confusion:</p>
<p>For the Multiple input case in Multivariate series, if we use three time steps and</p>
<p>10,15<br>
20,25<br>
30,35</p>
<p>as our inputs, shouldn’t the output (predicted val used for training) be </p>
<p>85</p>
<p>instead of 65?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-457447" data-commentid="457447" data-postid="6435" data-belowelement="comment-457447" data-respondelement="respond" aria-label="Reply to rkk621">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-457490" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-457490" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 6, 2018 at 5:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-457490" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In the chosen framing of the problem, we want to predict the output at t not t+1, given inputs up to and including t.</p>
<p>You can choose to frame the problem differently if you like. It is arbitrary.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-457490" data-commentid="457490" data-postid="6435" data-belowelement="comment-457490" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-457631" class="comment even depth-2">

	      	<div id="li-comment-457631" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/f753e2f48666a88a5e52b3ed25528428.png" srcset="https://secure.gravatar.com/avatar/f753e2f48666a88a5e52b3ed25528428?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">WLF</span>
	                <span class="date">December 6, 2018 at 11:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-457631" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can also reference ‘Multiple Parallel …’</p>
<p>So you can find the differences in function ‘split_sequences’</p>
<p>if you want to predict 85, you can change the code to:</p>
<p>		if end_ix &gt; len(sequences)-1:<br>
			break<br>
		seq_x, seq_y = sequences[i:end_ix, :-1], sequences[end_ix, -1]</p>
<p>Notice ‘len(sequences)-1’,  and ‘sequences[end_ix, -1]’</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-457631" data-commentid="457631" data-postid="6435" data-belowelement="comment-457631" data-respondelement="respond" aria-label="Reply to WLF">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-458049" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-458049" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/3da0efd2218bad905262b1400d8e632d.png" srcset="https://secure.gravatar.com/avatar/3da0efd2218bad905262b1400d8e632d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ida</span>
	                <span class="date">December 10, 2018 at 7:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458049" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks sooooo much Jason.<br>
It helped me a lot.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458049" data-commentid="458049" data-postid="6435" data-belowelement="comment-458049" data-respondelement="respond" aria-label="Reply to Ida">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458098" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-458098" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 11, 2018 at 7:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458098" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m happy to hear that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458098" data-commentid="458098" data-postid="6435" data-belowelement="comment-458098" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-458242" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-458242" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/29399ed3a6f400ced6829fbb9adbea77.png" srcset="https://secure.gravatar.com/avatar/29399ed3a6f400ced6829fbb9adbea77?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">John</span>
	                <span class="date">December 12, 2018 at 9:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458242" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for this nice blog! I am new to LSTM in time-series, and I need your help.</p>
<p>Most info on internet is for a single time series and for next-step forecasting. I want to produce 6 months ahead forecast using previous 15 months for 100 different time series, each of length 54 months. </p>
<p>So, there is 34 windows for each time-series if we use sliding windows. So, my initial X_train has a shape of (3400,15). Then. I am reshaping my X_train [samples, timesteps, features] as follows: (3400, 15, 1). Is this reshaping correct? In genera, how can we choose “timesteps” and “features” arguments in this multi-input multi-step forecast?</p>
<p>Also, how can I choose “batch_size” and “units”? Since I want 6 months ahead forecast, my output should be a matrix with dimensions (100,6). I chose units=6, and batch_size=1. Are these numbers correct?</p>
<p>Thanks for your help!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458242" data-commentid="458242" data-postid="6435" data-belowelement="comment-458242" data-respondelement="respond" aria-label="Reply to John">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458269" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-458269" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 12, 2018 at 2:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458269" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Looks good.</p>
<p>Time steps is really problem specific – e.g. how much history do you need to make a prediction. Perhaps test with your data.</p>
<p>Batch size and units – again, depends on your problem. Test. 6 units is too few. Start with 100, try 500, 1000, etc. Batch size of 1 seems small, perhaps also try 32, 64, etc.</p>
<p>Let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458269" data-commentid="458269" data-postid="6435" data-belowelement="comment-458269" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458323" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-458323" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/29399ed3a6f400ced6829fbb9adbea77.png" srcset="https://secure.gravatar.com/avatar/29399ed3a6f400ced6829fbb9adbea77?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">John</span>
	                <span class="date">December 13, 2018 at 2:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458323" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for your response.</p>
<p>I don’t understand “6 units is too few”. In documentation of lstm functions in R, units is defined as “dimensionality of the output space”. Since I need an output with 6 columns (6 months forecast), I define units=6. Any other number does not produce the output I want. Is there anything wrong in my interpretation?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458323" data-commentid="458323" data-postid="6435" data-belowelement="comment-458323" data-respondelement="respond" aria-label="Reply to John">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458364" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-458364" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 13, 2018 at 7:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458364" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend using a Dense layer as the output rather than the outputting from the LSTM directly.</p>
<p>Then dramatically increase the capacity of the model by increasing the number of LSTM units.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458364" data-commentid="458364" data-postid="6435" data-belowelement="comment-458364" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-458645" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-458645" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6a44fdab183b666a77db85fa0357c8dd.png" srcset="https://secure.gravatar.com/avatar/6a44fdab183b666a77db85fa0357c8dd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shaifali</span>
	                <span class="date">December 16, 2018 at 1:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458645" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Bidirectional LSTM works better than LSTM. Can you please explain the working of bidirectional LSTM. Since we do not know future values. How do we do prediction?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458645" data-commentid="458645" data-postid="6435" data-belowelement="comment-458645" data-respondelement="respond" aria-label="Reply to Shaifali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458683" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-458683" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 16, 2018 at 5:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458683" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It has two LSTM layers, one that processes the sequences forwards, and one that processes it backwards.</p>
<p>You can learn more here:<br>
<a href="https://machinelearningmastery.com/develop-bidirectional-lstm-sequence-classification-python-keras/" rel="nofollow">https://machinelearningmastery.com/develop-bidirectional-lstm-sequence-classification-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458683" data-commentid="458683" data-postid="6435" data-belowelement="comment-458683" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-458733" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-458733" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/da45478a9006aecfdb9542cab3637438.png" srcset="https://secure.gravatar.com/avatar/da45478a9006aecfdb9542cab3637438?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jenna Ma</span>
	                <span class="date">December 16, 2018 at 4:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458733" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In the last encoder-decoder model, if I have different features of input and output, is it correct that I change the code like this?<br>
model = Sequential()<br>
model.add(LSTM(200, activation=’relu’, input_shape=(n_steps_in, n_features_in)))<br>
model.add(RepeatVector(n_steps_out))<br>
model.add(LSTM(200, activation=’relu’, return_sequences=True))<br>
model.add(TimeDistributed(Dense(n_features_out)))<br>
model.compile(optimizer=’adam’, loss=’mse’)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458733" data-commentid="458733" data-postid="6435" data-belowelement="comment-458733" data-respondelement="respond" aria-label="Reply to Jenna Ma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458817" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-458817" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 17, 2018 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458817" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m sure I understand, what do you mean exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458817" data-commentid="458817" data-postid="6435" data-belowelement="comment-458817" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458999" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-458999" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/da45478a9006aecfdb9542cab3637438.png" srcset="https://secure.gravatar.com/avatar/da45478a9006aecfdb9542cab3637438?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jenna Ma</span>
	                <span class="date">December 18, 2018 at 1:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458999" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am sorry for not expressing my question clearly.<br>
In the last part of your tutorial, you gave an example like this:<br>
[[10 15 25]<br>
 [20 25 45]<br>
 [30 35 65]]<br>
[[ 40  45  85]<br>
 [ 50  55 105]]<br>
Then, you introduced the Encoder-Decoder LSTM to model this problem.<br>
If I want to use the last three time steps from each of the three time series as input to the model and predict the next two time steps of the third time series as output. Namely, my input and output elements are like the following. The shapes of input and output are (5, 3, 3) and (5, 2, 1) respectively.<br>
[[10 15 25]<br>
 [20 25 45]<br>
 [30 35 65]]<br>
[[85]<br>
 [105]]<br>
When I define the Encoder-Decoder LSTM model, the code will be like this:<br>
model = Sequential()<br>
model.add(LSTM(200, activation=’relu’, input_shape=(3,3)))<br>
model.add(RepeatVector(2))<br>
model.add(LSTM(200, activation=’relu’, return_sequences=True))<br>
model.add(TimeDistributed(Dense(1)))<br>
model.compile(optimizer=’adam’, loss=’mse’)<br>
Is it correct?<br>
Thank you very much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-458999" data-commentid="458999" data-postid="6435" data-belowelement="comment-458999" data-respondelement="respond" aria-label="Reply to Jenna Ma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459010" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-459010" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 18, 2018 at 2:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459010" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It looks correct, but I don’t have the capacity to test the code to be sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459010" data-commentid="459010" data-postid="6435" data-belowelement="comment-459010" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459026" class="comment odd alt depth-5">

	      	<div id="li-comment-459026" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/da45478a9006aecfdb9542cab3637438.png" srcset="https://secure.gravatar.com/avatar/da45478a9006aecfdb9542cab3637438?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jenna Ma</span>
	                <span class="date">December 18, 2018 at 6:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459026" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you!<br>
I test the code, and I want to show you what I got.<br>
I assume the input sequence:<br>
in_seq1 = np.arange(10,1000,10)<br>
in_seq2 = np.arange(15,1005,10)<br>
Define the prediction input:<br>
x_input = np.array([[960, 965, 1925], [970, 975, 1945], [980, 985, 1965]])<br>
I expect the output values would be as follows:<br>
 [ [1985] [2005] ]<br>
And the model forecasts: [ [1997.1425]  [2026.6136] ]<br>
I think this means that the model can work.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-459096" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-459096" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 19, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459096" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work! Now you can start tuning the model to lift skill.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-459147" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-459147" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/f91142d9c5ab004b6a0c49f6ef8f2d32.png" srcset="https://secure.gravatar.com/avatar/f91142d9c5ab004b6a0c49f6ef8f2d32?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">dani</span>
	                <span class="date">December 19, 2018 at 12:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>how we can test these examples if have big excel data set?and its time series data, kindly refer to a link?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459147" data-commentid="459147" data-postid="6435" data-belowelement="comment-459147" data-respondelement="respond" aria-label="Reply to dani">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459157" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-459157" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 19, 2018 at 2:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459157" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Save as a CSV file then use code in this post to prepare it for modeling:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459157" data-commentid="459157" data-postid="6435" data-belowelement="comment-459157" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-459348" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-459348" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/fda5f1787e764f8a4c0b7ba80e7be001.png" srcset="https://secure.gravatar.com/avatar/fda5f1787e764f8a4c0b7ba80e7be001?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">mk</span>
	                <span class="date">December 20, 2018 at 7:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459348" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can Multivariate  time series apply to cnn-lstm model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459348" data-commentid="459348" data-postid="6435" data-belowelement="comment-459348" data-respondelement="respond" aria-label="Reply to mk">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459399" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-459399" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 21, 2018 at 5:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459399" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I have a good beginner example here:<br>
<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459399" data-commentid="459399" data-postid="6435" data-belowelement="comment-459399" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-459473" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-459473" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/0166bc8343a40d662c89058a1a0a857b.png" srcset="https://secure.gravatar.com/avatar/0166bc8343a40d662c89058a1a0a857b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lionel</span>
	                <span class="date">December 21, 2018 at 6:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459473" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I want to predict visibility on one airport for the next 120 hours.<br>
I already build a LSTM to predict the visibility for the next hour, solely based on visibility observation. (Basically, the network learned that persistance is a good algorithm.)</p>
<p>My next step is to include a weather model forecast of say humidity as input. </p>
<p>I have then as input:<br>
visibility observation on the airport (past and present)<br>
prediction of humidity for the next 120 hours.</p>
<p>I have trouble to combine these two information.<br>
Do you have suggestions?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459473" data-commentid="459473" data-postid="6435" data-belowelement="comment-459473" data-respondelement="respond" aria-label="Reply to Lionel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459550" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-459550" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 22, 2018 at 6:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459550" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What trouble are you having exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459550" data-commentid="459550" data-postid="6435" data-belowelement="comment-459550" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459631" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-459631" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/0166bc8343a40d662c89058a1a0a857b.png" srcset="https://secure.gravatar.com/avatar/0166bc8343a40d662c89058a1a0a857b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lionel</span>
	                <span class="date">December 22, 2018 at 7:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459631" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>let’s say:<br>
Input : last 120 h of measured visibility<br>
           weather forcast for the next 120 h</p>
<p>Output: visibility prediction for the next 120 h</p>
<p>Implementation:<br>
make visibility prediction every hour for the next 120 h</p>
<p>I have trouble to see how the LSTM will update its state every hour, since it will only get as new information a measured visibility for the last hour, and not about the full 120 h prediction.</p>
<p>I must say that I’m a newbie in ML.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459631" data-commentid="459631" data-postid="6435" data-belowelement="comment-459631" data-respondelement="respond" aria-label="Reply to Lionel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459692" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-459692" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 23, 2018 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459692" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The model is only aware of the data that you provide it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459692" data-commentid="459692" data-postid="6435" data-belowelement="comment-459692" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-459533" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-459533" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/df54d53d00b43ed4658e7ba73ecdff8a.png" srcset="https://secure.gravatar.com/avatar/df54d53d00b43ed4658e7ba73ecdff8a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Potofski</span>
	                <span class="date">December 22, 2018 at 3:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459533" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot for your post. Your work is a great resource on forecasts with lstm! </p>
<p>Assume, I have dependent time series (heating costs and temperature) and I want to predict the dependent (heating costs), how could I implement temperature predictions (from other weather forecasts) into my model for heating cost predictions?</p>
<p>Do you know of any common approaches to this? Or any papers on how to handle external forecasts for independent variables?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459533" data-commentid="459533" data-postid="6435" data-belowelement="comment-459533" data-respondelement="respond" aria-label="Reply to Potofski">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459556" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-459556" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 22, 2018 at 6:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459556" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend this process generally:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-459556" data-commentid="459556" data-postid="6435" data-belowelement="comment-459556" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-461439" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-461439" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/da45478a9006aecfdb9542cab3637438.png" srcset="https://secure.gravatar.com/avatar/da45478a9006aecfdb9542cab3637438?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jenna Ma</span>
	                <span class="date">January 4, 2019 at 9:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-461439" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I think I saw you mentioning the activation function ‘relu’ usually works better than ‘tanh’ in LSTM model. But, I forget I saw this in which post. I don’t find any post from your blog that focuses on how to choose the activation function. So, I submit this question under this post and hope you don’t mind.<br>
Is it true that ‘relu’ often works better than ‘tanh’ in your experience? If you have any post talking about activation function, please give me the title or URL.<br>
Thank you very much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-461439" data-commentid="461439" data-postid="6435" data-belowelement="comment-461439" data-respondelement="respond" aria-label="Reply to Jenna Ma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-461493" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-461493" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 5, 2019 at 6:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-461493" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It really depends on the dataset, I have found LSTMs with relu more robust on some problems.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-461493" data-commentid="461493" data-postid="6435" data-belowelement="comment-461493" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-461707" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-461707" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/da45478a9006aecfdb9542cab3637438.png" srcset="https://secure.gravatar.com/avatar/da45478a9006aecfdb9542cab3637438?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jenna Ma</span>
	                <span class="date">January 7, 2019 at 12:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-461707" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you! So, the way I can make sure which activation function is the best for my dataset is to enumerate and see the results?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-461707" data-commentid="461707" data-postid="6435" data-belowelement="comment-461707" data-respondelement="respond" aria-label="Reply to Jenna Ma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-461748" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-461748" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 7, 2019 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-461748" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes. It will almost certainly be relu or tanh.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-461748" data-commentid="461748" data-postid="6435" data-belowelement="comment-461748" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-461967" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-461967" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/4388236ae1fe5adcb743c8fff14dc0b4.png" srcset="https://secure.gravatar.com/avatar/4388236ae1fe5adcb743c8fff14dc0b4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Matt</span>
	                <span class="date">January 9, 2019 at 3:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-461967" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is awesome for someone starting out with LSTM.</p>
<p>All the content on your site is amazing, I really appreciate it. Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-461967" data-commentid="461967" data-postid="6435" data-belowelement="comment-461967" data-respondelement="respond" aria-label="Reply to Matt">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-462010" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-462010" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 9, 2019 at 8:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-462010" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-462010" data-commentid="462010" data-postid="6435" data-belowelement="comment-462010" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-462116" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-462116" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/9b1427f378d02b9214a63253a645d42e.png" srcset="https://secure.gravatar.com/avatar/9b1427f378d02b9214a63253a645d42e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andrew Jabbitt</span>
	                <span class="date">January 10, 2019 at 4:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-462116" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Still lovin’ your work!</p>
<p>1 question: can you please explain the purpose of the out_seq series in the Multiple Parallel Series example?</p>
<p>Many thanks,<br>
Andrew</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-462116" data-commentid="462116" data-postid="6435" data-belowelement="comment-462116" data-respondelement="respond" aria-label="Reply to Andrew Jabbitt">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-462152" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-462152" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 10, 2019 at 7:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-462152" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is the output sequence, dependent upon the input sequences.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-462152" data-commentid="462152" data-postid="6435" data-belowelement="comment-462152" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-464527" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-464527" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/2d78e3d8a128ca7ae1ba1ef0e179a58a.png" srcset="https://secure.gravatar.com/avatar/2d78e3d8a128ca7ae1ba1ef0e179a58a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sophia</span>
	                <span class="date">January 22, 2019 at 8:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-464527" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>another great article, Jason! I’m trying to get started on a project that is similar to the LSTM model described in this article: <a href="https://medium.com/bcggamma/using-deep-learning-to-predict-not-just-what-but-when-fae6515acb1b" rel="nofollow">https://medium.com/bcggamma/using-deep-learning-to-predict-not-just-what-but-when-fae6515acb1b</a></p>
<p>I’d greatly appreciate your input on how to develop an LSTM model that can predict ‘what’ a consumer may buy and ‘when’ they will buy it;</p>
<p>Based on your article, it looks like the right model to choose would be Multiple Parallel Input and Multi-Step Output. Would you agree or do you think i should choose a different model? Any pointers or links to relevant articles would help!</p>
<p>Thanks,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-464527" data-commentid="464527" data-postid="6435" data-belowelement="comment-464527" data-respondelement="respond" aria-label="Reply to sophia">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464544" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-464544" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 22, 2019 at 11:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-464544" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’d encourage you to prototype and explore a suite of different framings of the problem in order to discover what works best for your specific dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-464544" data-commentid="464544" data-postid="6435" data-belowelement="comment-464544" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-464565" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-464565" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/ea52cc526b1f2706be202af3e6676f6c.png" srcset="https://secure.gravatar.com/avatar/ea52cc526b1f2706be202af3e6676f6c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Raman</span>
	                <span class="date">January 22, 2019 at 3:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-464565" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d4518f56985a024890322" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">def split_sequence(sequence, n_steps):
	X, y = list(), list()
	for i in range(len(sequence)):
		# find the end of this pattern
		end_ix = i + n_steps
		# check if we are beyond the sequence
		if end_ix &gt; len(sequence)-1:
			break
		# gather input and output parts of the pattern
		seq_x, seq_y = sequence[i:end_ix], sequence[end_ix]
		X.append(seq_x)
		y.append(seq_y)
	return array(X), array(y)

# define input sequence
raw_seq = [10, 20, 30, 40, 50, 60, 70, 80, 90]
# choose a number of time steps
n_steps = 3
# split into samples
X, y = split_sequence(raw_seq, n_steps)
# reshape from [samples, timesteps] into [samples, timesteps, features]
n_features = 1
X = X.reshape((X.shape[0], X.shape[1], n_features))
# define model
model = Sequential()
model.add(LSTM(50, activation='relu', input_shape=(n_steps, n_features)))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5d4518f56985a024890322-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56985a024890322-2">2</div><div class="crayon-num" data-line="crayon-5d4518f56985a024890322-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56985a024890322-4">4</div><div class="crayon-num" data-line="crayon-5d4518f56985a024890322-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56985a024890322-6">6</div><div class="crayon-num" data-line="crayon-5d4518f56985a024890322-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56985a024890322-8">8</div><div class="crayon-num" data-line="crayon-5d4518f56985a024890322-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56985a024890322-10">10</div><div class="crayon-num" data-line="crayon-5d4518f56985a024890322-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56985a024890322-12">12</div><div class="crayon-num" data-line="crayon-5d4518f56985a024890322-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56985a024890322-14">14</div><div class="crayon-num" data-line="crayon-5d4518f56985a024890322-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56985a024890322-16">16</div><div class="crayon-num" data-line="crayon-5d4518f56985a024890322-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56985a024890322-18">18</div><div class="crayon-num" data-line="crayon-5d4518f56985a024890322-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56985a024890322-20">20</div><div class="crayon-num" data-line="crayon-5d4518f56985a024890322-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56985a024890322-22">22</div><div class="crayon-num" data-line="crayon-5d4518f56985a024890322-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56985a024890322-24">24</div><div class="crayon-num" data-line="crayon-5d4518f56985a024890322-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d4518f56985a024890322-26">26</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d4518f56985a024890322-1"><span class="crayon-e">def </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56985a024890322-2"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f56985a024890322-3"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56985a024890322-4"><span class="crayon-h">		</span><span class="crayon-p"># find the end of this pattern</span></div><div class="crayon-line" id="crayon-5d4518f56985a024890322-5"><span class="crayon-h">		</span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56985a024890322-6"><span class="crayon-h">		</span><span class="crayon-p"># check if we are beyond the sequence</span></div><div class="crayon-line" id="crayon-5d4518f56985a024890322-7"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">end_ix</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequence</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56985a024890322-8"><span class="crayon-h">			</span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5d4518f56985a024890322-9"><span class="crayon-h">		</span><span class="crayon-p"># gather input and output parts of the pattern</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56985a024890322-10"><span class="crayon-h">		</span><span class="crayon-v">seq_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">[</span><span class="crayon-v">end_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f56985a024890322-11"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56985a024890322-12"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f56985a024890322-13"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56985a024890322-14">&nbsp;</div><div class="crayon-line" id="crayon-5d4518f56985a024890322-15"><span class="crayon-p"># define input sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56985a024890322-16"><span class="crayon-v">raw_seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5d4518f56985a024890322-17"><span class="crayon-p"># choose a number of time steps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56985a024890322-18"><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line" id="crayon-5d4518f56985a024890322-19"><span class="crayon-p"># split into samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56985a024890322-20"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">split_sequence</span><span class="crayon-sy">(</span><span class="crayon-v">raw_seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5d4518f56985a024890322-21"><span class="crayon-p"># reshape from [samples, timesteps] into [samples, timesteps, features]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56985a024890322-22"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5d4518f56985a024890322-23"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56985a024890322-24"><span class="crayon-p"># define model</span></div><div class="crayon-line" id="crayon-5d4518f56985a024890322-25"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d4518f56985a024890322-26"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0025 seconds] -->
<p></p>
<p>I have used your code to get started, at the last step I am getting a below error-<br>
NameError: name ‘to_list’ is not defined</p>
<p>Could you please help, I am not sure what am i missing here.</p>
<p>Thanks for your help</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-464565" data-commentid="464565" data-postid="6435" data-belowelement="comment-464565" data-respondelement="respond" aria-label="Reply to Raman">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464698" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-464698" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 23, 2019 at 8:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-464698" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ensure you have copied all of the code from the tutorial, I have more suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-464698" data-commentid="464698" data-postid="6435" data-belowelement="comment-464698" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-464750" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-464750" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/ea52cc526b1f2706be202af3e6676f6c.png" srcset="https://secure.gravatar.com/avatar/ea52cc526b1f2706be202af3e6676f6c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Raman</span>
	                <span class="date">January 23, 2019 at 4:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-464750" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for taking time out, I have copied your code line by line and checked couple of times as well. Example is from Vanila LSTM.</p>
<p>Checks done-<br>
I was getting some error, then I followed stack overflow and downgraded my keras to Version: 2.1.5<br>
I searched stack overflow and related questions and even posted my questions there.</p>
<p>Your help is appreciated.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-464750" data-commentid="464750" data-postid="6435" data-belowelement="comment-464750" data-respondelement="respond" aria-label="Reply to Raman">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464808" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-464808" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 24, 2019 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-464808" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend using the latest version of Keras and TensorFlow.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-464808" data-commentid="464808" data-postid="6435" data-belowelement="comment-464808" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-465457" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-465457" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/47c597869959fd6bc5c7c5968d28349d.png" srcset="https://secure.gravatar.com/avatar/47c597869959fd6bc5c7c5968d28349d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sarra</span>
	                <span class="date">January 30, 2019 at 3:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-465457" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Please, have you an example of LSTM encoder-decoder with the train / test-evaluation partitions.</p>
<p>I tried but it does not work like this:</p>
<p># split into samples</p>
<p>trainX, trainy = split_sequence(train, n_steps_in, n_steps_out)<br>
testX, testy = split_sequence(test, n_steps_in, n_steps_out)</p>
<p># reshape</p>
<p>trainX = trainX.reshape((trainX.shape[0], trainX.shape[1], n_features))<br>
testX = testX.reshape((testX.shape[0], testX.shape[1], n_features))<br>
….</p>
<p># fit model<br>
        model.fit(trainX, trainy, epochs=5, verbose=2)</p>
<p>        # make predictions<br>
        trainPredict = model.predict(trainX)<br>
        testPredict = model.predict(testX)</p>
<p>        # calculate root mean squared error<br>
        trainScore = math.sqrt(mean_squared_error(trainY[0], trainPredict[:,0]))<br>
        print(‘Train Score: %.2f RMSE’ % (trainScore))<br>
        testScore = math.sqrt(mean_squared_error(testY[0], testPredict[:,0]))<br>
        print(‘Test Score: %.2f RMSE’ % (testScore))</p>
<p>thank you very much</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-465457" data-commentid="465457" data-postid="6435" data-belowelement="comment-465457" data-respondelement="respond" aria-label="Reply to Sarra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465493" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-465493" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 30, 2019 at 8:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-465493" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I may, you can use the search box to look at all tutorials that use the encoder-decoder pattern.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-465493" data-commentid="465493" data-postid="6435" data-belowelement="comment-465493" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-467037" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-467037" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/16e21ef9b180d0d2d4c2193bbac44a61.jpeg" srcset="https://secure.gravatar.com/avatar/16e21ef9b180d0d2d4c2193bbac44a61?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gunay</span>
	                <span class="date">February 6, 2019 at 2:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467037" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for this tutorial. I am quite new to the time series forecasting with LSTM. I have a question about the part “Multiple Parallel Input and Multi-Step Output”. The output data shape is (5,2,3). I mean the each instance on the output is not just a sequence, It is a sequence of sequence. And you have show the example there with Encoder and Decoder. I just want to implement one of the methods of Stacked or Bidirectional LSTM. But I am not sure which number I should put the Dense layer. For example, in the previous examples, the output shape is like (6,2) and It is obvious we should put 2 for the Dense layer. But I can not figure out the right thing for the Stacked LSTM. Do you have any example tutorial for this?</p>
<p>Kind Regards,<br>
Gunay</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467037" data-commentid="467037" data-postid="6435" data-belowelement="comment-467037" data-respondelement="respond" aria-label="Reply to Gunay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467097" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-467097" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 6, 2019 at 7:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467097" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>With multi-step output, the number of nodes in the output layer must match the number of output time steps.</p>
<p>With multivariate multi-step, a vanilla or bidirectional LSTM is not suited. You could force it, but you will need n x m nodes in the output for n time steps for m time series. The time steps of each series would be flattened in this structure.  You must interpret each of the outputs as a specific time step for a specific series consistently during training and prediction.</p>
<p>I don’t have an example, it is not an ideal approach.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467097" data-commentid="467097" data-postid="6435" data-belowelement="comment-467097" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467225" class="comment odd alt depth-3">

	      	<div id="li-comment-467225" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/16e21ef9b180d0d2d4c2193bbac44a61.jpeg" srcset="https://secure.gravatar.com/avatar/16e21ef9b180d0d2d4c2193bbac44a61?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gunay</span>
	                <span class="date">February 6, 2019 at 7:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467225" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467225" data-commentid="467225" data-postid="6435" data-belowelement="comment-467225" data-respondelement="respond" aria-label="Reply to Gunay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-467227" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-467227" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/16e21ef9b180d0d2d4c2193bbac44a61.jpeg" srcset="https://secure.gravatar.com/avatar/16e21ef9b180d0d2d4c2193bbac44a61?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gunay</span>
	                <span class="date">February 6, 2019 at 7:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467227" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is there any alternative structure for this kind of problems except Encoder-Decoder?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467227" data-commentid="467227" data-postid="6435" data-belowelement="comment-467227" data-respondelement="respond" aria-label="Reply to Gunay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467324" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-467324" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 7, 2019 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467324" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the one I described. There may be others, it is good to brainstorm and prototype approaches.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467324" data-commentid="467324" data-postid="6435" data-belowelement="comment-467324" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-467672" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-467672" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/28ea1b8e7f11a6abaa0307d7cc0374f0.png" srcset="https://secure.gravatar.com/avatar/28ea1b8e7f11a6abaa0307d7cc0374f0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tian</span>
	                <span class="date">February 10, 2019 at 5:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467672" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your great tutorial. I just wonder should we avoid using bidirectional LSTM for time series data? Does it mean we use future data to train the past model parameters?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467672" data-commentid="467672" data-postid="6435" data-belowelement="comment-467672" data-respondelement="respond" aria-label="Reply to Tian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467726" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-467726" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 11, 2019 at 7:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467726" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, it means the model will process the input sequence forwards and backwards at the same time.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-467726" data-commentid="467726" data-postid="6435" data-belowelement="comment-467726" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-468549" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-468549" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/16e21ef9b180d0d2d4c2193bbac44a61.jpeg" srcset="https://secure.gravatar.com/avatar/16e21ef9b180d0d2d4c2193bbac44a61?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gunay</span>
	                <span class="date">February 15, 2019 at 8:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-468549" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I faced one problem and just interesting maybe you did it before. I have the forecasting problem as like Multiple Input Multi-Step Output but a little bit different. Let’s just assume, my input(which are features dataset) and output (target we want to forecast) datasets have historic data. And I should forecast one week ahead for the target. But I have also the one week ahead forecasted input dataset(which is forecasted by another system). I should use both the historic input and one week ahead forecasted input to forecast one week ahead output. But I do not know how I should use that one week ahead forecasted input data during the learning process. Can you give me any hint?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-468549" data-commentid="468549" data-postid="6435" data-belowelement="comment-468549" data-respondelement="respond" aria-label="Reply to Gunay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-468600" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-468600" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 15, 2019 at 2:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-468600" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps use a model with two heads, one for the historical data and one for the other forecast?</p>
<p>The functional API will help you to design a model of this type:<br>
<a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="nofollow">https://machinelearningmastery.com/keras-functional-api-deep-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-468600" data-commentid="468600" data-postid="6435" data-belowelement="comment-468600" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-468620" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-468620" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/93bd19c60fa644acc05ed5adf0173947.png" srcset="https://secure.gravatar.com/avatar/93bd19c60fa644acc05ed5adf0173947?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anirban</span>
	                <span class="date">February 15, 2019 at 4:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-468620" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What if we want to predict anything for the next 20 upcoming days! Here sequentially we have to predict for 20 days. How can we apply LSTM here?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-468620" data-commentid="468620" data-postid="6435" data-belowelement="comment-468620" data-respondelement="respond" aria-label="Reply to Anirban">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-468740" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-468740" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 16, 2019 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-468740" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, although the further you predict into the future, the more error the model will make.</p>
<p>This is called multi-step forecasting, there are many examples, perhaps start here:<br>
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-468740" data-commentid="468740" data-postid="6435" data-belowelement="comment-468740" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-472795" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-472795" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6f7379f1fb62a0192f7acb5c7ed9c21f.png" srcset="https://secure.gravatar.com/avatar/6f7379f1fb62a0192f7acb5c7ed9c21f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aaron</span>
	                <span class="date">March 6, 2019 at 2:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-472795" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>HI Jason, thanks for all the tutorials. They are really helpful. I am looking to try and implement an LSTM that returns a sequence, and had read this tutorial – <a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>
<p>One thing I am having trouble understanding is how to really shape the input data and get a sequence output using Tensorflow / Keras. I am looking to predict the sequence T – T+12 hours using T-1 – T-48 hours. So predicting the next 12 hours from the last 48 hours in 1 hour increments. Each hour of data has a dozen or so features for that time step. From what I have read of yours so far it seems as if each of the 48 previous time steps should be considered features of the time step T to predict a sequence for the next 12 hours. And so basically, from what I gather, I would end up with the input for Timestep T having 576 columns (48 time steps, each with 12 features) – I mean does that seem right? I am also a bit unsure of what particular model I should use… is it going to be a multi-step, multi-input network… just a bit confused on the jargon as well and maybe thats why I’m having trouble figuring out what I need to do.</p>
<p>Looking at some of your books too, but not sure what might be the right one to help guide me through a problem like this.</p>
<p>Thanks,<br>
Aaron</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-472795" data-commentid="472795" data-postid="6435" data-belowelement="comment-472795" data-respondelement="respond" aria-label="Reply to Aaron">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472797" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-472797" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 6, 2019 at 2:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-472797" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this will help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-472797" data-commentid="472797" data-postid="6435" data-belowelement="comment-472797" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472899" class="comment even depth-3 parent">

	      	<div id="li-comment-472899" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6f7379f1fb62a0192f7acb5c7ed9c21f.png" srcset="https://secure.gravatar.com/avatar/6f7379f1fb62a0192f7acb5c7ed9c21f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aaron</span>
	                <span class="date">March 6, 2019 at 11:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-472899" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks! That definitely makes sense now from the input shape standpoint. If I have 20 samples with 48 timesteps and 12 features the input shape would be [20, 48, 12]</p>
<p>For the output however, looking through the Keras docs <a href="https://keras.io/layers/recurrent/" rel="nofollow">https://keras.io/layers/recurrent/</a>, I am trying to get a return sequence. Would I be using a 3D tensor? (batch_size, timesteps, units) where it would look like (20, 12, 1)? Since I am trying to find 1 value at each of the 12 time steps for the sample size of 20</p>
<p>Thanks again!<br>
Aaron</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-472899" data-commentid="472899" data-postid="6435" data-belowelement="comment-472899" data-respondelement="respond" aria-label="Reply to Aaron">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472949" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-472949" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 7, 2019 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-472949" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t recommend returning a sequence from the LSTM itself, instead use an encoder-decoder model:<br>
<a href="https://machinelearningmastery.com/start-here/#lstm" rel="nofollow">https://machinelearningmastery.com/start-here/#lstm</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-472949" data-commentid="472949" data-postid="6435" data-belowelement="comment-472949" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472983" class="comment even depth-5">

	      	<div id="li-comment-472983" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6f7379f1fb62a0192f7acb5c7ed9c21f.png" srcset="https://secure.gravatar.com/avatar/6f7379f1fb62a0192f7acb5c7ed9c21f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aaron</span>
	                <span class="date">March 7, 2019 at 10:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-472983" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why don’t you recommend returning a sequence from the LSTM? If I was using the below encoder-decoder model from another one of your posts, what would the output of the first LSTM be?</p>
<p>model = Sequential()<br>
model.add(LSTM(…, input_shape=(…)))<br>
model.add(RepeatVector(…))<br>
model.add(LSTM(…, return_sequences=True))<br>
model.add(TimeDistributed(Dense(…)))</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-473011" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-473011" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 7, 2019 at 2:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-473011" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally the output sequence from an LSTM is the activation of the nodes from each step in the input sequence. It is unlikely to capture anything meaningful.</p>
<p>It is better to interpret these activations or the final activations with more LSTM or Dense layers, and the output a sequence of the same or different lengths using a separate model.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-483672" class="comment even depth-5">

	      	<div id="li-comment-483672" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/2f7fb786be6bb0ffc26bebcf9fda23fc.png" srcset="https://secure.gravatar.com/avatar/2f7fb786be6bb0ffc26bebcf9fda23fc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.gideonprior.com/" rel="external nofollow" class="url">Gideon</a></span>
	                <span class="date">May 2, 2019 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483672" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi there,<br>
I love this tutorial, all of your tutorials actually but this one I have found the most helpful. Questions about the MIMO LSTM output shape has come up a few times, and I am also having trouble with it. </p>
<p>I am trying to use a Dense layer as my final layer as you suggest, passing it n_steps_out as an argument. I am predicting 3 variables and n_steps_out is 10. </p>
<p>Keras complains that it is expecting the dense layer to have 2 dimensions, but I am passing it an array with shape (n_samples,n_steps_out,n_features)</p>
<p>Can you help me make sense of this?</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-483697" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-483697" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 2, 2019 at 8:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483697" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend a model with a time distributed wrapper or decoder for multivariate multi-step output, so you can output one vector for each time step.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-474485" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-474485" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/737b732b4073bfa6e251c33578b8e35e.png" srcset="https://secure.gravatar.com/avatar/737b732b4073bfa6e251c33578b8e35e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abderrahim</span>
	                <span class="date">March 15, 2019 at 5:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-474485" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I have a question: are LSTM suitable for predicting based on a test set with the same nature of inputs as of train set ? Like in other cases of prediction where you will be having input signals in train set, that the model will work on. plus the memory based on the fact that entries are ordered.<br>
I trained an LSTM on a CNN model acting on ordered images, to predict a timeserie. on test set I have the following ordered set of images by time. I guess there is no concept of horizon here, how should I improve my model, and what starting point in predicting test set in this case?</p>
<p>Many thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-474485" data-commentid="474485" data-postid="6435" data-belowelement="comment-474485" data-respondelement="respond" aria-label="Reply to Abderrahim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-474606" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-474606" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 16, 2019 at 7:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-474606" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend modeling the raw time series directly, instead of images of the time series.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-474606" data-commentid="474606" data-postid="6435" data-belowelement="comment-474606" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-476325" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-476325" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a78cfbb67a3873ed3b62837e0cd6ac7a.png" srcset="https://secure.gravatar.com/avatar/a78cfbb67a3873ed3b62837e0cd6ac7a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tayson</span>
	                <span class="date">March 26, 2019 at 12:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476325" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, </p>
<p>Many thanks for the helpful article..<br>
I have tried to copy the code “Multiple Parallel Input and Multi-Step Output” and run it exactly the same without any changing but I got a different results than the one you got.</p>
<p>[ [<br>
    [147.56306 167.8626  312.92883]<br>
    [185.38152 205.36024 385.96536] ] ]</p>
<p>Is there any reason for that?</p>
<p>Best regards,<br>
Tayson</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476325" data-commentid="476325" data-postid="6435" data-belowelement="comment-476325" data-respondelement="respond" aria-label="Reply to Tayson">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-476382" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-476382" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 26, 2019 at 8:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476382" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, this is due to the stochastic nature of the learning algorithm, more here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-do-i-get-different-results-each-time-i-run-the-code" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-do-i-get-different-results-each-time-i-run-the-code</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476382" data-commentid="476382" data-postid="6435" data-belowelement="comment-476382" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-476327" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-476327" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/3b889b7b2917a01b21f705e1724c4a83.png" srcset="https://secure.gravatar.com/avatar/3b889b7b2917a01b21f705e1724c4a83?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chris</span>
	                <span class="date">March 26, 2019 at 1:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476327" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
How would you handle building the LSTM model for time series data with irregular time intervals (e.g. Jan 1, Jan 2, Jan 4, Jan 7, Jan 13, Jan 14, etc…)?</p>
<p>It appears this model presupposes a regular time-interval spacing.</p>
<p>You could fill the “missing” days with zeros or impute them with, say, the mean of the last 3 values, but  I would like to know how to make the LSTM model without filling/imputing the time series data.  How would you handle this?</p>
<p>Thanks, and great lesson.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476327" data-commentid="476327" data-postid="6435" data-belowelement="comment-476327" data-respondelement="respond" aria-label="Reply to Chris">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-476383" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-476383" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 26, 2019 at 8:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476383" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I would try many approaches and compare results, such as:</p>
<p>– model as is<br>
– normalize interval with padding<br>
– upsample/downsample to new intervals<br>
– etc.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476383" data-commentid="476383" data-postid="6435" data-belowelement="comment-476383" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-476514" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-476514" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/eb82e70d4de393b7110118d3be7f9aa4.png" srcset="https://secure.gravatar.com/avatar/eb82e70d4de393b7110118d3be7f9aa4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ron</span>
	                <span class="date">March 27, 2019 at 1:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476514" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If we are forecasting in monthly buckets and using 5 years of data, how do we know how many months of data to have on each row?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476514" data-commentid="476514" data-postid="6435" data-belowelement="comment-476514" data-respondelement="respond" aria-label="Reply to Ron">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-476578" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-476578" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 27, 2019 at 9:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476578" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps perform a sensitivity analysis of the model to see how history impacts model performance. </p>
<p>There will be a sweet spot for a given dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476578" data-commentid="476578" data-postid="6435" data-belowelement="comment-476578" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-476634" class="comment even depth-3 parent">

	      	<div id="li-comment-476634" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/eb82e70d4de393b7110118d3be7f9aa4.png" srcset="https://secure.gravatar.com/avatar/eb82e70d4de393b7110118d3be7f9aa4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ron</span>
	                <span class="date">March 27, 2019 at 1:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476634" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason! If the history has distinct patterns for each quarter, should we have 3 months in each row? How would the results differ when we keep 12 months on each row versus 3 months on each row versus 1 month on each row?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476634" data-commentid="476634" data-postid="6435" data-belowelement="comment-476634" data-respondelement="respond" aria-label="Reply to Ron">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-476642" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-476642" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 27, 2019 at 2:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476642" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Depends on the dataset, I recommend testing to discover the specific answers with your data and model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476642" data-commentid="476642" data-postid="6435" data-belowelement="comment-476642" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-476759" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-476759" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/5cb6c742358ce4279ef74379193a6680.png" srcset="https://secure.gravatar.com/avatar/5cb6c742358ce4279ef74379193a6680?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter</span>
	                <span class="date">March 28, 2019 at 5:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476759" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>I am trying to predict high and low value of a time series in next X days, my output layer in RNN is :</p>
<p>model.add(Dense(2, activation=’linear’))</p>
<p>so basically output vector is [y_high, y_low], the model works pretty well however it sometimes outputs y_low &gt; y_high, which of course doesn’t make any sense, is there a way to enforce model so that condition y_high &gt;= y_low is always met.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476759" data-commentid="476759" data-postid="6435" data-belowelement="comment-476759" data-respondelement="respond" aria-label="Reply to Peter">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-476801" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-476801" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 28, 2019 at 8:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476801" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Interesting, perhaps you simplify the problem and predict a value in a discrete ordinal interval, e.g. each category is a blocks of values?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-476801" data-commentid="476801" data-postid="6435" data-belowelement="comment-476801" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-477031" class="comment even depth-3 parent">

	      	<div id="li-comment-477031" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/5cb6c742358ce4279ef74379193a6680.png" srcset="https://secure.gravatar.com/avatar/5cb6c742358ce4279ef74379193a6680?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter</span>
	                <span class="date">March 29, 2019 at 3:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477031" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I was trying to modify loss function but I am unable to access y_pred individual members, I don’t even know whether it’s ultimately possible.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477031" data-commentid="477031" data-postid="6435" data-belowelement="comment-477031" data-respondelement="respond" aria-label="Reply to Peter">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-477116" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-477116" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2019 at 8:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477116" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t follow, why not? What is the error?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477116" data-commentid="477116" data-postid="6435" data-belowelement="comment-477116" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-477029" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-477029" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/9ecc8390ae48b09a6d4268aba46997d4.png" srcset="https://secure.gravatar.com/avatar/9ecc8390ae48b09a6d4268aba46997d4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joe</span>
	                <span class="date">March 29, 2019 at 2:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477029" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, a colleague and I are thinking of trying an LSTM model for time series forecasting. We are faced with over a thousand potential predictors, and would like to select only a smaller number for the final model. In particular, I have recently become fascinated by SHAP values; e.g., see this informal blog post by Scott Lundberg himself, in the context of XGBoost.<br>
<a href="https://towardsdatascience.com/interpretable-machine-learning-with-xgboost-9ec80d148d27" rel="nofollow">https://towardsdatascience.com/interpretable-machine-learning-with-xgboost-9ec80d148d27</a></p>
<p>Tantalizingly, Scott L. demonstrates SHAP values in the context of an LSTM model here:<br>
<a href="https://slundberg.github.io/shap/notebooks/deep_explainer/Keras%20LSTM%20for%20IMDB%20Sentiment%20Classification.html" rel="nofollow">https://slundberg.github.io/shap/notebooks/deep_explainer/Keras%20LSTM%20for%20IMDB%20Sentiment%20Classification.html</a><br>
But that is using text input (sentiment classification in the IMDB data set), which involves an Embedding layer just before the LSTM layer. For a non-text problem like time series forecasting, we would exclude the Embedding layer. But doing so breaks the code.</p>
<p>Do you have any suggestions how SHAP values might be used in the context of LSTMs for time series forecasting (not text processing)? If not, do you have any suggestions for feature selection in that context?</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477029" data-commentid="477029" data-postid="6435" data-belowelement="comment-477029" data-respondelement="respond" aria-label="Reply to Joe">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-477115" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-477115" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2019 at 8:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477115" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t know what SHAP is, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477115" data-commentid="477115" data-postid="6435" data-belowelement="comment-477115" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-477212" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-477212" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/22162f7142a95b45452792f6553af97b.png" srcset="https://secure.gravatar.com/avatar/22162f7142a95b45452792f6553af97b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hsin</span>
	                <span class="date">March 29, 2019 at 5:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477212" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thanks for this useful tutorial.<br>
I am confused to inverse scaling of my data after splitting it into the form:<br>
x(data_length, n_step, feature)<br>
Because the scaler only can be used in 2D condition.</p>
<p>What I want to do is evaluate rmse between prediction and true values, so I have to<br>
inverse transform data. Could you please tell me how to deal with this problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477212" data-commentid="477212" data-postid="6435" data-belowelement="comment-477212" data-respondelement="respond" aria-label="Reply to Hsin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-477326" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-477326" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 30, 2019 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477326" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I show how here:<br>
<a href="https://machinelearningmastery.com/machine-learning-data-transforms-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/machine-learning-data-transforms-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477326" data-commentid="477326" data-postid="6435" data-belowelement="comment-477326" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-477280" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-477280" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/0d30d08bf853ab898e95dc1b3b90bf20.jpeg" srcset="https://secure.gravatar.com/avatar/0d30d08bf853ab898e95dc1b3b90bf20?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pratik</span>
	                <span class="date">March 30, 2019 at 12:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477280" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Firstly, I must say you have a fabulous chunk of articles on ML/DL. Thanks for helping out the community at large. </p>
<p>Coming to LSTMs, I am stuck in one problem from last few days. Here is how it goes –<br>
I have 3 columns namely customer id and basket_index and timestamp. For every customer, each row represents one time stamp. Lets say there are 3 customers with variable time stamps. First one is having 30 time stamps, 2nd is having 25 and 3rd is having 50. So, the total number of rows are 105. Now for the column basket index, each row signifies a list of product keys bought by any customer on a particular timestamp. Here is the snapshot of the dataset – </p>
<p>CustomerID        basket_index     timestamp       predicted_basket<br>
111                    [1,2,3]                 1                     [4,5]<br>
111                    [4,5]                    2                     [9,7]<br>
111                    [9,7]                    3                     [3,5,6,1]<br>
.<br>
.<br>
222                    [6,2,3]                 1                     [1,0,2,5]<br>
222                    [1,0,2,5]              2                     [7,5]<br>
.<br>
.<br>
333<br>
.<br>
. and so on..<br>
Now, since every customer has a different time series, </p>
<p>1) How to pass everything into one network?<br>
2) Do I have to build multiple LSTM models (one for each customer) in this case?</p>
<p>3) Also, I am creating an embedding layer for both customer and product keys (taking mean for every basket). How to specify how many steps back does every time series look in such cases?<br>
4) How should I specify batch size in this case? </p>
<p>Your help will be really appreciated. Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477280" data-commentid="477280" data-postid="6435" data-belowelement="comment-477280" data-respondelement="respond" aria-label="Reply to Pratik">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-477336" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-477336" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 30, 2019 at 6:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477336" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question, I have some suggestions here that might help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-to-develop-forecast-models-for-multiple-sites" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-to-develop-forecast-models-for-multiple-sites</a></p>
<p>Generally, I would encourage you to try to learn across customers.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477336" data-commentid="477336" data-postid="6435" data-belowelement="comment-477336" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-477287" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-477287" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/eff9b6c233ebb61eb7cb272d781739b5.png" srcset="https://secure.gravatar.com/avatar/eff9b6c233ebb61eb7cb272d781739b5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Huiping</span>
	                <span class="date">March 30, 2019 at 1:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477287" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for nice post.</p>
<p>One question hopes to get your guide: For a LSTM work, we can’t stop on say the model is good but most important is how to use the good model outcome.</p>
<p>For example flu or not for patients. Now I want to predict the flu for future half year (Jun-2019 to Dec-2019) but what I have is history data (I have past 4 years those people’s flu data and target on that model is half year from 6-1-2018 to 12-31-2018).</p>
<p> How can I apply history LSTM outcome to predict future? </p>
<p> Can I get a list of important features from the history model with some value(like a weight) and apply this to my future data?</p>
<p>Or can i get the list of important feature from a good fit LSTM model and those features are important than other features?</p>
<p>Appreciate your guide!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477287" data-commentid="477287" data-postid="6435" data-belowelement="comment-477287" data-respondelement="respond" aria-label="Reply to Huiping">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-477337" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-477337" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 30, 2019 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477337" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-477337" data-commentid="477337" data-postid="6435" data-belowelement="comment-477337" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-478227" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-478227" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/72065d7dda512e7c480b533226ca5f2a.png" srcset="https://secure.gravatar.com/avatar/72065d7dda512e7c480b533226ca5f2a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jeyson Hernández</span>
	                <span class="date">April 3, 2019 at 11:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-478227" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Amazing work! Thanks sharing us your knowledge, this tutorial was so helpfull.</p>
<p>I’m new in ML/DL, i’m trying to predict sales in a company for future six months using LSTM. But i have an issue, i’m not sure about how to get more than 1 next step from your code using just one x vector by input. I’m using a monthly time step </p>
<p>Could you help me to understand a little bit better how to get it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-478227" data-commentid="478227" data-postid="6435" data-belowelement="comment-478227" data-respondelement="respond" aria-label="Reply to Jeyson Hernández">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-478260" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-478260" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 3, 2019 at 4:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-478260" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There are many examples of multi-step forecasting that you can use, including in the above tutorial.</p>
<p>There are also more examples here:<br>
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-478260" data-commentid="478260" data-postid="6435" data-belowelement="comment-478260" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-478441" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-478441" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/46269dcb8f0324b02d902516a84e8416.png" srcset="https://secure.gravatar.com/avatar/46269dcb8f0324b02d902516a84e8416?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://iict.buet.ac.bd/" rel="external nofollow" class="url">Md. Abul Kalam Azad</a></span>
	                <span class="date">April 4, 2019 at 3:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-478441" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Sir,</p>
<p>Thanks for your sharing example. I have collected traffic information like (Road property, weather, datetime,adjacent road speed, target road speed and more) for predicting road speed. Currently, I have prepared my code using Vanilla LSTM model for one step as well as multi-step-ahead prediction. Can you suggest me for which below model will be best for road speed prediction with higher accuracy?</p>
<p>Models are:<br>
    Data Preparation<br>
    Vanilla LSTM<br>
    Stacked LSTM<br>
    Bidirectional LSTM<br>
    CNN LSTM<br>
    ConvLSTM</p>
<p>I am waiting for your response.</p>
<p>Thanks,<br>
Azad</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-478441" data-commentid="478441" data-postid="6435" data-belowelement="comment-478441" data-respondelement="respond" aria-label="Reply to Md. Abul Kalam Azad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-478543" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-478543" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 5, 2019 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-478543" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend testing a suite of model types and model configurations in order to discover what works best for your specific dataset, you can learn more here:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-478543" data-commentid="478543" data-postid="6435" data-belowelement="comment-478543" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-479101" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-479101" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/3da207e90f1b15efa2a44ab465b5d00e.png" srcset="https://secure.gravatar.com/avatar/3da207e90f1b15efa2a44ab465b5d00e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fazano</span>
	                <span class="date">April 8, 2019 at 8:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-479101" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi Jason, im using vanilla LSTM for forecasting,and i want to forecast 10 days ahead using this code</p>
<p># Forecat real future</p>
<p># Number of desired forecast in the future<br>
L=10<br>
#creat  inputs and output empty matrices for future forecasting<br>
Future_input=np.zeros((L,3))<br>
Future=np.zeros((L,1))</p>
<p>#add last 3 forecast as input for forecasting next day (tommorow)<br>
Future_input[0,:]=[predict[-3],predict[-2],predict[-1]]<br>
#create 3 dimension input for LSTM inputs<br>
Future_input= np.reshape(Future_input,(Future_input.shape[0],1,Future_input.shape[1]))<br>
#predict tommorrow value<br>
Future[0,0]=model.predict(np.expand_dims(Future_input[0],axis=0))</p>
<p>#Loop to predict next 9 days values<br>
for i in range (0,9):<br>
	Future_input[i+1,0,:]=np.roll(Future_input[i,0,:], -1, axis=0)<br>
	Future_input[i+1,0,2]=Future[i,0]<br>
	Future[i+1,0]=model.predict(np.expand_dims(Future_input[i],axis=0))</p>
<p>#print 10 day ahead values<br>
print(Future)</p>
<p>can it be like that?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-479101" data-commentid="479101" data-postid="6435" data-belowelement="comment-479101" data-respondelement="respond" aria-label="Reply to Fazano">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-479181" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-479181" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 9, 2019 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-479181" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I cannot debug your code.</p>
<p>If you need more help with multi-step forecasting, see this:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-you-use-lstms-for-multi-step-time-series-forecasting" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-you-use-lstms-for-multi-step-time-series-forecasting</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-479181" data-commentid="479181" data-postid="6435" data-belowelement="comment-479181" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-480031" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-480031" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/5cd8610a353fd722a7c29d228ad64833.png" srcset="https://secure.gravatar.com/avatar/5cd8610a353fd722a7c29d228ad64833?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sher</span>
	                <span class="date">April 13, 2019 at 2:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-480031" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, do you have any tips for implementing univariate ConvLSTM for two-dimensional spatial-temporal data? I’m trying to input 10 time steps of 55 x 55 images for single-step time series forecasting. </p>
<p>The following error code appears:<br>
“ValueError: Error when checking target: expected dense_10 to have 2 dimensions, but got array with shape (10, 55, 55)”</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-480031" data-commentid="480031" data-postid="6435" data-belowelement="comment-480031" data-respondelement="respond" aria-label="Reply to Sher">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-480092" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-480092" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 13, 2019 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-480092" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have a tutorial on the topic.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-480092" data-commentid="480092" data-postid="6435" data-belowelement="comment-480092" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-480061" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-480061" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/f75b9c9edb4257fe072f16d40bea3081.png" srcset="https://secure.gravatar.com/avatar/f75b9c9edb4257fe072f16d40bea3081?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Randy</span>
	                <span class="date">April 13, 2019 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-480061" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Sir,<br>
i have sequence 1247 data and i want to forecast 30 next, so the data would be 1277.<br>
i follow this tutorial, but it just can 1 or 2 forecast. and i follow this tutorial</p>
<p><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/</a> </p>
<p>but i get little confusion. so you have any advise to me?<br>
its stock price data actually.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-480061" data-commentid="480061" data-postid="6435" data-belowelement="comment-480061" data-respondelement="respond" aria-label="Reply to Randy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-480101" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-480101" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 13, 2019 at 6:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-480101" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Stock prices are not predictable:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-help-me-with-machine-learning-for-finance-or-the-stock-market" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/can-you-help-me-with-machine-learning-for-finance-or-the-stock-market</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-480101" data-commentid="480101" data-postid="6435" data-belowelement="comment-480101" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-481203" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-481203" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/c47306ae25c55a0920d04c071889bb79.jpeg" srcset="https://secure.gravatar.com/avatar/c47306ae25c55a0920d04c071889bb79?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lloyd</span>
	                <span class="date">April 19, 2019 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-481203" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Amazing Tutorial, thank you.</p>
<p>I have a question, is there a model where the outputs can influence each other? </p>
<p>I.e. you have multiple sequences all which move independently but can influence the others?</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-481203" data-commentid="481203" data-postid="6435" data-belowelement="comment-481203" data-respondelement="respond" aria-label="Reply to Lloyd">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481253" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-481253" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 19, 2019 at 3:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-481253" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Yes, an encoder-decoder model that outputs a time step for each series in concert might be such an approach.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-481253" data-commentid="481253" data-postid="6435" data-belowelement="comment-481253" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-481322" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-481322" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/5b79a284193132d439d8e3a7faf48a96.png" srcset="https://secure.gravatar.com/avatar/5b79a284193132d439d8e3a7faf48a96?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jules</span>
	                <span class="date">April 19, 2019 at 10:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-481322" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Awesome. Great Explanation as always.  I have always got rather  frustrated and confused over the shape of data going into Keras models. So I relied upon your tutorials to make it clear. </p>
<p>Anyway using your examples I have been able demonstrate use of LSTM in predicting simple 2-D ballistics prediction calculations. I have used your code to help me here. </p>
<p><a href="https://github.com/JulesVerny/BallisticsRNNPredictions" rel="nofollow">https://github.com/JulesVerny/BallisticsRNNPredictions</a></p>
<p>Pygame is required to animate the simulations</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-481322" data-commentid="481322" data-postid="6435" data-belowelement="comment-481322" data-respondelement="respond" aria-label="Reply to Jules">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481398" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-481398" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 20, 2019 at 7:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-481398" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done, your project is very cool!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-481398" data-commentid="481398" data-postid="6435" data-belowelement="comment-481398" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-481336" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-481336" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/14c345a236541830861684bfe531fabc.png" srcset="https://secure.gravatar.com/avatar/14c345a236541830861684bfe531fabc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kishore</span>
	                <span class="date">April 19, 2019 at 11:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-481336" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Prof,</p>
<p>Imagine I have raw text containing only words ‘N1,N2,N3,………….,N1000’ in a shuffled format , i.e, 1 million words, each of which can belong to any of these 1000 words.</p>
<p>I want to select the number of time steps =5, and predict the next word.<br>
Eg: An input of [N1,N6,N5,N88,N32] would be followed by ‘N73′.</p>
<p>Now, assume that I have tokenized all the 1000 possible words into numbers.</p>
<p>This is a scenario with 1000 possible output classes.<br>
So should I replace model.add(Dense(1)) with model.add(Dense(1000,activation=’softmax’)) ?<br>
If not, what is the main change I need to make, as compared to your univariate stacked LSTM code ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-481336" data-commentid="481336" data-postid="6435" data-belowelement="comment-481336" data-respondelement="respond" aria-label="Reply to Kishore">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481401" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-481401" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 20, 2019 at 7:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-481401" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If the words are shuffled, then there would be no structure for a model to learn.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-481401" data-commentid="481401" data-postid="6435" data-belowelement="comment-481401" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-482186" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-482186" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/17b4fadc4e5c135c1a672c5e1c0b3ec9.png" srcset="https://secure.gravatar.com/avatar/17b4fadc4e5c135c1a672c5e1c0b3ec9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HK</span>
	                <span class="date">April 23, 2019 at 8:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482186" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason!</p>
<p>I’m trying to use stacked lstm for this problem – Multiple Parallel Input and Multi-Step Output.<br>
However I’m not sure how the final Dense layer should look like. Could you give me some hints, please?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482186" data-commentid="482186" data-postid="6435" data-belowelement="comment-482186" data-respondelement="respond" aria-label="Reply to HK">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-482274" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-482274" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 24, 2019 at 7:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482274" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps start with the example in the above post and then add an additional LSTM layer?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482274" data-commentid="482274" data-postid="6435" data-belowelement="comment-482274" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483129" class="comment even depth-3 parent">

	      	<div id="li-comment-483129" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/17b4fadc4e5c135c1a672c5e1c0b3ec9.png" srcset="https://secure.gravatar.com/avatar/17b4fadc4e5c135c1a672c5e1c0b3ec9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HK</span>
	                <span class="date">April 29, 2019 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483129" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Which example do you mean? I can’t find any example for Multiple parallel input and multi step output LSTM, which uses stacked LSTM layers instead of encoder decoder.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483129" data-commentid="483129" data-postid="6435" data-belowelement="comment-483129" data-respondelement="respond" aria-label="Reply to HK">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483160" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-483160" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 29, 2019 at 8:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483160" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, under the section “Multivariate Multi-Step LSTM Models”</p>
<p>Specifically the subsection “Multiple Parallel Input and Multi-Step Output”</p>
<p>The examples can be adapted to use any models you wish.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483160" data-commentid="483160" data-postid="6435" data-belowelement="comment-483160" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-482482" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-482482" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/ea52cc526b1f2706be202af3e6676f6c.png" srcset="https://secure.gravatar.com/avatar/ea52cc526b1f2706be202af3e6676f6c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Raman Singh</span>
	                <span class="date">April 25, 2019 at 8:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482482" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for detailed  explanation.</p>
<p>Could you please tell how can we add hyperparameters for tuning “Forget Gate”, Input Gate” and “Output Gate” in LSTM  compile or fit methods or is it done internally and we can’t control these gates?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482482" data-commentid="482482" data-postid="6435" data-belowelement="comment-482482" data-respondelement="respond" aria-label="Reply to Raman Singh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-482483" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-482483" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 25, 2019 at 8:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482483" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>They are not tuned.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482483" data-commentid="482483" data-postid="6435" data-belowelement="comment-482483" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-482517" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-482517" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/380eb7a680e87da21516dca43d0f2a5f.png" srcset="https://secure.gravatar.com/avatar/380eb7a680e87da21516dca43d0f2a5f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">will</span>
	                <span class="date">April 25, 2019 at 1:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482517" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How to predict multiple such inputs， x_input = array([[70,75,145], [80,85,165], [90,95,185],…,[200,205,405]]),Expect the next output， [210,215,425]，<br>
See this input in the article，x_input = array([[70,75,145], [80,85,165], [90,95,185]])，Predict such results，[[101.76599 108.730484 206.63577 ]]，But it doesn’t seem to matter why you need to enter such a sequence.in_seq1 = array([10, 20, 30, 40, 50, 60, 70, 80, 90])，in_seq2 = array([15, 25, 35, 45, 55, 65, 75, 85, 95])<br>
thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482517" data-commentid="482517" data-postid="6435" data-belowelement="comment-482517" data-respondelement="respond" aria-label="Reply to will">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-482528" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-482528" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 25, 2019 at 2:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482528" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe there is a few multi-time step models listed above that will provide a good starting point.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482528" data-commentid="482528" data-postid="6435" data-belowelement="comment-482528" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-482546" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-482546" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a22b10e5d97b45aef504a3238a7a859b.png" srcset="https://secure.gravatar.com/avatar/a22b10e5d97b45aef504a3238a7a859b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">John</span>
	                <span class="date">April 25, 2019 at 4:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482546" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the article.<br>
I was working with your code and planning to implement in my work, but I have noticed a different behavior. If I compile and run the code different times, it gives different result each time although I didn’t change anything in your code. I have tried with your example data and run several times and each time I got different results. I tried with my own dataset and the result is the same. </p>
<p>Now I am confused to implement LSTM in my work.<br>
Could you please clarify this behavior?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482546" data-commentid="482546" data-postid="6435" data-belowelement="comment-482546" data-respondelement="respond" aria-label="Reply to John">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-482649" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-482649" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 26, 2019 at 8:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482649" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, this is to be expected. You can learn more here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-do-i-get-different-results-each-time-i-run-the-code" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-do-i-get-different-results-each-time-i-run-the-code</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482649" data-commentid="482649" data-postid="6435" data-belowelement="comment-482649" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-482774" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-482774" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a593cbbeac050dbf0431c595ebf6fa35.png" srcset="https://secure.gravatar.com/avatar/a593cbbeac050dbf0431c595ebf6fa35?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shiva</span>
	                <span class="date">April 26, 2019 at 10:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482774" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi jason,</p>
<p>Say we have 3 variates(X).. and 1 dependent (Y)<br>
The relation of 2 variate in X is like for 3 lags and 1 variate is  30 lag.</p>
<p>What is your advice when we have to model in such case?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482774" data-commentid="482774" data-postid="6435" data-belowelement="comment-482774" data-respondelement="respond" aria-label="Reply to Shiva">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-482833" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-482833" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 27, 2019 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482833" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have many examples, including a few above.</p>
<p>I also have a tutorial here that might help as a starting point:<br>
<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-482833" data-commentid="482833" data-postid="6435" data-belowelement="comment-482833" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-483032" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-483032" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1f9dc39e2ae7b900652e11de7f561f9b.png" srcset="https://secure.gravatar.com/avatar/1f9dc39e2ae7b900652e11de7f561f9b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Raghu</span>
	                <span class="date">April 28, 2019 at 3:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483032" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the very informative tutorial. Can you please throw more light on how to come up with confidence intervals for the predicted value</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483032" data-commentid="483032" data-postid="6435" data-belowelement="comment-483032" data-respondelement="respond" aria-label="Reply to Raghu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483144" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-483144" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 29, 2019 at 8:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483144" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do you mean prediction intervals instead of confidence intervals?</p>
<p>Perhaps start here:<br>
<a href="https://machinelearningmastery.com/prediction-intervals-for-machine-learning/" rel="nofollow">https://machinelearningmastery.com/prediction-intervals-for-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483144" data-commentid="483144" data-postid="6435" data-belowelement="comment-483144" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-483083" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-483083" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/20c826ccffa490a572dba69b3c45ea04.png" srcset="https://secure.gravatar.com/avatar/20c826ccffa490a572dba69b3c45ea04?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">parsa</span>
	                <span class="date">April 28, 2019 at 10:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483083" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason<br>
Thanks for your helpful tutorial<br>
Could you please tell how can we predict the futures that we don’t have its data available<br>
for example, I finalized my LSTM model, how can I predict the values on 2050</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483083" data-commentid="483083" data-postid="6435" data-belowelement="comment-483083" data-respondelement="respond" aria-label="Reply to parsa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483152" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-483152" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 29, 2019 at 8:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483152" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I show how in this post:<br>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483152" data-commentid="483152" data-postid="6435" data-belowelement="comment-483152" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-483089" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-483089" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/380eb7a680e87da21516dca43d0f2a5f.png" srcset="https://secure.gravatar.com/avatar/380eb7a680e87da21516dca43d0f2a5f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">will</span>
	                <span class="date">April 28, 2019 at 11:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483089" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the article.However, I have a problem that every prediction results are different, such as Multiple Parallel Series，The first time is [[101.25582 106.49429 207.8928 ]]，The second time it became [[101.82945  107.527626 209.8016  ]]，Why is this?<br>
thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483089" data-commentid="483089" data-postid="6435" data-belowelement="comment-483089" data-respondelement="respond" aria-label="Reply to will">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483153" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-483153" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 29, 2019 at 8:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483153" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-do-i-get-different-results-each-time-i-run-the-code" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-do-i-get-different-results-each-time-i-run-the-code</a></p>
<p>I recommend that you try to run the example a few times.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483153" data-commentid="483153" data-postid="6435" data-belowelement="comment-483153" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-483114" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-483114" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a593cbbeac050dbf0431c595ebf6fa35.png" srcset="https://secure.gravatar.com/avatar/a593cbbeac050dbf0431c595ebf6fa35?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shiva</span>
	                <span class="date">April 29, 2019 at 4:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483114" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I want to restate my question…<br>
Suppose we are trying to model a water bucket that was 1 open inlet at the top and 2  outlets at the side one near the top and one near the bottom.<br>
this will mean that the outlet at the top can release when the water is really good..<br>
the outlet near the bottom has release which is exponential function of water above it.</p>
<p>now say such  systems are in paralell(one above another, say2) and series(say 2, the final outlet  from each parallel series join at the final output.) (Total 4 buckets).</p>
<p>can this be modeled by LSTM?<br>
I have done this analytically…results are ok ..<br>
tyring to use lstm for this ,,,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483114" data-commentid="483114" data-postid="6435" data-belowelement="comment-483114" data-respondelement="respond" aria-label="Reply to shiva">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483158" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-483158" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 29, 2019 at 8:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483158" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps.</p>
<p>You can use this framework to explore different framings of your problem:<br>
<a href="http://machinelearningmastery.com/how-to-define-your-machine-learning-problem/" rel="nofollow">http://machinelearningmastery.com/how-to-define-your-machine-learning-problem/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483158" data-commentid="483158" data-postid="6435" data-belowelement="comment-483158" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-483237" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-483237" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a21a71c4879af7e9f5c2f94a4fee54fa.png" srcset="https://secure.gravatar.com/avatar/a21a71c4879af7e9f5c2f94a4fee54fa?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali</span>
	                <span class="date">April 29, 2019 at 7:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483237" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>to the step:</p>
<p># define input sequence<br>
in_seq1 = array([10, 20, 30, 40, 50, 60, 70, 80, 90])<br>
in_seq2 = array([15, 25, 35, 45, 55, 65, 75, 85, 95])</p>
<p>I want to ask how I can load a fully column out of a dataset.<br>
I don´t want to insert each value because I have more than 22 million rows. After that I want to split into sequences of 200-400 time steps.</p>
<p>To the step:</p>
<p>out_seq = array([in_seq1[i]+in_seq2[i] for i in range(len(in_seq1))])</p>
<p>I don´t have a right mathematical equation. I want to predict the output without any knowledge about the relationship between the input signals.</p>
<p>I hope you can help me.</p>
<p>Kind regards</p>
<p>Ali</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483237" data-commentid="483237" data-postid="6435" data-belowelement="comment-483237" data-respondelement="respond" aria-label="Reply to Ali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483321" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-483321" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 30, 2019 at 6:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483321" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have many examples, perhaps start here:<br>
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483321" data-commentid="483321" data-postid="6435" data-belowelement="comment-483321" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-483243" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-483243" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6d1931d9feeb0a423c57c558d2ee6e2e.png" srcset="https://secure.gravatar.com/avatar/6d1931d9feeb0a423c57c558d2ee6e2e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://na/" rel="external nofollow" class="url">Sree</a></span>
	                <span class="date">April 29, 2019 at 8:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483243" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for these explanations and sample codes! </p>
<p>I was interested in the example you have provided for multi-variate version of LSTM. You have provided an example of a simple addition case. How can this be extended to instances where there are multiple inputs, but an exact relation between the inputs are not known even though it is known that the inputs are correlated? Thanks much for your guidance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483243" data-commentid="483243" data-postid="6435" data-belowelement="comment-483243" data-respondelement="respond" aria-label="Reply to Sree">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483323" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-483323" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 30, 2019 at 6:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483323" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The model will learn the relationship, addition was just for demonstration.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483323" data-commentid="483323" data-postid="6435" data-belowelement="comment-483323" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-483545" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-483545" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6d1931d9feeb0a423c57c558d2ee6e2e.png" srcset="https://secure.gravatar.com/avatar/6d1931d9feeb0a423c57c558d2ee6e2e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://na/" rel="external nofollow" class="url">Sree</a></span>
	                <span class="date">May 1, 2019 at 9:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483545" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason! That’s perfect.</p>
<p>In that case, what should the statement “out_seq = array([in_seq1[i]+in_seq2[i] for i in range(len(in_seq1))])” be replaced by, since we don’t know the exact relation between the variables? Thanks again!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483545" data-commentid="483545" data-postid="6435" data-belowelement="comment-483545" data-respondelement="respond" aria-label="Reply to Sree">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483576" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-483576" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 1, 2019 at 2:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483576" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Observations across multiple input time series are aligned to time steps based on their time of observation.</p>
<p>Perhaps this will make things clearer:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483576" data-commentid="483576" data-postid="6435" data-belowelement="comment-483576" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-483769" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-483769" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6d1931d9feeb0a423c57c558d2ee6e2e.png" srcset="https://secure.gravatar.com/avatar/6d1931d9feeb0a423c57c558d2ee6e2e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://na/" rel="external nofollow" class="url">Sree</a></span>
	                <span class="date">May 2, 2019 at 8:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483769" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason. I shall read the content on that link.</p>
<p>Cheers,<br>
Sree.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483769" data-commentid="483769" data-postid="6435" data-belowelement="comment-483769" data-respondelement="respond" aria-label="Reply to Sree">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-483815" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-483815" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/2f7fb786be6bb0ffc26bebcf9fda23fc.png" srcset="https://secure.gravatar.com/avatar/2f7fb786be6bb0ffc26bebcf9fda23fc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.gideonprior.com/" rel="external nofollow" class="url">Gideon</a></span>
	                <span class="date">May 3, 2019 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483815" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, thank you again. I think my previous question could be made more clear.<br>
I would like to use the vector output approach for a mimo lstm, making multi step predictions into the future similar to your encoder/decoder example. </p>
<p>I have tried using the split_sequences method from the encoder/decoder example with the vector output example and the dimensions dont work out. I end up with a value error</p>
<p>ValueError: Error when checking target: expected dense_2 to have 2 dimensions, but got array with shape (5, 2, 3)</p>
<p>I greatly appreciate your help, I have been struggling with this for a while. I would imagine the output should be a matrix (number of features X prediction horizon) so I think there is something conceptually I am not understanding.</p>
<p>Thank you, and thank you for all of the wonderful tutorials</p>
<p>Gideon</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483815" data-commentid="483815" data-postid="6435" data-belowelement="comment-483815" data-respondelement="respond" aria-label="Reply to Gideon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483831" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-483831" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 3, 2019 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483831" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps start wit the code example you want to use and slowly change it for your needs.</p>
<p>If the data size does not match the models expectations, you will need to change the data shape or change the model’s expectations.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483831" data-commentid="483831" data-postid="6435" data-belowelement="comment-483831" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483835" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-483835" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/2f7fb786be6bb0ffc26bebcf9fda23fc.png" srcset="https://secure.gravatar.com/avatar/2f7fb786be6bb0ffc26bebcf9fda23fc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.gideonprior.com/" rel="external nofollow" class="url">Gideon</a></span>
	                <span class="date">May 3, 2019 at 7:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483835" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I will toil away some more, but I just want to be sure it is possible to use a dense layer/vector output approach for Multiple Parallel Input and Multi-Step Output LSTM in Keras.<br>
Thanks again for your time.</p>
<p>Gideon</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483835" data-commentid="483835" data-postid="6435" data-belowelement="comment-483835" data-respondelement="respond" aria-label="Reply to Gideon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483865" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-483865" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 3, 2019 at 2:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483865" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is possible to use a Dense for multi-step multivariate output without a decoder or timedistributed wrapper layer, it is just ugly.</p>
<p>E.g. the output would be a vector with n x m nodes, where n is number of variates and m is the number of steps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483865" data-commentid="483865" data-postid="6435" data-belowelement="comment-483865" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483959" class="comment odd alt depth-5">

	      	<div id="li-comment-483959" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/2f7fb786be6bb0ffc26bebcf9fda23fc.png" srcset="https://secure.gravatar.com/avatar/2f7fb786be6bb0ffc26bebcf9fda23fc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.gideonprior.com/" rel="external nofollow" class="url">Gideon Prior</a></span>
	                <span class="date">May 4, 2019 at 8:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483959" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ive figured it out, and its not too ugly and exactly what I needed. I was unaware of the Reshape layer in Keras.</p>
<p>    from keras.layers import  Reshape</p>
<p>…</p>
<p>    model.add(Dense(n_steps_out*n_features))<br>
    model.add(Reshape((n_steps_out,n_features)))</p>
<p>Thank you again for your help. I am buying your book right now. </p>
<p>Cheers</p>
<p>Gideon</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-484069" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-484069" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 5, 2019 at 6:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484069" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-493240" class="comment odd alt depth-4">

	      	<div id="li-comment-493240" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/0ae0fef65c7021823ebb2c023c729e15.png" srcset="https://secure.gravatar.com/avatar/0ae0fef65c7021823ebb2c023c729e15?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">George</span>
	                <span class="date">July 17, 2019 at 11:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493240" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Gideon,</p>
<p>I was struggling around something similar and applying your solution, solved all the matters! Do you have any more documentation on this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493240" data-commentid="493240" data-postid="6435" data-belowelement="comment-493240" data-respondelement="respond" aria-label="Reply to George">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-483902" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-483902" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/c1f9bd7b609cfc7f3f15b2609ffd112a.png" srcset="https://secure.gravatar.com/avatar/c1f9bd7b609cfc7f3f15b2609ffd112a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alberto</span>
	                <span class="date">May 3, 2019 at 11:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483902" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, </p>
<p>Great article, very useful. I want to use LSTM to predict sun irradiance 12 hours ahead using 8 features (including sun irradiance) of the last 24 hours as inputs. Thus, it would be a multivariate multi-step LSTM where the output is a sequence of 12 timesteps. I have 8 years of data and I want to use first 6 for training and last 2 for testing. I have some questions:</p>
<p>1) Should I overlap the input sequences?</p>
<p>2) Should I use a vector output model or an encoder-decoder model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483902" data-commentid="483902" data-postid="6435" data-belowelement="comment-483902" data-respondelement="respond" aria-label="Reply to Alberto">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483947" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-483947" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 4, 2019 at 7:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483947" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend testing both approaches and use data to make the decision, e.g. choose the model that gives the best result.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-483947" data-commentid="483947" data-postid="6435" data-belowelement="comment-483947" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484047" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-484047" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/7d40e6dbf3dec3961e9b595a66bab689.png" srcset="https://secure.gravatar.com/avatar/7d40e6dbf3dec3961e9b595a66bab689?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">aravind</span>
	                <span class="date">May 5, 2019 at 3:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484047" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hai jason,<br>
the article was very much helpful.<br>
can you just tell me which approach should I take if I have two columns in my dataset .<br>
one is time in ddmmyyyy format and the other is stock price.<br>
I have the data for last 12 months.<br>
I want to  predict the stock price for 4 upcoming months.<br>
how can I do the same.<br>
one more doubt is that if the column for time is not actually having a same interval in between them, then is there anything more that I should do to or consider for predicting the 4 upcoming months stock price</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484047" data-commentid="484047" data-postid="6435" data-belowelement="comment-484047" data-respondelement="respond" aria-label="Reply to aravind">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484091" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-484091" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 5, 2019 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484091" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can drop the date if all observations have a consistent interval.</p>
<p>Stock prices are not predictable:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-help-me-with-machine-learning-for-finance-or-the-stock-market" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/can-you-help-me-with-machine-learning-for-finance-or-the-stock-market</a></p>
<p>Regardless, I would recommend this process:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484091" data-commentid="484091" data-postid="6435" data-belowelement="comment-484091" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484132" class="comment even depth-3 parent">

	      	<div id="li-comment-484132" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/7d40e6dbf3dec3961e9b595a66bab689.png" srcset="https://secure.gravatar.com/avatar/7d40e6dbf3dec3961e9b595a66bab689?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">aravind</span>
	                <span class="date">May 5, 2019 at 3:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484132" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So after dropping the dates column I guess I would have to go for a univariate multistep lstm model. right?<br>
And what should be done if seasonality comes into picture?<br>
and one more doubt is that when I am predicting the four upcoming months in a multistep , will the model consider the predicted value of 3rd month while predicting the fourth month or will the model consider the predicted value of 2rd month while predicting the third month and likewise ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484132" data-commentid="484132" data-postid="6435" data-belowelement="comment-484132" data-respondelement="respond" aria-label="Reply to aravind">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484179" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-484179" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 6, 2019 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484179" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Try a suite of models, and compare to a linear model or naive model to confirm they have skill.</p>
<p>If you have seasonality, try modeling with and without the seasonality and compare performance.</p>
<p>Try multiple approaches for multi-step prediction, e.g. direct, recursive, etc:<br>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484179" data-commentid="484179" data-postid="6435" data-belowelement="comment-484179" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484263" class="comment even depth-5">

	      	<div id="li-comment-484263" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/7d40e6dbf3dec3961e9b595a66bab689.png" srcset="https://secure.gravatar.com/avatar/7d40e6dbf3dec3961e9b595a66bab689?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">aravind</span>
	                <span class="date">May 7, 2019 at 2:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484263" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you have seasonality, try modeling with and without the seasonality and compare performance.<br>
what does this mean? I didn’t get you<br>
my training data will anyway contain the seasonality if my original dataset has seasonality right?<br>
how will I be able to make a model without seasonality?<br>
is there a additional parameter or feature in LSTM for seasonality?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-484288" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-484288" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 7, 2019 at 6:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484288" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can remove seasonality from a dataset via seasonal differencing:<br>
<a href="https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/" rel="nofollow">https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484296" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-484296" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a593cbbeac050dbf0431c595ebf6fa35.png" srcset="https://secure.gravatar.com/avatar/a593cbbeac050dbf0431c595ebf6fa35?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shiva</span>
	                <span class="date">May 7, 2019 at 7:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484296" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In Multiple Input Series,<br>
(7, 3, 2) (7,)</p>
<p>[[10 15]<br>
 [20 25]<br>
 [30 35]] 65<br>
[[20 25]<br>
 [30 35]<br>
 [40 45]] 85<br>
[[30 35]<br>
 [40 45]<br>
 [50 55]] 105<br>
[[40 45]<br>
 [50 55]<br>
 [60 65]] 125<br>
[[50 55]<br>
 [60 65]<br>
 [70 75]] 145<br>
[[60 65]<br>
 [70 75]<br>
 [80 85]] 165<br>
[[70 75]<br>
 [80 85]<br>
 [90 95]] 185</p>
<p>1. How many lstm block will be here in this example( x=7)<br>
if batch size = 3,is the number of lstm block equal to the number of x in the batches?<br>
or the number of timesteps?</p>
<p>2.are timesteps, neurons and batchsize all hyperparameter? how do we optimize them</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484296" data-commentid="484296" data-postid="6435" data-belowelement="comment-484296" data-respondelement="respond" aria-label="Reply to shiva">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484323" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-484323" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 7, 2019 at 2:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484323" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, the number of blocks in the first hidden layer is unrelated to the length of the input sequences.</p>
<p>See this:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484323" data-commentid="484323" data-postid="6435" data-belowelement="comment-484323" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484376" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-484376" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a593cbbeac050dbf0431c595ebf6fa35.png" srcset="https://secure.gravatar.com/avatar/a593cbbeac050dbf0431c595ebf6fa35?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shiva</span>
	                <span class="date">May 8, 2019 at 4:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484376" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks..<br>
Then what is the total number of LSTM blocks?<br>
for every epoch, are the weights reinitialized and states are reset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484376" data-commentid="484376" data-postid="6435" data-belowelement="comment-484376" data-respondelement="respond" aria-label="Reply to shiva">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484401" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-484401" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 8, 2019 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484401" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The number of LSTM units is specified in each hidden LSTM layer.</p>
<p>LSTM states are reset at the end of every batch.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484401" data-commentid="484401" data-postid="6435" data-belowelement="comment-484401" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484408" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-484408" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a593cbbeac050dbf0431c595ebf6fa35.png" srcset="https://secure.gravatar.com/avatar/a593cbbeac050dbf0431c595ebf6fa35?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shiva</span>
	                <span class="date">May 8, 2019 at 8:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484408" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sorry but i dont get this?</p>
<p>In model.add(LSTM(50, activation=’relu’, input_shape=(n_steps, n_features)))<br>
input_shape here is equal to an input to each LSTM node right?</p>
<p>and here 50 means,, h(hidden layer) is a vector of  50*1 right?</p>
<p>my question is the number of individual LSTM nodes(block) equal to number of samples in the a batch?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484408" data-commentid="484408" data-postid="6435" data-belowelement="comment-484408" data-respondelement="respond" aria-label="Reply to shiva">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484442" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-484442" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 8, 2019 at 2:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484442" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the shape defines the shape of each input sample (time steps and features).</p>
<p>Yes, 50 refers to units in the first hidden layer.</p>
<p>The number of units and sample shape are both unrelated to the batch size. Unless you are working with a stateful LSTM, in which case the input shape must also specify the batch size.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484442" data-commentid="484442" data-postid="6435" data-belowelement="comment-484442" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-484491" class="comment even depth-2 parent">

	      	<div id="li-comment-484491" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a593cbbeac050dbf0431c595ebf6fa35.png" srcset="https://secure.gravatar.com/avatar/a593cbbeac050dbf0431c595ebf6fa35?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shiva</span>
	                <span class="date">May 8, 2019 at 11:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484491" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>yeah.. one followup question<br>
[10 15]<br>
[20 25]<br>
[30 35]] 65<br>
here is it like many to one ?</p>
<p>this feeds as xt (single input) right?<br>
in this case what is the size of weight  ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484491" data-commentid="484491" data-postid="6435" data-belowelement="comment-484491" data-respondelement="respond" aria-label="Reply to shiva">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484538" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3 parent">

	      	<div id="li-comment-484538" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 9, 2019 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484538" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, multivariate multistep input to one output.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484538" data-commentid="484538" data-postid="6435" data-belowelement="comment-484538" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484559" class="comment even depth-4 parent">

	      	<div id="li-comment-484559" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a593cbbeac050dbf0431c595ebf6fa35.png" srcset="https://secure.gravatar.com/avatar/a593cbbeac050dbf0431c595ebf6fa35?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shiva</span>
	                <span class="date">May 9, 2019 at 11:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484559" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>how does this input concatenate with hidden layer … i cannot visualize this..<br>
i was thinking the input were a vector[n*1]</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484559" data-commentid="484559" data-postid="6435" data-belowelement="comment-484559" data-respondelement="respond" aria-label="Reply to shiva">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484570" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-484570" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 9, 2019 at 2:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484570" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Each node in the hidden layer gets the complete put sequence.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-485006" class="comment even depth-5">

	      	<div id="li-comment-485006" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a593cbbeac050dbf0431c595ebf6fa35.png" srcset="https://secure.gravatar.com/avatar/a593cbbeac050dbf0431c595ebf6fa35?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shiva</span>
	                <span class="date">May 12, 2019 at 9:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-485006" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much..</p>
<p>[10 15]<br>
[20 25]<br>
[30 35]] 65</p>
<p>so in this case ,,, what is the size of xt and weight matrix?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-485114" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-485114" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 13, 2019 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-485114" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can calculate it based on the number of nodes in your network.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-485526" class="comment even depth-5">

	      	<div id="li-comment-485526" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a593cbbeac050dbf0431c595ebf6fa35.png" srcset="https://secure.gravatar.com/avatar/a593cbbeac050dbf0431c595ebf6fa35?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shiva</span>
	                <span class="date">May 15, 2019 at 10:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-485526" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you jason.. you have so kind and helpful..</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484424" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-484424" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a593cbbeac050dbf0431c595ebf6fa35.png" srcset="https://secure.gravatar.com/avatar/a593cbbeac050dbf0431c595ebf6fa35?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shiva</span>
	                <span class="date">May 8, 2019 at 11:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484424" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The number of cells is equal to the number of fixed time steps.<br>
The blogs says so. I am very confused with number of cells and what controls it.</p>
<p><a href="https://stackoverflow.com/questions/37901047/what-is-num-units-in-tensorflow-basiclstmcell#39440218" rel="nofollow">https://stackoverflow.com/questions/37901047/what-is-num-units-in-tensorflow-basiclstmcell#39440218</a></p>
<p>Sorry for trouble</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484424" data-commentid="484424" data-postid="6435" data-belowelement="comment-484424" data-respondelement="respond" aria-label="Reply to shiva">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484445" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-484445" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 8, 2019 at 2:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484445" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not in the Keras implementation.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-484445" data-commentid="484445" data-postid="6435" data-belowelement="comment-484445" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-485088" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-485088" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/c0448218a0db38466f4c844e026fd7ee.png" srcset="https://secure.gravatar.com/avatar/c0448218a0db38466f4c844e026fd7ee?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Philipp</span>
	                <span class="date">May 13, 2019 at 2:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-485088" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>Thank you for writing all these awesome tutorials!</p>
<p>My question:<br>
As I understood it, a LSTM network learns the information in a time-series by backpropagation through a specific length (in time) at which the LSTM cells are unrolled during training.<br>
So, while training it is necessary to define the number of timesteps provided in the training data. But shouldn’t it be possible to use the (trained) network with ANY number of input timesteps to make a prediction (because of the recurrent nature in which the LSTM cells work)?<br>
Am I getting something wrong here from the beginning?</p>
<p>Thank you for hints on this<br>
Philipp</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-485088" data-commentid="485088" data-postid="6435" data-belowelement="comment-485088" data-respondelement="respond" aria-label="Reply to Philipp">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-485183" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-485183" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/66dc9daab1505fb92188b08a845fe241.png" srcset="https://secure.gravatar.com/avatar/66dc9daab1505fb92188b08a845fe241?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sumitra</span>
	                <span class="date">May 13, 2019 at 3:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-485183" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>I am currently working on a disease outbreak prediction model. I have 4 years of data with over 100 input variables and each year has got 365 data points. I would like to create a LSTM model that will be able to predict the future outbreak (whether thr will be an outbreak-1 or no outbreak-0) based on the given input variables. For example, given 7 days of data points, i would like to predict the occurance of outbreak (whether 0 or 1) on the 8th day.</p>
<p>However, i am not sure on which LSTM model will best fit my case. Will ‘multiple input multi-step output) be the best approach? Your guidance will be much appreciated.</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-485183" data-commentid="485183" data-postid="6435" data-belowelement="comment-485183" data-respondelement="respond" aria-label="Reply to sumitra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-485282" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-485282" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 14, 2019 at 7:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-485282" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you can model it as a time series classification problem.</p>
<p>The tutorials here will help you to get started:<br>
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-485282" data-commentid="485282" data-postid="6435" data-belowelement="comment-485282" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-486709" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-486709" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/2eb949e4d664574d942150ec500fd8e4.jpeg" srcset="https://secure.gravatar.com/avatar/2eb949e4d664574d942150ec500fd8e4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nitin</span>
	                <span class="date">May 26, 2019 at 1:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-486709" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Can you please provide some pointers that will help us in minimizing the step-loss during model fitting…. </p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-486709" data-commentid="486709" data-postid="6435" data-belowelement="comment-486709" data-respondelement="respond" aria-label="Reply to Nitin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-486748" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-486748" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 27, 2019 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-486748" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, here are some suggestions:<br>
<a href="https://machinelearningmastery.com/start-here/#better" rel="nofollow">https://machinelearningmastery.com/start-here/#better</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-486748" data-commentid="486748" data-postid="6435" data-belowelement="comment-486748" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-486929" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-486929" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/0a3cc60781e8ac093426c5c4d8d4acd7.png" srcset="https://secure.gravatar.com/avatar/0a3cc60781e8ac093426c5c4d8d4acd7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ICHaLiL</span>
	                <span class="date">May 29, 2019 at 12:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-486929" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>Thank you for your tutorials. They are really useful for us.</p>
<p>I’ve one question about LSTM. I have different time series more than one (for example 100). I need to train network with 100 different time series. and test 10 different time series. Which method should I use?</p>
<p>Thanks for your helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-486929" data-commentid="486929" data-postid="6435" data-belowelement="comment-486929" data-respondelement="respond" aria-label="Reply to ICHaLiL">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-486972" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-486972" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 29, 2019 at 8:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-486972" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend this process:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-486972" data-commentid="486972" data-postid="6435" data-belowelement="comment-486972" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-487097" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-487097" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6db1f63c8d49ced7bd0e9333f67f6ac1.png" srcset="https://secure.gravatar.com/avatar/6db1f63c8d49ced7bd0e9333f67f6ac1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">QuantCub</span>
	                <span class="date">May 30, 2019 at 2:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-487097" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you for sharing. I wonder if there is a way to set timestep &gt; 1 without doing subsequence sampling as you did in data preparation, e.g. convert a 9-by-1 time series to a 6-by-3 data set. After the conversion, the 3-feature dataset is no more time dependent. You are able to use any kind of ML models (say OLS) to predict y. So why LSTM? Should LSTM be able to select (forget) previous information without this conversion?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-487097" data-commentid="487097" data-postid="6435" data-belowelement="comment-487097" data-respondelement="respond" aria-label="Reply to QuantCub">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487108" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-487108" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 30, 2019 at 2:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-487108" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>LSTM does have the benefit that it can remember across samples.</p>
<p>This may or may not be useful, and is often not useful for simple autoregressions.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-487108" data-commentid="487108" data-postid="6435" data-belowelement="comment-487108" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487170" class="comment even depth-3 parent">

	      	<div id="li-comment-487170" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6db1f63c8d49ced7bd0e9333f67f6ac1.png" srcset="https://secure.gravatar.com/avatar/6db1f63c8d49ced7bd0e9333f67f6ac1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">QuantCub</span>
	                <span class="date">May 31, 2019 at 1:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-487170" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your quick reply. In your example, if I do a subsequence sampling and convert<br>
[10, 20, 30, 40, 50, 60, 70, 80, 90] to<br>
[[10, 20, 30],<br>
 [40, 50, 60],<br>
 [70, 80, 90]] (no replacement between each subsequence)<br>
and run LSTM(input_shape=(3,1)), is that the same as I run LSTM(batch_input_shape=(3,1,1), stateful=True) on the origin time series (9-by-1)?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-487170" data-commentid="487170" data-postid="6435" data-belowelement="comment-487170" data-respondelement="respond" aria-label="Reply to QuantCub">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487280" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-487280" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 31, 2019 at 7:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-487280" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, as each “sample” will cause an output from the model, e.g. 1 sample with 3 time steps vs 3 samples with 1 time step.</p>
<p>More on samples vs timesteps here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-487280" data-commentid="487280" data-postid="6435" data-belowelement="comment-487280" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-487382" class="comment even depth-5">

	      	<div id="li-comment-487382" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6db1f63c8d49ced7bd0e9333f67f6ac1.png" srcset="https://secure.gravatar.com/avatar/6db1f63c8d49ced7bd0e9333f67f6ac1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">QuantCub</span>
	                <span class="date">May 31, 2019 at 12:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-487382" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you, Jason!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-487421" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-487421" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 31, 2019 at 2:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-487421" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No problem.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-488587" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-488587" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6671ba50a3ba26fbd794b59a010de656.png" srcset="https://secure.gravatar.com/avatar/6671ba50a3ba26fbd794b59a010de656?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Neel</span>
	                <span class="date">June 11, 2019 at 9:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-488587" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>For a classification LSTM, using a Seed I get the same classification matrix each time I run it. However, when I vary the batch size in model.predict, I get the following:</p>
<p>Prediction Batch Sizes:</p>
<p> 32 = Different Classification Matrix on each repeat</p>
<p>Batch size in predictions is merely for ram managment. Correct? If yes, what do you think Dr. Jason would cause these irregularities ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-488587" data-commentid="488587" data-postid="6435" data-belowelement="comment-488587" data-respondelement="respond" aria-label="Reply to Neel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-488626" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-488626" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 12, 2019 at 8:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-488626" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No batch size impacts the learning algorithm:<br>
<a href="https://machinelearningmastery.com/how-to-control-the-speed-and-stability-of-training-neural-networks-with-gradient-descent-batch-size/" rel="nofollow">https://machinelearningmastery.com/how-to-control-the-speed-and-stability-of-training-neural-networks-with-gradient-descent-batch-size/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-488626" data-commentid="488626" data-postid="6435" data-belowelement="comment-488626" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-488681" class="comment even depth-3 parent">

	      	<div id="li-comment-488681" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6671ba50a3ba26fbd794b59a010de656.png" srcset="https://secure.gravatar.com/avatar/6671ba50a3ba26fbd794b59a010de656?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Neel</span>
	                <span class="date">June 12, 2019 at 4:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-488681" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Sorry I didn’t explain my concern well. I was referring to the Batch Size parameter that we mention in “model.predict i.e. predicting” and not while training. I agree that batch size during training will have an impact. During prediction, the default size is 32 as defined by keras but when I change that to anything but 32 I get a different classification matrix even though I use a seed. When I leave the batch size as default, my seed is able to produce the same results.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-488681" data-commentid="488681" data-postid="6435" data-belowelement="comment-488681" data-respondelement="respond" aria-label="Reply to Neel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-488725" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-488725" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 13, 2019 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-488725" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Recall that with the LSTM, the state is reset at the end of each batch. This explains why you are getting different results for the same model with different inference batch sizes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-488725" data-commentid="488725" data-postid="6435" data-belowelement="comment-488725" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-490045" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-490045" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/83277285d5476d2a264c19d74b4d9ac2.png" srcset="https://secure.gravatar.com/avatar/83277285d5476d2a264c19d74b4d9ac2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Diego</span>
	                <span class="date">June 24, 2019 at 5:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-490045" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the tutorial.<br>
I’d like to apply this example to a real case.</p>
<p>I have to forecast how much money will be withdrawn every day from a group of ATMs.<br>
Currently I am using a time series for every ATM. (100 ATMs = 100 time series).</p>
<p>Wich method do you think could be better from this tutorial ?<br>
I need to use historical information and external information such as holidays, day of week, etc.<br>
Thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-490045" data-commentid="490045" data-postid="6435" data-belowelement="comment-490045" data-respondelement="respond" aria-label="Reply to Diego">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490077" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-490077" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 24, 2019 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-490077" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend following this framework:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-490077" data-commentid="490077" data-postid="6435" data-belowelement="comment-490077" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-490184" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-490184" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/fb7764aa7358ce524ee9dcd470c582bf.png" srcset="https://secure.gravatar.com/avatar/fb7764aa7358ce524ee9dcd470c582bf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Liang Zhao</span>
	                <span class="date">June 25, 2019 at 5:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-490184" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I want to use some kind of machine learning method to demonstrate that there is a relationship between the score gap of two basketball teams and the demand for a taxi outside the stadium.</p>
<p>I have time series of pick-ups near a stadium. I have the score gap time series between two basketball teams.</p>
<p>What I want to achieve is that training a machine learning model that could tell me, based on the taxi pick-ups at time t, what is the taxi pick-ups at time t+1.<br>
I also want to see if I also have the score gap at time t, can I improve my prediction accuracy of pick-ups at time t+1.</p>
<p>Which machine learning model should I use?</p>
<p>thank you so much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-490184" data-commentid="490184" data-postid="6435" data-belowelement="comment-490184" data-respondelement="respond" aria-label="Reply to Liang Zhao">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490211" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-490211" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 25, 2019 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-490211" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why not just measure statistical correlation between the observations?<br>
<a href="https://machinelearningmastery.com/how-to-use-correlation-to-understand-the-relationship-between-variables/" rel="nofollow">https://machinelearningmastery.com/how-to-use-correlation-to-understand-the-relationship-between-variables/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-490211" data-commentid="490211" data-postid="6435" data-belowelement="comment-490211" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490391" class="comment even depth-3 parent">

	      	<div id="li-comment-490391" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/fb7764aa7358ce524ee9dcd470c582bf.png" srcset="https://secure.gravatar.com/avatar/fb7764aa7358ce524ee9dcd470c582bf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">liang zhao</span>
	                <span class="date">June 26, 2019 at 7:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-490391" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you very much for your reply!<br>
Yes, this could work for finding a relationship.<br>
but what if I want to forecast the number of pick-ups at t+1. Can LSTM or ARIMA do this job?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-490391" data-commentid="490391" data-postid="6435" data-belowelement="comment-490391" data-respondelement="respond" aria-label="Reply to liang zhao">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490469" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-490469" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 27, 2019 at 7:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-490469" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, but perhaps test a suite of methods and discover what works best for your specific dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-490469" data-commentid="490469" data-postid="6435" data-belowelement="comment-490469" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491031" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-491031" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/8d89b814b783414b58d7db30189b5caf.png" srcset="https://secure.gravatar.com/avatar/8d89b814b783414b58d7db30189b5caf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">James</span>
	                <span class="date">July 1, 2019 at 1:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491031" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the tutorial.</p>
<p>Suppose I have several time series showing cumulative bookings for different trains last year. I don’t want to forecast but just classify those time series to see if some of them have similar patterns. Can I include all those series into one LSTM model? Is there any risks when doing so?</p>
<p>Thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491031" data-commentid="491031" data-postid="6435" data-belowelement="comment-491031" data-respondelement="respond" aria-label="Reply to James">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491067" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-491067" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 1, 2019 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491067" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, it means you are learning/modeling across books. Sounds reasonable.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491067" data-commentid="491067" data-postid="6435" data-belowelement="comment-491067" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491148" class="comment even depth-3 parent">

	      	<div id="li-comment-491148" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/8d89b814b783414b58d7db30189b5caf.png" srcset="https://secure.gravatar.com/avatar/8d89b814b783414b58d7db30189b5caf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">James</span>
	                <span class="date">July 1, 2019 at 11:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491148" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason!</p>
<p>So is it the same as multivariate LSTM? Sorry I’m new to modelling so still find things confusing</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491148" data-commentid="491148" data-postid="6435" data-belowelement="comment-491148" data-respondelement="respond" aria-label="Reply to James">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491204" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-491204" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 2, 2019 at 7:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491204" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Probably not, each example is a separate sample or input-output pair for the model to learn from.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491204" data-commentid="491204" data-postid="6435" data-belowelement="comment-491204" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491079" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-491079" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/cdd10035fdbfa7bb66c18f91515d52fe.png" srcset="https://secure.gravatar.com/avatar/cdd10035fdbfa7bb66c18f91515d52fe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Irini</span>
	                <span class="date">July 1, 2019 at 9:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491079" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>thanks for the nice tutorial!</p>
<p>I have a dataset with 3000 univariate timeseries (i.e. 3000 samples) and each sample has 4000 timesteps. When i use [samples, time steps, features]=[3000, 4000, 1] the code is extremely slow and with bad performance.<br>
On the other hand, if instead [3000, 4000, 1] i write [3000, 1, 4000] the code is very fast and with great performance.<br>
But is the reshape [3000, 1, 4000] correct? I mean according to the rule  [samples, time steps, features] and given the fact that each of my samples have 4000 timesteps and for each time step there is one feature the correct should be [3000, 4000, 1].</p>
<p>So is [3000, 1, 4000] correct? And if it is not (logically it is not) why it works much better than [3000, 4000, 1] ?</p>
<p>Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491079" data-commentid="491079" data-postid="6435" data-belowelement="comment-491079" data-respondelement="respond" aria-label="Reply to Irini">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491096" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-491096" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 1, 2019 at 11:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491096" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend not using more than 200 to 400 time steps per sample. Perhaps you can truncate your data?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491096" data-commentid="491096" data-postid="6435" data-belowelement="comment-491096" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491131" class="comment even depth-3 parent">

	      	<div id="li-comment-491131" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/cdd10035fdbfa7bb66c18f91515d52fe.png" srcset="https://secure.gravatar.com/avatar/cdd10035fdbfa7bb66c18f91515d52fe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Irini</span>
	                <span class="date">July 1, 2019 at 8:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491131" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I did also an experiment and i truncated my data and used as input [samples, time steps, features]=[3000, 400, 1]. It was quicker but i got a mean accuracy 42% (in 10 random splits).<br>
As i told you in my previous post when i exchange timesteps with features namely when i use [3000, 1, 4000] i get an accuracy 90%.<br>
But giving 1 timestep means that i don’t exploit the memory, whis is the characteristic of lstm?</p>
<p>I am confused as to whether i should use [3000, 1, 4000], which is very quick and gives very good results but maybe it is not very correct? Or it is correct as if i used [3000, 400, 1](if i truncated my data to 400)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491131" data-commentid="491131" data-postid="6435" data-belowelement="comment-491131" data-respondelement="respond" aria-label="Reply to Irini">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491201" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-491201" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 2, 2019 at 7:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491201" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The state of the LSTM is reset at the end of each batch by default, so you can get some across-sample memory.</p>
<p>I recommend testing a suite of different configurations to see what works well or best for your specific dataset. I cannot know what will work well, you must discover the answer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491201" data-commentid="491201" data-postid="6435" data-belowelement="comment-491201" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491161" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-491161" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/59ade123005cb7bb61ac7d181428e744.png" srcset="https://secure.gravatar.com/avatar/59ade123005cb7bb61ac7d181428e744?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Manish</span>
	                <span class="date">July 2, 2019 at 2:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491161" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>I am quite new to ML and LSTMs. I have a scenario where I  intend to train a model using my hourly sensor values. For eg</p>
<p>12-1-2019 12:00:00     12<br>
12-1-2019  13:00:00     16<br>
…<br>
12-5-2019    12:00:00   14</p>
<p>Once I am done with my training I intend to predict values every hour and compare the values with live sensor values….I am planning to use LSTM and which approach do you recommend me ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491161" data-commentid="491161" data-postid="6435" data-belowelement="comment-491161" data-respondelement="respond" aria-label="Reply to Manish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491210" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-491210" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 2, 2019 at 7:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491210" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend this framework:<br>
<a href="https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-a-skilful-time-series-forecasting-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491210" data-commentid="491210" data-postid="6435" data-belowelement="comment-491210" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491291" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-491291" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/f94064a890fe51248c87a75e031a36aa.png" srcset="https://secure.gravatar.com/avatar/f94064a890fe51248c87a75e031a36aa?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harish</span>
	                <span class="date">July 2, 2019 at 7:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491291" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, this is very useful. Im try to to do some prediction around IT incidents. based on historic data i want to predict what type incident i can expect next month/week/day. do you have anything similar done if so request to share pls</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491291" data-commentid="491291" data-postid="6435" data-belowelement="comment-491291" data-respondelement="respond" aria-label="Reply to Harish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491356" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-491356" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 3, 2019 at 8:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491356" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you can model it as a time series classification, e.g. what event is predicted in this interval.</p>
<p>The tutorials here might help as a starting point:<br>
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491356" data-commentid="491356" data-postid="6435" data-belowelement="comment-491356" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491310" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-491310" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/c007051690f684d408f2eafaf458c840.png" srcset="https://secure.gravatar.com/avatar/c007051690f684d408f2eafaf458c840?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lopa</span>
	                <span class="date">July 3, 2019 at 12:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491310" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for answering my question in your other tutorials. I have a minor doubt suppose my data has a continuous time series(non stationary) &amp; other categorical variables (which are already encoded). Under that circumstance what is the best way to difference the data ? Because categorical data are not differenced but they have to be used while training the model.</p>
<p>The function written above differences all the variables irrespective of whether they are continuous or categorical. It would be great if you can help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491310" data-commentid="491310" data-postid="6435" data-belowelement="comment-491310" data-respondelement="respond" aria-label="Reply to Lopa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491364" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-491364" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 3, 2019 at 8:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491364" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Difference the real-values only, and only if they are non-stationary.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491364" data-commentid="491364" data-postid="6435" data-belowelement="comment-491364" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491407" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-491407" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6f8befc450a018be95239aa7d3e7feaf.jpeg" srcset="https://secure.gravatar.com/avatar/6f8befc450a018be95239aa7d3e7feaf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">myro</span>
	                <span class="date">July 3, 2019 at 5:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491407" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I copied and pasted your first example from Multi-Step LSTM Models, the one with the vector output of two values and the input being one. </p>
<p>You report as an output the values:</p>
<p>input [[70 80 90]]<br>
output [[100.98096 113.28924]]</p>
<p>but with those parameters I cannot get any closer than</p>
<p>input [[70 80 90]]<br>
output [[122.678955 139.9465  ]]</p>
<p>This you use the parameters you report? Is this so dependant on architecture?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491407" data-commentid="491407" data-postid="6435" data-belowelement="comment-491407" data-respondelement="respond" aria-label="Reply to myro">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491478" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-491478" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 4, 2019 at 7:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491478" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Results are dependent upon the model, the model configuration and the data, the performance is also stochastic, subject to random variance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491478" data-commentid="491478" data-postid="6435" data-belowelement="comment-491478" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493469" class="comment even depth-3">

	      	<div id="li-comment-493469" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/6f8befc450a018be95239aa7d3e7feaf.jpeg" srcset="https://secure.gravatar.com/avatar/6f8befc450a018be95239aa7d3e7feaf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">myro</span>
	                <span class="date">July 19, 2019 at 7:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493469" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, thanks for your reply.<br>
I understand that, that’s why I am asking,<br>
I have same model, same model config. same data, and the stochasticity should be symmetrically distributed (?). Then I assume that the results you report are not from the parameters you have in the code examples.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493469" data-commentid="493469" data-postid="6435" data-belowelement="comment-493469" data-respondelement="respond" aria-label="Reply to myro">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491419" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-491419" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/c007051690f684d408f2eafaf458c840.png" srcset="https://secure.gravatar.com/avatar/c007051690f684d408f2eafaf458c840?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lopa</span>
	                <span class="date">July 3, 2019 at 7:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491419" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>My data is non stationary &amp; there are seasonality every 7 days ( as evident from the ADF tests &amp; ETS plots) &amp; a first order differencing makes it stationary. </p>
<p>I totally get that I have to difference only the real values &amp; that is what I have been aiming to do . But the reason I asked this question because the moment I difference the real values its get shifted by one place so if the original data has 100 observations the differenced data will have 99 observations (with a first order differencing). But the categorical data which cannot be differenced remains to be the same 100. How do I deal with this ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491419" data-commentid="491419" data-postid="6435" data-belowelement="comment-491419" data-respondelement="respond" aria-label="Reply to Lopa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491488" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-491488" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 4, 2019 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491488" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You discard the first observation and the difference value corresponds to the categorical value at the same time step.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491488" data-commentid="491488" data-postid="6435" data-belowelement="comment-491488" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491422" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-491422" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/c007051690f684d408f2eafaf458c840.png" srcset="https://secure.gravatar.com/avatar/c007051690f684d408f2eafaf458c840?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lopa</span>
	                <span class="date">July 3, 2019 at 8:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491422" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think I have been able to solve the issue thanks Jason for addressing my query</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491422" data-commentid="491422" data-postid="6435" data-belowelement="comment-491422" data-respondelement="respond" aria-label="Reply to Lopa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491490" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-491490" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 4, 2019 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491490" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m happy to hear that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491490" data-commentid="491490" data-postid="6435" data-belowelement="comment-491490" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491649" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-491649" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1f9042108cb50931626d070ce541559c.png" srcset="https://secure.gravatar.com/avatar/1f9042108cb50931626d070ce541559c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Leon</span>
	                <span class="date">July 5, 2019 at 5:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491649" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>in the Vector Output Model section,<br>
I copied your code and tried,  the actual answer is not correct as of the expected [100, 110], they are actually [110, 120].</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491649" data-commentid="491649" data-postid="6435" data-belowelement="comment-491649" data-respondelement="respond" aria-label="Reply to Leon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491679" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-491679" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 5, 2019 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491679" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try running the example a few times? It can very given the stochastic nature of the learning algorithm.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491679" data-commentid="491679" data-postid="6435" data-belowelement="comment-491679" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-492417" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-492417" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1f006a48059174d72719276d765e3b0e.png" srcset="https://secure.gravatar.com/avatar/1f006a48059174d72719276d765e3b0e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Leon</span>
	                <span class="date">July 11, 2019 at 1:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492417" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>never get any chance to around [100, 110]. I ran many times, the output is always around [110, 120] with some variations.</p>
<p>no kidding <img draggable="false" class="emoji" alt="🙂" src="./How to Develop LSTM Models for Time Series Forecasting_files/1f642.svg">   you can try that part of codes. The output looks ridiculous.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492417" data-commentid="492417" data-postid="6435" data-belowelement="comment-492417" data-respondelement="respond" aria-label="Reply to Leon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-492447" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-492447" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 11, 2019 at 9:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492447" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Intersting.</p>
<p>Is Keras/TensorFlow/Python up to date?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492447" data-commentid="492447" data-postid="6435" data-belowelement="comment-492447" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491736" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-491736" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/e90d3cde3048ed83e8ecf8273b6f8140.png" srcset="https://secure.gravatar.com/avatar/e90d3cde3048ed83e8ecf8273b6f8140?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Matthew</span>
	                <span class="date">July 5, 2019 at 5:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491736" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I am doing an electrical demand forecast and am trying to build a model which predicts the demand for the following 24 hours given the last 90 hours. I have implemented two types: a 24 step prediction and a recursively defined prediction, which predicts the next hour and then uses the previous 89 true values and the new predicted value to predict the next value, and so on. I am wondering which method you believe to be the best(if either) and any tips for improving my model as depending on the time of year the forecast can vary massively with accuracy. I currently have an LSTM(50) connected to a Dense(20) connected to an output Dense(1) for both cases.<br>
Any help would be greatly appreciated. Thank you. Matthew</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491736" data-commentid="491736" data-postid="6435" data-belowelement="comment-491736" data-respondelement="respond" aria-label="Reply to Matthew">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491821" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-491821" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 6, 2019 at 8:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491821" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done, very cool!</p>
<p>I recommend testing each method and use the one with the lowest error.</p>
<p>Also, get creative and test a suite of other configurations. Ensure your test harness is robust and reliable so that you can trust the decisions you make.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-491821" data-commentid="491821" data-postid="6435" data-belowelement="comment-491821" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-492143" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-492143" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/5b9470fe05c4d248b58d33e58045a7ce.png" srcset="https://secure.gravatar.com/avatar/5b9470fe05c4d248b58d33e58045a7ce?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">skyrim4ever</span>
	                <span class="date">July 8, 2019 at 8:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492143" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, this example was nice to follow and seemed little more simpler than other LSTM examples because of no pre-processinhg transformations (normalization, standardization, making data into stationary, etc.). However, should I perform these pre-processing transformations in general for time series prediction? Should I do such thing for this kind of examples too even though the dataset is simple?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492143" data-commentid="492143" data-postid="6435" data-belowelement="comment-492143" data-respondelement="respond" aria-label="Reply to skyrim4ever">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-492208" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-492208" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 9, 2019 at 8:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492208" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, test to see if the data preparation improves model performance.</p>
<p>I keep it out of examples for brevity.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492208" data-commentid="492208" data-postid="6435" data-belowelement="comment-492208" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-492507" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-492507" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/c3690d97084995e398fa437c13f6af77.png" srcset="https://secure.gravatar.com/avatar/c3690d97084995e398fa437c13f6af77?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nutakki</span>
	                <span class="date">July 11, 2019 at 8:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492507" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>#In Multiple Parallel Series<br>
I have defined the input like this<br>
# define input sequence<br>
in_seq1 = array([10, 20, 30, 40, 50, 60, 70, 80, 90])<br>
in_seq2 = array([15, 25, 35, 45, 55, 65, 75, 85, 95])<br>
x_input = array([[70,75,1,4], [80,85,165,5], [90,95,185,6]])<br>
n_steps=4<br>
n_features=X.shape[2] </p>
<p>how the input is looping to obtain output as follows: [[ 72.74373 106.51455 251.78499]]?<br>
Can you give a clear idea what does n_steps=4, n_features=X.shape[2] really means and how does it function?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492507" data-commentid="492507" data-postid="6435" data-belowelement="comment-492507" data-respondelement="respond" aria-label="Reply to Nutakki">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-492586" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-492586" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 12, 2019 at 8:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492586" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, perhaps this will help you to understand the input shape:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492586" data-commentid="492586" data-postid="6435" data-belowelement="comment-492586" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-492547" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-492547" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/47c597869959fd6bc5c7c5968d28349d.png" srcset="https://secure.gravatar.com/avatar/47c597869959fd6bc5c7c5968d28349d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amelie</span>
	                <span class="date">July 12, 2019 at 2:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492547" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Please, is there a method to find the correct parameter of an ANN model: LSTM, MLP (hidden layer number, activation function, loss function ..)</p>
<p>what does it mean when my train and validation loss curves are parallel while the Train Score and Test Score are small?</p>
<p>Is there a method to optimize all these results?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492547" data-commentid="492547" data-postid="6435" data-belowelement="comment-492547" data-respondelement="respond" aria-label="Reply to Amelie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-492596" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-492596" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 12, 2019 at 8:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492596" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, see this post:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-492596" data-commentid="492596" data-postid="6435" data-belowelement="comment-492596" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-493134" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-493134" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/f79095faa0111f5b7c59fa77af746842.png" srcset="https://secure.gravatar.com/avatar/f79095faa0111f5b7c59fa77af746842?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Samil</span>
	                <span class="date">July 17, 2019 at 8:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493134" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the tutorial. I have applied the multistep, multivariate logic to my own dataset. Namely, I have 12 look-back, 12 look-ahead and 41 features (all having exact look-back as the main variable of interest). Trying the TimeDistributed code snippet gave me progressively increasing RMSE. Is this due to the nature of my time series or is it a sign of mistake done during construction of the model? It is hard to tell for you but maybe you can share your take on this issue. Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493134" data-commentid="493134" data-postid="6435" data-belowelement="comment-493134" data-respondelement="respond" aria-label="Reply to Samil">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493164" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-493164" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 17, 2019 at 8:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493164" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It could be either. </p>
<p>Perhaps try fewer features and evaluate impact?<br>
Perhaps try different models and evaluate impact?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493164" data-commentid="493164" data-postid="6435" data-belowelement="comment-493164" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493421" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-493421" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/f79095faa0111f5b7c59fa77af746842.png" srcset="https://secure.gravatar.com/avatar/f79095faa0111f5b7c59fa77af746842?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Samil</span>
	                <span class="date">July 19, 2019 at 9:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493421" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks II tried encoder-decoder and stack LSTM. Both gives me increasing RMSE for further look-aheads.It is understandable for encoder-decoder as it uses the output as an input (so associated error also comes with the prediction and builds up over time) but not sure why I see the same thing with the stack lstm. Anyways, thanks again for the response and the post!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493421" data-commentid="493421" data-postid="6435" data-belowelement="comment-493421" data-respondelement="respond" aria-label="Reply to Samil">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493422" class="comment even depth-4 parent">

	      	<div id="li-comment-493422" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/f79095faa0111f5b7c59fa77af746842.png" srcset="https://secure.gravatar.com/avatar/f79095faa0111f5b7c59fa77af746842?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Samil</span>
	                <span class="date">July 19, 2019 at 9:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493422" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Also, one quick related question. You use “-1” in multi step future multivariate split_sequence models (such as n_steps_out-1  etc.). This reduces the number of resulting features by one when compared to other split_sequence snippets. I tested it with the other multistep split_sequence code you shared above. Not sure but are’nt we supposed to have the same number of features? Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493422" data-commentid="493422" data-postid="6435" data-belowelement="comment-493422" data-respondelement="respond" aria-label="Reply to Samil">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493440" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-493440" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 19, 2019 at 2:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493440" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-493439" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-493439" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 19, 2019 at 2:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493439" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done on the improvement!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493439" data-commentid="493439" data-postid="6435" data-belowelement="comment-493439" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-493698" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-493698" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/d72b3408ace6def4cb9a255a9784d285.png" srcset="https://secure.gravatar.com/avatar/d72b3408ace6def4cb9a255a9784d285?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aziz Ahmad</span>
	                <span class="date">July 22, 2019 at 4:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493698" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sir Plz! Suggest me good learning sources about my project ( carbon emission forcasting using LSTM).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493698" data-commentid="493698" data-postid="6435" data-belowelement="comment-493698" data-respondelement="respond" aria-label="Reply to Aziz Ahmad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493723" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-493723" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 22, 2019 at 8:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493723" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Start here:<br>
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493723" data-commentid="493723" data-postid="6435" data-belowelement="comment-493723" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-493786" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-493786" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/8129dd8374988a5dcbbdb720470bd844.png" srcset="https://secure.gravatar.com/avatar/8129dd8374988a5dcbbdb720470bd844?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mans Oshanov</span>
	                <span class="date">July 22, 2019 at 6:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493786" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the great tutorial. Is it possible to get the probability of prediction(in percentage) or second best prediction out of these models? Thank you)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493786" data-commentid="493786" data-postid="6435" data-belowelement="comment-493786" data-respondelement="respond" aria-label="Reply to Mans Oshanov">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493853" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-493853" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 23, 2019 at 7:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493853" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, model.predict() will return a probability on classification tasks.</p>
<p>More details here:<br>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" rel="nofollow">https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-493853" data-commentid="493853" data-postid="6435" data-belowelement="comment-493853" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494295" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-494295" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/51ad6d62bc69232c06cdfc3f3fdc4896.png" srcset="https://secure.gravatar.com/avatar/51ad6d62bc69232c06cdfc3f3fdc4896?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kennard</span>
	                <span class="date">July 26, 2019 at 11:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494295" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason</p>
<p>Your tutorial helps me a lot, thank you very much!</p>
<p>And I have a question that how to adjust the learning rate of the LSTM network in the CNN-LSTM code you’ve mentioned above.</p>
<p>I’m looking forward to your reply, thank you!</p>
<p>(The reply I left in <a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/?unapproved=494293&amp;moderation-hash=2b6d045a4e1ff047d0720753b2b1e418#comment-494293" rel="nofollow">https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/?unapproved=494293&amp;moderation-hash=2b6d045a4e1ff047d0720753b2b1e418#comment-494293</a> is in wrong place, sorry about that)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494295" data-commentid="494295" data-postid="6435" data-belowelement="comment-494295" data-respondelement="respond" aria-label="Reply to Kennard">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494302" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-494302" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 26, 2019 at 2:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494302" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can learn more about how to tune the learning rate (generally) here:<br>
<a href="https://machinelearningmastery.com/understand-the-dynamics-of-learning-rate-on-deep-learning-neural-networks/" rel="nofollow">https://machinelearningmastery.com/understand-the-dynamics-of-learning-rate-on-deep-learning-neural-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494302" data-commentid="494302" data-postid="6435" data-belowelement="comment-494302" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494346" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-494346" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/ddf38f2b42ee49b890a7db43db4df3be.png" srcset="https://secure.gravatar.com/avatar/ddf38f2b42ee49b890a7db43db4df3be?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Luis</span>
	                <span class="date">July 27, 2019 at 3:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494346" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is amazing. I love the blog</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494346" data-commentid="494346" data-postid="6435" data-belowelement="comment-494346" data-respondelement="respond" aria-label="Reply to Luis">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494366" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-494366" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 27, 2019 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494366" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Luis.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494366" data-commentid="494366" data-postid="6435" data-belowelement="comment-494366" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494479" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-494479" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/647a81da41805e3b5bc865c0a396da89.png" srcset="https://secure.gravatar.com/avatar/647a81da41805e3b5bc865c0a396da89?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Armande Kertanio</span>
	                <span class="date">July 28, 2019 at 8:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494479" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank for this nice explanation.</p>
<p>I have a problem when reshaping the data for multiple output architecture.</p>
<p>the architecture is:</p>
<p>outputs=[]</p>
<p>main_input = Input(shape= (seq_length,feature_cnt), name=’main_input’)<br>
lstm = LSTM(32,return_sequences=True)(main_input)<br>
for _ in range((5)):<br>
    prediction = LSTM(8,return_sequences=False)(lstm)<br>
    out = Dense(1)(prediction)<br>
    outputs.append(out)</p>
<p>model = Model(inputs=main_input, outputs=outputs)<br>
model.compile(optimizer=’rmsprop’,loss=’mse’)    </p>
<p>and when reshaping the y using:</p>
<p>y=y.reshape((len(y),5,1))</p>
<p>I got a reshaping error:</p>
<p>ValueError: Error when checking model target: the list of Numpy arrays that you are passing to your model is not the size the model expected. Expected to see 5 array(s), but instead got the following list of 1 arrays: [array([[0.35128802, 0.01439778, 0.60109704, 0.52722118, 0.25493708],</p>
<p>would you please help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494479" data-commentid="494479" data-postid="6435" data-belowelement="comment-494479" data-respondelement="respond" aria-label="Reply to Armande Kertanio">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494554" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-494554" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 29, 2019 at 5:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494554" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps define what you want the output shape to be, e.g. n samples with m time steps, then confirm your data has that shape, or if not set that shape?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494554" data-commentid="494554" data-postid="6435" data-belowelement="comment-494554" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494538" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-494538" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/cc889fcf4529a163cf9f95d376982d09.png" srcset="https://secure.gravatar.com/avatar/cc889fcf4529a163cf9f95d376982d09?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Florian</span>
	                <span class="date">July 29, 2019 at 2:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494538" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You use “model.add(TimeDistributed(MaxPooling1D(pool_size=2)))” and write “max pooling layer that distills the filter maps down to 1/4 of their size”. A typo or is there a different reason explaining the use of 2 vs. 4 here?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494538" data-commentid="494538" data-postid="6435" data-belowelement="comment-494538" data-respondelement="respond" aria-label="Reply to Florian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494575" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-494575" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 29, 2019 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494575" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry for the confusion.</p>
<p>If the map is 8×8 and we apply a 2×2 pooling layer, then we get a 4×4 out, e.g. 1/4 the area (64 down to 16). </p>
<p>For time series, if we have 1×8 and apply a 1×2 pooling, we get 1×4, you’re right. 1/2 the size, not 1/4 as in image data.</p>
<p>Fixed. Thnaks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494575" data-commentid="494575" data-postid="6435" data-belowelement="comment-494575" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494632" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-494632" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/53bb3f64ab45b33e017597d36d9eb15a.png" srcset="https://secure.gravatar.com/avatar/53bb3f64ab45b33e017597d36d9eb15a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nic</span>
	                <span class="date">July 29, 2019 at 5:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494632" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>first of all, thanks for that awesome introduction into LSTM-Models.<br>
There is just one thing i don’t get.</p>
<p>In the section “Multiple Input Series” you used the following example:<br>
[[ 10  15  25]<br>
 [ 20  25  45]<br>
 [ 30  35  65]<br>
 [ 40  45  85]<br>
 [ 50  55 105]<br>
 [ 60  65 125]<br>
 [ 70  75 145]<br>
 [ 80  85 165]<br>
 [ 90  95 185]]</p>
<p>As you mentioned the first two entries in the arrays refer to the two time series and the last one to the corresponding target variable. To train the LSTM you split the data into input and output samples like:<br>
[[10 15]<br>
 [20 25]<br>
 [30 35]] 65</p>
<p>Why do I drop the first two target entries (25 and 45). Isn’t that information my network loses for training? Why don’t we use each (single) sample like x = [10 15] y[25] to train the time series. Isn’t it easier to lern the series if i have the target for each step?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494632" data-commentid="494632" data-postid="6435" data-belowelement="comment-494632" data-respondelement="respond" aria-label="Reply to Nic">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494703" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-494703" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 30, 2019 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494703" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question.</p>
<p>We must create samples of inputs and outputs.</p>
<p>Some of the input at the beginning of the dataset don’t have enough prior data to recreate an input, therefore must be removed.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494703" data-commentid="494703" data-postid="6435" data-belowelement="comment-494703" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494977" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-494977" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/a3a5d1c756632775661a40aa355b42a0.png" srcset="https://secure.gravatar.com/avatar/a3a5d1c756632775661a40aa355b42a0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joel</span>
	                <span class="date">August 1, 2019 at 12:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494977" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good work, However, you should provide the library imports, to make it easier for beginners.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-494977" data-commentid="494977" data-postid="6435" data-belowelement="comment-494977" data-respondelement="respond" aria-label="Reply to Joel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-495021" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-495021" class="comment-container">

					                <div class="avatar"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 1, 2019 at 6:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-495021" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>All library inputs are provided in the “complete example” listed in the post.</p>
<p>Sorry for the confusion.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-495021" data-commentid="495021" data-postid="6435" data-belowelement="comment-495021" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#respond" style="display:none;">Click here to cancel reply.</a></small></h3>			<form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form">
				<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required="true"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required="true"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" value="" size="30"><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="6435" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="06431d5470"></p><p style="display: none;"></p>			<input type="hidden" id="ak_js" name="ak_js" value="1564809601632"></form>
			</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" src="./How to Develop LSTM Models for Time Series Forecasting_files/1d75d46040c28497f0dee5d8e100db37(2).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" class="avatar avatar-100 photo" height="100" width="100"></span>
<p>Hi, I'm <b>Jason Brownlee</b>, PhD.
<br>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="https://machinelearningmastery.com/about">Read More</a></p>
<div class="fix"></div>
</div><div id="custom_html-2" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: center;background: #eef3f7;padding: 1px;">
<p></p><h4>More Tutorials?</h4><p></p>
<p></p><h5><a href="https://machinelearningmastery.com/start-here/">Start Here</a></h5>
<small><i>(over 780 tutorials!)</i></small>
<p></p>
</div></div></div><div id="text-51" class="widget widget_text">			<div class="textwidget"><p></p><center><br>
<strong>Deep Learning for Time Series</strong><br>
Forecast the future with MLPs, CNNs, and LSTMs.<p></p>
<p><a href="https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/">Click to Get Started Now!</a><br>
<a href="https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/"><img src="./How to Develop LSTM Models for Time Series Forecasting_files/Cover-220.png"></a><br>
</p></center><p></p>
</div>
		</div><div id="custom_html-4" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: center;background: #eef3f7;padding: 1px;">
<p></p><h4>Join Newsletter</h4><p></p>
<p></p><h5><a href="https://machinelearningmastery.com/newsletter/">Subscribe Now</a></h5>
<small><i>(join over 150,000 readers!)</i></small>
<p></p>
</div></div></div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2019 Machine Learning Mastery Pty. Ltd. All Rights Reserved.<br>
Address: PO Box 206, Vermont Victoria 3133, Australia. | ACN: 626 223 336.<br>
<a href="https://machinelearningmastery.com/feed/">RSS</a> |
<a href="http://twitter.com/TeachTheMachine">Twitter</a> | 
<a href="https://www.facebook.com/MachineLearningMastery/">Facebook</a> | 
<a href="https://www.linkedin.com/company/machine-learning-mastery/">LinkedIn</a></p>		</div>

		<div id="credit" class="col-right">
			<p><a href="https://machinelearningmastery.com/privacy/">Privacy</a> | 
<a href="https://machinelearningmastery.com/disclaimer/">Disclaimer</a> | 
<a href="https://machinelearningmastery.com/terms-of-service/">Terms</a> | 
<a href="https://machinelearningmastery.com/contact/">Contact</a> |
<a href="https://machinelearningmastery.com/sitemap/">Sitemap</a> |
<a href="https://machinelearningmastery.com/site-search/">Search</a></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><script type="text/javascript" src="./How to Develop LSTM Models for Time Series Forecasting_files/comment-reply.min.js.download"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"cached":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="./How to Develop LSTM Models for Time Series Forecasting_files/scripts.js.download"></script>
<script type="text/javascript" src="./How to Develop LSTM Models for Time Series Forecasting_files/wp-embed.min.js.download"></script>
<script async="async" type="text/javascript" src="./How to Develop LSTM Models for Time Series Forecasting_files/form.js.download"></script>
<script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://static1.twitcount.com/js/twitcount.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitcount_plugins');</script>
<div style="position: absolute; right: 0px; left: 0px; bottom: 0px; top: 0px; z-index: 2147483646; background: black; width: 100%; opacity: 0.5; display: none; height: 88789px;"></div><iframe src="./How to Develop LSTM Models for Time Series Forecasting_files/saved_resource.html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: none; z-index: 2147483647; height: 888px;"></iframe><iframe src="./How to Develop LSTM Models for Time Series Forecasting_files/saved_resource(1).html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: none; z-index: 2147483647; height: 888px;"></iframe><iframe frameborder="0" scrolling="no" style="background-color: transparent; border: 0px; display: none;" src="./How to Develop LSTM Models for Time Series Forecasting_files/saved_resource(2).html"></iframe><div id="GOOGLE_INPUT_CHEXT_FLAG" input="" input_stat="{&quot;tlang&quot;:true,&quot;tsbc&quot;:true,&quot;pun&quot;:true,&quot;mk&quot;:true,&quot;ss&quot;:true}" style="display: none;"></div><iframe scrolling="no" frameborder="0" allowtransparency="true" src="./How to Develop LSTM Models for Time Series Forecasting_files/widget_iframe.0639d67d95b7680840758b6833f06d87.html" title="Twitter settings iframe" style="display: none;"></iframe><div class="drip-tab-container">
  <div id="drip-2211" class="drip-tab bottom right no-image classic">
    <div id="drip-header-2211" class="drip-header">
      <a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#" id="drip-toggle-2211" class="drip-toggle">
        <h2 id="drip-teaser-2211">Your Start in Machine Learning</h2>
        <span id="drip-tab-up-2211" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-2211" class="drip-arrow down" style="display: none"></span>
      </a>
    </div>

    <div id="drip-content-2211" class="drip-content drip-clearfix" style="height: auto; bottom: -525px;">
      <div id="drip-form-panel-2211" class="drip-panel" style="display: block;">
        <a id="drip-close-2211" class="drip-close">×</a>
        <h3 id="drip-content-header-2211">Your Start in Machine Learning</h3>
        <div id="drip-scroll-2211" class="drip-scroll">
          <div class="drip-clearfix">
            
            <div class="drip-description">You can master applied Machine Learning&nbsp;<br>
<strong>without math or fancy degrees</strong>.<br>
Find out how in this <em>free</em>&nbsp;and <em>practical</em>&nbsp;course.</div>
          </div>
          <form id="drip-form-2211">
            <div style="display: none">
              <input type="hidden" name="form_id" value="2211">
            </div>
            <dl class="no-labels">
              
                
                  <dt>Email Address</dt>
                  <dd class="drip-clearfix">
                    
                      <input type="email" name="fields[email]" value="" placeholder="Email Address" class="drip-text-field">
                      <div id="drip-errors-for-email-2211" class="drip-errors"></div>
                    
                  </dd>
                
              
                
                  <dt></dt>
                  <dd class="drip-clearfix">
                    
                      <div class="classic--checkbox hidden" data-container="eu-checkbox">
                        <input type="hidden" name="fields[eu_consent]" id="drip-field-eu_consent-denied" value="denied" disabled="disabled">
                        <input type="checkbox" name="fields[eu_consent]" id="drip-field-eu_consent" value="granted" disabled="disabled">
                        <label for="drip-field-eu_consent">I consent to receive information about services and special offers by email. For more information, see the <a href="https://machinelearningmastery.com/privacy/">Privacy Policy</a>.</label>
                      </div>
                    
                  </dd>
                
              
                
                  <input type="hidden" name="fields[eu_consent_message]" value="I consent to receive information about services and special offers by email. For more information, see the Privacy Policy (https://machinelearningmastery.com/privacy/).">
                
              
              
              <div style="display: none;" aria-hidden="true">
                <dt for="website">Website</dt>
                <dd>
                  <input type="text" id="website" name="website" placeholder="Website" class="drip-text-field" tabindex="-1" autocomplete="false" value="">
                </dd>
              </div>
            </dl>
            <div class="form-controls">
              <input type="submit" name="submit" value="Start My Email Course" id="drip-submit-2211" class="drip-submit-button">
            </div>
          </form>
        </div>
      </div>

      <div id="drip-success-panel-2211" class="drip-success drip-panel drip-clearfix" style="display: none">
        <a id="drip-hide-2211" class="drip-close">×</a>
        <h3>Thank you for signing up!</h3>
        <p class="drip-description">Please check your email and click the link provided to confirm your subscription.</p>
      </div>

      
    </div>
  </div>
</div></body><span class="gr__tooltip"><span class="gr__tooltip-content"></span><i class="gr__tooltip-logo"></i><span class="gr__triangle"></span></span></html>